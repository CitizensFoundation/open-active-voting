import{b as e,d as o,h as t,_ as r,p as i,c as s}from"./e2f783a8.js";import"./3216be52.js";import"./99824053.js";let a;const p=e(a||(a=(e=>e)`paper-dialog{padding-left:8px;padding-right:8px;width:440px;background-color:#fff}paper-dialog{z-index:9999}@media (max-width:480px){paper-dialog{padding:0;margin:0;height:100%;width:100%}}paper-spinner{padding:0;margin:0}.buttons{margin-left:0;padding-left:0;color:var(--app-accent-color);font-size:18px;padding-top:8px}.checkBox{margin-top:16px}paper-input{--paper-input-container-focus-color:var(--app-accent-color)}paper-checkbox{--paper-checkbox-checked-color:var(--app-accent-color);padding-top:8px}.postcodeWrongWard{color:var(--paper-red-a400)}`));let n,d,c,h,l,m,u,g,v,y=e=>e,b=class extends o{constructor(){super(),this.userSpinner=!1,this.opened=!1,this.smsCodeSent=!1}static get styles(){return[p]}render(){return t(n||(n=y` <paper-dialog id="dialog" with-backdrop> <div class="layout horizontal center-center"> ${0} </div> ${0} <form is="iron-form" id="form"> ${0} </form> <div class="buttons layout vertical"> <paper-button autofocus @tap="${0}">${0}</paper-button> </div> </paper-dialog> `),this.smsCodeSent?t(d||(d=y`<h2>${0}</h2> `),this.localize("enterSmsCode")):t(c||(c=y`<h2>${0}</h2>`),this.localize("enterYourMobileNumber")),this.smsCodeSent?t(h||(h=y`<div>${0}</div>`),this.localize("enterSmsCodeDescription")):t(l||(l=y`<div> ${0} </div>`),this.localize("enterYourMobileNumberDescription")),this.smsCodeSent?t(m||(m=y` <paper-input id="smsCode" type="text" label="${0}" .value="${0}" minlength="4" .error-message="${0}"> </paper-input> `),this.localize("smsCode"),this.smsCode,this.smsCodeErrorMessage):t(u||(u=y` <paper-input id="smsNumber" type="text" label="${0}" .value="${0}" minlength="6" .error-message="${0}"> </paper-input> `),this.localize("mobileNumber"),this.smsNumber,this.smsErrorMessage),this._validateAndSend,this.smsCodeSent?t(g||(g=y`${0}`),this.localize("sendSmsCode")):t(v||(v=y`${0}`),this.localize("sendPhoneNumber")))}firstUpdated(e){super.firstUpdated(e)}_resetCorrectArea(){setTimeout((()=>{this.correctAreaId=void 0,this.correctAreaName=void 0,this.close()}),100)}_loginCompleted(){this.onLoginFunction(),this.close()}open(e,o,t){this.onLoginFunction=t,this.areaId=e,this.areaName=o,this.userSpinner=!1,this.opened=!1,this.smsNumber="",this.$$("#dialog").open()}_validateAndSend(e){return this.smsCodeSent?(this.smsCode=this.$$("#smsCode").value,this.smsCode?(fetch("/votes/sms_login",{method:"POST",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({smsCode:this.smsCode})}).then((e=>e.json())).then((e=>{e&&!0===e.ok?this._loginCompleted():this.fire("oav-error",this.localize("error_not_authorized"))})).catch((()=>{this.fire("oav-error",this.localize("general_error"))})),!0):(this.fire("oav-error",this.localize("completeForm")),!1)):(this.smsNumber=this.$$("#smsNumber").value,this.smsNumber?(fetch("/votes/send_sms_login_code",{method:"POST",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify({smsNumber:this.smsNumber})}).then((e=>e.json())).then((e=>{e&&!0===e.ok?this.smsCodeSent=!0:this.fire("oav-error",this.localize("error_not_authorized"))})).catch((()=>{this.fire("oav-error",this.localize("general_error"))})),!0):(this.fire("oav-error",this.localize("completeForm")),!1))}close(){var e=this.$$("#dialog");e&&e.close(),this.opened=!1,this.userSpinner=!1}};r([i({type:Object})],b.prototype,"configFromServer",void 0),r([i({type:Number})],b.prototype,"correctAreaId",void 0),r([i({type:String})],b.prototype,"areaName",void 0),r([i({type:String})],b.prototype,"correctAreaName",void 0),r([i({type:String})],b.prototype,"smsNumber",void 0),r([i({type:Boolean})],b.prototype,"userSpinner",void 0),r([i({type:String})],b.prototype,"smsErrorMessage",void 0),r([i({type:String})],b.prototype,"smsCodeErrorMessage",void 0),r([i({type:String})],b.prototype,"submitText",void 0),r([i({type:Object})],b.prototype,"onLoginFunction",void 0),r([i({type:Number})],b.prototype,"areaId",void 0),r([i({type:String})],b.prototype,"smsCode",void 0),r([i({type:Boolean})],b.prototype,"opened",void 0),r([i({type:Boolean})],b.prototype,"smsCodeSent",void 0),b=r([s("oav-low-security-sms-login")],b);export{b as OavLowSecuritySmsLogin};
