<html><head><meta charset="UTF-8"><link rel="import" href="../oav-app.html?v=6.1.104"></head><body><div hidden="" by-vulcanize=""><!--
@license
Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
--><iron-iconset-svg name="maps" size="24">
<svg><defs>
<g id="add-location"><path d="M12 2C8.14 2 5 5.14 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.86-3.14-7-7-7zm4 8h-3v3h-2v-3H8V8h3V5h2v3h3v2z"></path></g>
<g id="beenhere"><path d="M19 1H5c-1.1 0-1.99.9-1.99 2L3 15.93c0 .69.35 1.3.88 1.66L12 23l8.11-5.41c.53-.36.88-.97.88-1.66L21 3c0-1.1-.9-2-2-2zm-9 15l-5-5 1.41-1.41L10 13.17l7.59-7.59L19 7l-9 9z"></path></g>
<g id="directions"><path d="M21.71 11.29l-9-9c-.39-.39-1.02-.39-1.41 0l-9 9c-.39.39-.39 1.02 0 1.41l9 9c.39.39 1.02.39 1.41 0l9-9c.39-.38.39-1.01 0-1.41zM14 14.5V12h-4v3H8v-4c0-.55.45-1 1-1h5V7.5l3.5 3.5-3.5 3.5z"></path></g>
<g id="directions-bike"><path d="M15.5 5.5c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zM5 12c-2.8 0-5 2.2-5 5s2.2 5 5 5 5-2.2 5-5-2.2-5-5-5zm0 8.5c-1.9 0-3.5-1.6-3.5-3.5s1.6-3.5 3.5-3.5 3.5 1.6 3.5 3.5-1.6 3.5-3.5 3.5zm5.8-10l2.4-2.4.8.8c1.3 1.3 3 2.1 5.1 2.1V9c-1.5 0-2.7-.6-3.6-1.5l-1.9-1.9c-.5-.4-1-.6-1.6-.6s-1.1.2-1.4.6L7.8 8.4c-.4.4-.6.9-.6 1.4 0 .6.2 1.1.6 1.4L11 14v5h2v-6.2l-2.2-2.3zM19 12c-2.8 0-5 2.2-5 5s2.2 5 5 5 5-2.2 5-5-2.2-5-5-5zm0 8.5c-1.9 0-3.5-1.6-3.5-3.5s1.6-3.5 3.5-3.5 3.5 1.6 3.5 3.5-1.6 3.5-3.5 3.5z"></path></g>
<g id="directions-boat"><path d="M20 21c-1.39 0-2.78-.47-4-1.32-2.44 1.71-5.56 1.71-8 0C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 2.52 1.29 5.48 1.29 8 0 1.26.65 2.62.99 4 .99h2v-2h-2zM3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19zM6 6h12v3.97L12 8 6 9.97V6z"></path></g>
<g id="directions-bus"><path d="M4 16c0 .88.39 1.67 1 2.22V20c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h8v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1.78c.61-.55 1-1.34 1-2.22V6c0-3.5-3.58-4-8-4s-8 .5-8 4v10zm3.5 1c-.83 0-1.5-.67-1.5-1.5S6.67 14 7.5 14s1.5.67 1.5 1.5S8.33 17 7.5 17zm9 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm1.5-6H6V6h12v5z"></path></g>
<g id="directions-car"><path d="M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.21.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16zm11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM5 11l1.5-4.5h11L19 11H5z"></path></g>
<g id="directions-railway"><path d="M4 15.5C4 17.43 5.57 19 7.5 19L6 20.5v.5h12v-.5L16.5 19c1.93 0 3.5-1.57 3.5-3.5V5c0-3.5-3.58-4-8-4s-8 .5-8 4v10.5zm8 1.5c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm6-7H6V5h12v5z"></path></g>
<g id="directions-run"><path d="M13.49 5.48c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm-3.6 13.9l1-4.4 2.1 2v6h2v-7.5l-2.1-2 .6-3c1.3 1.5 3.3 2.5 5.5 2.5v-2c-1.9 0-3.5-1-4.3-2.4l-1-1.6c-.4-.6-1-1-1.7-1-.3 0-.5.1-.8.1l-5.2 2.2v4.7h2v-3.4l1.8-.7-1.6 8.1-4.9-1-.4 2 7 1.4z"></path></g>
<g id="directions-subway"><path d="M12 2c-4.42 0-8 .5-8 4v9.5C4 17.43 5.57 19 7.5 19L6 20.5v.5h12v-.5L16.5 19c1.93 0 3.5-1.57 3.5-3.5V6c0-3.5-3.58-4-8-4zM7.5 17c-.83 0-1.5-.67-1.5-1.5S6.67 14 7.5 14s1.5.67 1.5 1.5S8.33 17 7.5 17zm3.5-6H6V6h5v5zm5.5 6c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm1.5-6h-5V6h5v5z"></path></g>
<g id="directions-transit"><path d="M12 2c-4.42 0-8 .5-8 4v9.5C4 17.43 5.57 19 7.5 19L6 20.5v.5h12v-.5L16.5 19c1.93 0 3.5-1.57 3.5-3.5V6c0-3.5-3.58-4-8-4zM7.5 17c-.83 0-1.5-.67-1.5-1.5S6.67 14 7.5 14s1.5.67 1.5 1.5S8.33 17 7.5 17zm3.5-6H6V6h5v5zm5.5 6c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm1.5-6h-5V6h5v5z"></path></g>
<g id="directions-walk"><path d="M13.5 5.5c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zM9.8 8.9L7 23h2.1l1.8-8 2.1 2v6h2v-7.5l-2.1-2 .6-3C14.8 12 16.8 13 19 13v-2c-1.9 0-3.5-1-4.3-2.4l-1-1.6c-.4-.6-1-1-1.7-1-.3 0-.5.1-.8.1L6 8.3V13h2V9.6l1.8-.7"></path></g>
<g id="edit-location"><path d="M12 2C8.14 2 5 5.14 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.86-3.14-7-7-7zm-1.56 10H9v-1.44l3.35-3.34 1.43 1.43L10.44 12zm4.45-4.45l-.7.7-1.44-1.44.7-.7c.15-.15.39-.15.54 0l.9.9c.15.15.15.39 0 .54z"></path></g>
<g id="ev-station"><path d="M19.77 7.23l.01-.01-3.72-3.72L15 4.56l2.11 2.11c-.94.36-1.61 1.26-1.61 2.33 0 1.38 1.12 2.5 2.5 2.5.36 0 .69-.08 1-.21v7.21c0 .55-.45 1-1 1s-1-.45-1-1V14c0-1.1-.9-2-2-2h-1V5c0-1.1-.9-2-2-2H6c-1.1 0-2 .9-2 2v16h10v-7.5h1.5v5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V9c0-.69-.28-1.32-.73-1.77zM18 10c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zM8 18v-4.5H6L10 6v5h2l-4 7z"></path></g>
<g id="flight"><path d="M10.18 9"></path><path d="M21 16v-2l-8-5V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5z"></path></g>
<g id="hotel"><path d="M7 13c1.66 0 3-1.34 3-3S8.66 7 7 7s-3 1.34-3 3 1.34 3 3 3zm12-6h-8v7H3V5H1v15h2v-3h18v3h2v-9c0-2.21-1.79-4-4-4z"></path></g>
<g id="layers"><path d="M11.99 18.54l-7.37-5.73L3 14.07l9 7 9-7-1.63-1.27-7.38 5.74zM12 16l7.36-5.73L21 9l-9-7-9 7 1.63 1.27L12 16z"></path></g>
<g id="layers-clear"><path d="M19.81 14.99l1.19-.92-1.43-1.43-1.19.92 1.43 1.43zm-.45-4.72L21 9l-9-7-2.91 2.27 7.87 7.88 2.4-1.88zM3.27 1L2 2.27l4.22 4.22L3 9l1.63 1.27L12 16l2.1-1.63 1.43 1.43L12 18.54l-7.37-5.73L3 14.07l9 7 4.95-3.85L20.73 21 22 19.73 3.27 1z"></path></g>
<g id="local-activity"><path d="M20 12c0-1.1.9-2 2-2V6c0-1.1-.9-2-2-2H4c-1.1 0-1.99.9-1.99 2v4c1.1 0 1.99.9 1.99 2s-.89 2-2 2v4c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2v-4c-1.1 0-2-.9-2-2zm-4.42 4.8L12 14.5l-3.58 2.3 1.08-4.12-3.29-2.69 4.24-.25L12 5.8l1.54 3.95 4.24.25-3.29 2.69 1.09 4.11z"></path></g>
<g id="local-airport"><path d="M21 16v-2l-8-5V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5z"></path></g>
<g id="local-atm"><path d="M11 17h2v-1h1c.55 0 1-.45 1-1v-3c0-.55-.45-1-1-1h-3v-1h4V8h-2V7h-2v1h-1c-.55 0-1 .45-1 1v3c0 .55.45 1 1 1h3v1H9v2h2v1zm9-13H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2zm0 14H4V6h16v12z"></path></g>
<g id="local-bar"><path d="M21 5V3H3v2l8 9v5H6v2h12v-2h-5v-5l8-9zM7.43 7L5.66 5h12.69l-1.78 2H7.43z"></path></g>
<g id="local-cafe"><path d="M20 3H4v10c0 2.21 1.79 4 4 4h6c2.21 0 4-1.79 4-4v-3h2c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2zm0 5h-2V5h2v3zM2 21h18v-2H2v2z"></path></g>
<g id="local-car-wash"><path d="M17 5c.83 0 1.5-.67 1.5-1.5 0-1-1.5-2.7-1.5-2.7s-1.5 1.7-1.5 2.7c0 .83.67 1.5 1.5 1.5zm-5 0c.83 0 1.5-.67 1.5-1.5 0-1-1.5-2.7-1.5-2.7s-1.5 1.7-1.5 2.7c0 .83.67 1.5 1.5 1.5zM7 5c.83 0 1.5-.67 1.5-1.5C8.5 2.5 7 .8 7 .8S5.5 2.5 5.5 3.5C5.5 4.33 6.17 5 7 5zm11.92 3.01C18.72 7.42 18.16 7 17.5 7h-11c-.66 0-1.21.42-1.42 1.01L3 14v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 18c-.83 0-1.5-.67-1.5-1.5S5.67 15 6.5 15s1.5.67 1.5 1.5S7.33 18 6.5 18zm11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM5 13l1.5-4.5h11L19 13H5z"></path></g>
<g id="local-convenience-store"><path d="M19 7V4H5v3H2v13h8v-4h4v4h8V7h-3zm-8 3H9v1h2v1H8V9h2V8H8V7h3v3zm5 2h-1v-2h-2V7h1v2h1V7h1v5z"></path></g>
<g id="local-dining"><path d="M8.1 13.34l2.83-2.83L3.91 3.5c-1.56 1.56-1.56 4.09 0 5.66l4.19 4.18zm6.78-1.81c1.53.71 3.68.21 5.27-1.38 1.91-1.91 2.28-4.65.81-6.12-1.46-1.46-4.2-1.1-6.12.81-1.59 1.59-2.09 3.74-1.38 5.27L3.7 19.87l1.41 1.41L12 14.41l6.88 6.88 1.41-1.41L13.41 13l1.47-1.47z"></path></g>
<g id="local-drink"><path d="M3 2l2.01 18.23C5.13 21.23 5.97 22 7 22h10c1.03 0 1.87-.77 1.99-1.77L21 2H3zm9 17c-1.66 0-3-1.34-3-3 0-2 3-5.4 3-5.4s3 3.4 3 5.4c0 1.66-1.34 3-3 3zm6.33-11H5.67l-.44-4h13.53l-.43 4z"></path></g>
<g id="local-florist"><path d="M12 22c4.97 0 9-4.03 9-9-4.97 0-9 4.03-9 9zM5.6 10.25c0 1.38 1.12 2.5 2.5 2.5.53 0 1.01-.16 1.42-.44l-.02.19c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5l-.02-.19c.4.28.89.44 1.42.44 1.38 0 2.5-1.12 2.5-2.5 0-1-.59-1.85-1.43-2.25.84-.4 1.43-1.25 1.43-2.25 0-1.38-1.12-2.5-2.5-2.5-.53 0-1.01.16-1.42.44l.02-.19C14.5 2.12 13.38 1 12 1S9.5 2.12 9.5 3.5l.02.19c-.4-.28-.89-.44-1.42-.44-1.38 0-2.5 1.12-2.5 2.5 0 1 .59 1.85 1.43 2.25-.84.4-1.43 1.25-1.43 2.25zM12 5.5c1.38 0 2.5 1.12 2.5 2.5s-1.12 2.5-2.5 2.5S9.5 9.38 9.5 8s1.12-2.5 2.5-2.5zM3 13c0 4.97 4.03 9 9 9 0-4.97-4.03-9-9-9z"></path></g>
<g id="local-gas-station"><path d="M19.77 7.23l.01-.01-3.72-3.72L15 4.56l2.11 2.11c-.94.36-1.61 1.26-1.61 2.33 0 1.38 1.12 2.5 2.5 2.5.36 0 .69-.08 1-.21v7.21c0 .55-.45 1-1 1s-1-.45-1-1V14c0-1.1-.9-2-2-2h-1V5c0-1.1-.9-2-2-2H6c-1.1 0-2 .9-2 2v16h10v-7.5h1.5v5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V9c0-.69-.28-1.32-.73-1.77zM12 10H6V5h6v5zm6 0c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z"></path></g>
<g id="local-grocery-store"><path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"></path></g>
<g id="local-hospital"><path d="M19 3H5c-1.1 0-1.99.9-1.99 2L3 19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 11h-4v4h-4v-4H6v-4h4V6h4v4h4v4z"></path></g>
<g id="local-hotel"><path d="M7 13c1.66 0 3-1.34 3-3S8.66 7 7 7s-3 1.34-3 3 1.34 3 3 3zm12-6h-8v7H3V5H1v15h2v-3h18v3h2v-9c0-2.21-1.79-4-4-4z"></path></g>
<g id="local-laundry-service"><path d="M9.17 16.83c1.56 1.56 4.1 1.56 5.66 0 1.56-1.56 1.56-4.1 0-5.66l-5.66 5.66zM18 2.01L6 2c-1.11 0-2 .89-2 2v16c0 1.11.89 2 2 2h12c1.11 0 2-.89 2-2V4c0-1.11-.89-1.99-2-1.99zM10 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM7 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm5 16c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6z"></path></g>
<g id="local-library"><path d="M12 11.55C9.64 9.35 6.48 8 3 8v11c3.48 0 6.64 1.35 9 3.55 2.36-2.19 5.52-3.55 9-3.55V8c-3.48 0-6.64 1.35-9 3.55zM12 8c1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3 1.34 3 3 3z"></path></g>
<g id="local-mall"><path d="M19 6h-2c0-2.76-2.24-5-5-5S7 3.24 7 6H5c-1.1 0-1.99.9-1.99 2L3 20c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-7-3c1.66 0 3 1.34 3 3H9c0-1.66 1.34-3 3-3zm0 10c-2.76 0-5-2.24-5-5h2c0 1.66 1.34 3 3 3s3-1.34 3-3h2c0 2.76-2.24 5-5 5z"></path></g>
<g id="local-movies"><path d="M18 3v2h-2V3H8v2H6V3H4v18h2v-2h2v2h8v-2h2v2h2V3h-2zM8 17H6v-2h2v2zm0-4H6v-2h2v2zm0-4H6V7h2v2zm10 8h-2v-2h2v2zm0-4h-2v-2h2v2zm0-4h-2V7h2v2z"></path></g>
<g id="local-offer"><path d="M21.41 11.58l-9-9C12.05 2.22 11.55 2 11 2H4c-1.1 0-2 .9-2 2v7c0 .55.22 1.05.59 1.42l9 9c.36.36.86.58 1.41.58.55 0 1.05-.22 1.41-.59l7-7c.37-.36.59-.86.59-1.41 0-.55-.23-1.06-.59-1.42zM5.5 7C4.67 7 4 6.33 4 5.5S4.67 4 5.5 4 7 4.67 7 5.5 6.33 7 5.5 7z"></path></g>
<g id="local-parking"><path d="M13 3H6v18h4v-6h3c3.31 0 6-2.69 6-6s-2.69-6-6-6zm.2 8H10V7h3.2c1.1 0 2 .9 2 2s-.9 2-2 2z"></path></g>
<g id="local-pharmacy"><path d="M21 5h-2.64l1.14-3.14L17.15 1l-1.46 4H3v2l2 6-2 6v2h18v-2l-2-6 2-6V5zm-5 9h-3v3h-2v-3H8v-2h3V9h2v3h3v2z"></path></g>
<g id="local-phone"><path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"></path></g>
<g id="local-pizza"><path d="M12 2C8.43 2 5.23 3.54 3.01 6L12 22l8.99-16C18.78 3.55 15.57 2 12 2zM7 7c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm5 8c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"></path></g>
<g id="local-play"><path d="M20 12c0-1.1.9-2 2-2V6c0-1.1-.9-2-2-2H4c-1.1 0-1.99.9-1.99 2v4c1.1 0 1.99.9 1.99 2s-.89 2-2 2v4c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2v-4c-1.1 0-2-.9-2-2zm-4.42 4.8L12 14.5l-3.58 2.3 1.08-4.12-3.29-2.69 4.24-.25L12 5.8l1.54 3.95 4.24.25-3.29 2.69 1.09 4.11z"></path></g>
<g id="local-post-office"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"></path></g>
<g id="local-printshop"><path d="M19 8H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zm-3 11H8v-5h8v5zm3-7c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-1-9H6v4h12V3z"></path></g>
<g id="local-see"><circle cx="12" cy="12" r="3.2"></circle><path d="M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"></path></g>
<g id="local-shipping"><path d="M20 8h-3V4H3c-1.1 0-2 .9-2 2v11h2c0 1.66 1.34 3 3 3s3-1.34 3-3h6c0 1.66 1.34 3 3 3s3-1.34 3-3h2v-5l-3-4zM6 18.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm13.5-9l1.96 2.5H17V9.5h2.5zm-1.5 9c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"></path></g>
<g id="local-taxi"><path d="M18.92 6.01C18.72 5.42 18.16 5 17.5 5H15V3H9v2H6.5c-.66 0-1.21.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16zm11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM5 11l1.5-4.5h11L19 11H5z"></path></g>
<g id="map"><path d="M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5zM15 19l-6-2.11V5l6 2.11V19z"></path></g>
<g id="my-location"><path d="M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"></path></g>
<g id="navigation"><path d="M12 2L4.5 20.29l.71.71L12 18l6.79 3 .71-.71z"></path></g>
<g id="near-me"><path d="M21 3L3 10.53v.98l6.84 2.65L12.48 21h.98L21 3z"></path></g>
<g id="person-pin"><path d="M19 2H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h4l3 3 3-3h4c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 3.3c1.49 0 2.7 1.21 2.7 2.7 0 1.49-1.21 2.7-2.7 2.7-1.49 0-2.7-1.21-2.7-2.7 0-1.49 1.21-2.7 2.7-2.7zM18 16H6v-.9c0-2 4-3.1 6-3.1s6 1.1 6 3.1v.9z"></path></g>
<g id="person-pin-circle"><path d="M12 2C8.14 2 5 5.14 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.86-3.14-7-7-7zm0 2c1.1 0 2 .9 2 2 0 1.11-.9 2-2 2s-2-.89-2-2c0-1.1.9-2 2-2zm0 10c-1.67 0-3.14-.85-4-2.15.02-1.32 2.67-2.05 4-2.05s3.98.73 4 2.05c-.86 1.3-2.33 2.15-4 2.15z"></path></g>
<g id="pin-drop"><path d="M18 8c0-3.31-2.69-6-6-6S6 4.69 6 8c0 4.5 6 11 6 11s6-6.5 6-11zm-8 0c0-1.1.9-2 2-2s2 .9 2 2-.89 2-2 2c-1.1 0-2-.9-2-2zM5 20v2h14v-2H5z"></path></g>
<g id="place"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"></path></g>
<g id="rate-review"><path d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 14v-2.47l6.88-6.88c.2-.2.51-.2.71 0l1.77 1.77c.2.2.2.51 0 .71L8.47 14H6zm12 0h-7.5l2-2H18v2z"></path></g>
<g id="restaurant"><path d="M11 9H9V2H7v7H5V2H3v7c0 2.12 1.66 3.84 3.75 3.97V22h2.5v-9.03C11.34 12.84 13 11.12 13 9V2h-2v7zm5-3v8h2.5v8H21V2c-2.76 0-5 2.24-5 4z"></path></g>
<g id="restaurant-menu"><path d="M8.1 13.34l2.83-2.83L3.91 3.5c-1.56 1.56-1.56 4.09 0 5.66l4.19 4.18zm6.78-1.81c1.53.71 3.68.21 5.27-1.38 1.91-1.91 2.28-4.65.81-6.12-1.46-1.46-4.2-1.1-6.12.81-1.59 1.59-2.09 3.74-1.38 5.27L3.7 19.87l1.41 1.41L12 14.41l6.88 6.88 1.41-1.41L13.41 13l1.47-1.47z"></path></g>
<g id="satellite"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM5 4.99h3C8 6.65 6.66 8 5 8V4.99zM5 12v-2c2.76 0 5-2.25 5-5.01h2C12 8.86 8.87 12 5 12zm0 6l3.5-4.5 2.5 3.01L14.5 12l4.5 6H5z"></path></g>
<g id="store-mall-directory"><path d="M20 4H4v2h16V4zm1 10v-2l-1-5H4l-1 5v2h1v6h10v-6h4v6h2v-6h1zm-9 4H6v-4h6v4z"></path></g>
<g id="streetview"><path d="M12.56 14.33c-.34.27-.56.7-.56 1.17V21h7c1.1 0 2-.9 2-2v-5.98c-.94-.33-1.95-.52-3-.52-2.03 0-3.93.7-5.44 1.83z"></path><circle cx="18" cy="6" r="5"></circle><path d="M11.5 6c0-1.08.27-2.1.74-3H5c-1.1 0-2 .9-2 2v14c0 .55.23 1.05.59 1.41l9.82-9.82C12.23 9.42 11.5 7.8 11.5 6z"></path></g>
<g id="subway"><circle cx="15.5" cy="16" r="1"></circle><circle cx="8.5" cy="16" r="1"></circle><path d="M7.01 9h10v5h-10zM17.8 2.8C16 2.09 13.86 2 12 2c-1.86 0-4 .09-5.8.8C3.53 3.84 2 6.05 2 8.86V22h20V8.86c0-2.81-1.53-5.02-4.2-6.06zm.2 13.08c0 1.45-1.18 2.62-2.63 2.62l1.13 1.12V20H15l-1.5-1.5h-2.83L9.17 20H7.5v-.38l1.12-1.12C7.18 18.5 6 17.32 6 15.88V9c0-2.63 3-3 6-3 3.32 0 6 .38 6 3v6.88z"></path></g>
<g id="terrain"><path d="M14 6l-3.75 5 2.85 3.8-1.6 1.2C9.81 13.75 7 10 7 10l-6 8h22L14 6z"></path></g>
<g id="traffic"><path d="M20 10h-3V8.86c1.72-.45 3-2 3-3.86h-3V4c0-.55-.45-1-1-1H8c-.55 0-1 .45-1 1v1H4c0 1.86 1.28 3.41 3 3.86V10H4c0 1.86 1.28 3.41 3 3.86V15H4c0 1.86 1.28 3.41 3 3.86V20c0 .55.45 1 1 1h8c.55 0 1-.45 1-1v-1.14c1.72-.45 3-2 3-3.86h-3v-1.14c1.72-.45 3-2 3-3.86zm-8 9c-1.11 0-2-.9-2-2s.89-2 2-2c1.1 0 2 .9 2 2s-.89 2-2 2zm0-5c-1.11 0-2-.9-2-2s.89-2 2-2c1.1 0 2 .9 2 2s-.89 2-2 2zm0-5c-1.11 0-2-.9-2-2 0-1.11.89-2 2-2 1.1 0 2 .89 2 2 0 1.1-.89 2-2 2z"></path></g>
<g id="train"><path d="M12 2c-4 0-8 .5-8 4v9.5C4 17.43 5.57 19 7.5 19L6 20.5v.5h2.23l2-2H14l2 2h2v-.5L16.5 19c1.93 0 3.5-1.57 3.5-3.5V6c0-3.5-3.58-4-8-4zM7.5 17c-.83 0-1.5-.67-1.5-1.5S6.67 14 7.5 14s1.5.67 1.5 1.5S8.33 17 7.5 17zm3.5-7H6V6h5v4zm2 0V6h5v4h-5zm3.5 7c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"></path></g>
<g id="tram"><path d="M19 16.94V8.5c0-2.79-2.61-3.4-6.01-3.49l.76-1.51H17V2H7v1.5h4.75l-.76 1.52C7.86 5.11 5 5.73 5 8.5v8.44c0 1.45 1.19 2.66 2.59 2.97L6 21.5v.5h2.23l2-2H14l2 2h2v-.5L16.5 20h-.08c1.69 0 2.58-1.37 2.58-3.06zm-7 1.56c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm5-4.5H7V9h10v5z"></path></g>
<g id="transfer-within-a-station"><path d="M16.49 15.5v-1.75L14 16.25l2.49 2.5V17H22v-1.5zm3.02 4.25H14v1.5h5.51V23L22 20.5 19.51 18zM9.5 5.5c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zM5.75 8.9L3 23h2.1l1.75-8L9 17v6h2v-7.55L8.95 13.4l.6-3C10.85 12 12.8 13 15 13v-2c-1.85 0-3.45-1-4.35-2.45l-.95-1.6C9.35 6.35 8.7 6 8 6c-.25 0-.5.05-.75.15L2 8.3V13h2V9.65l1.75-.75"></path></g>
<g id="zoom-out-map"><path d="M15 3l2.3 2.3-2.89 2.87 1.42 1.42L18.7 6.7 21 9V3zM3 9l2.3-2.3 2.87 2.89 1.42-1.42L6.7 5.3 9 3H3zm6 12l-2.3-2.3 2.89-2.87-1.42-1.42L5.3 17.3 3 15v6zm12-6l-2.3 2.3-2.87-2.89-1.42 1.42 2.89 2.87L15 21h6z"></path></g>
</defs></svg>
</iron-iconset-svg>
<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
--><dom-module id="paper-menu-shared-styles" assetpath="../../bower_components/paper-menu/">
  <template>
    <style>
      /* need a wrapper element to make this higher specificity than the :host rule in paper-item */
      .selectable-content > ::content > .iron-selected {
        font-weight: bold;

        @apply(--paper-menu-selected-item);
      }

      .selectable-content > ::content > [disabled] {
        color: var(--paper-menu-disabled-color, --disabled-text-color);
      }

      .selectable-content > ::content > *:focus {
        position: relative;
        outline: 0;

        @apply(--paper-menu-focused-item);
      }

      .selectable-content > ::content > *:focus:after {
        @apply(--layout-fit);
        background: currentColor;
        opacity: var(--dark-divider-opacity);
        content: '';
        pointer-events: none;

        @apply(--paper-menu-focused-item-after);
      }

      .selectable-content > ::content > *[colored]:focus:after {
        opacity: 0.26;
      }
    </style>
  </template>
</dom-module>
<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
--><!--
Material design: [Menus](https://www.google.com/design/spec/components/menus.html)

`<paper-menu>` implements an accessible menu control with Material Design styling. The focused item
is highlighted, and the selected item has bolded text.

    <paper-menu>
      <paper-item>Item 1</paper-item>
      <paper-item>Item 2</paper-item>
    </paper-menu>

An initial selection can be specified with the `selected` attribute.

    <paper-menu selected="0">
      <paper-item>Item 1</paper-item>
      <paper-item>Item 2</paper-item>
    </paper-menu>

Make a multi-select menu with the `multi` attribute. Items in a multi-select menu can be deselected,
and multiple items can be selected.

    <paper-menu multi>
      <paper-item>Item 1</paper-item>
      <paper-item>Item 2</paper-item>
    </paper-menu>

### Styling

The following custom properties and mixins are available for styling:

Custom property | Description | Default
----------------|-------------|----------
`--paper-menu-background-color`   | Menu background color                                            | `--primary-background-color`
`--paper-menu-color`              | Menu foreground color                                            | `--primary-text-color`
`--paper-menu-disabled-color`     | Foreground color for a disabled item                             | `--disabled-text-color`
`--paper-menu`                    | Mixin applied to the menu                                        | `{}`
`--paper-menu-selected-item`      | Mixin applied to the selected item                               | `{}`
`--paper-menu-focused-item`       | Mixin applied to the focused item                                | `{}`
`--paper-menu-focused-item-after` | Mixin applied to the ::after pseudo-element for the focused item | `{}`

### Accessibility

`<paper-menu>` has `role="menu"` by default. A multi-select menu will also have
`aria-multiselectable` set. It implements key bindings to navigate through the menu with the up and
down arrow keys, esc to exit the menu, and enter to activate a menu item. Typing the first letter
of a menu item will also focus it.

@group Paper Elements
@element paper-menu
@hero hero.svg
@demo demo/index.html
-->

<dom-module id="paper-menu" assetpath="../../bower_components/paper-menu/">
  <template>
    <style include="paper-menu-shared-styles"></style>
    <style>
      :host {
        display: block;
        padding: 8px 0;

        background: var(--paper-menu-background-color, --primary-background-color);
        color: var(--paper-menu-color, --primary-text-color);

        @apply(--paper-menu);
      }
    </style>

    <div class="selectable-content">
      <content></content>
    </div>
  </template>

  <script>
    (function() {
      Polymer({
        is: 'paper-menu',

        behaviors: [
          Polymer.IronMenuBehavior
        ]
      });
    })();
  </script>
</dom-module>
<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
--><!--
`PaperItemBehavior` is a convenience behavior shared by <paper-item> and
<paper-icon-item> that manages the shared control states and attributes of
the items.
-->

<script>
  /** @polymerBehavior Polymer.PaperItemBehavior */
  Polymer.PaperItemBehaviorImpl = {
    hostAttributes: {
      role: 'option',
      tabindex: '0'
    }
  };

  /** @polymerBehavior */
  Polymer.PaperItemBehavior = [
    Polymer.IronButtonState,
    Polymer.IronControlState,
    Polymer.PaperItemBehaviorImpl
  ];
</script>
<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
--><dom-module id="paper-item-shared-styles" assetpath="../../bower_components/paper-item/">
  <template>
    <style>
      :host, .paper-item {
        display: block;
        position: relative;
        min-height: var(--paper-item-min-height, 48px);
        padding: 0px 16px;
      }

      .paper-item {
        @apply(--paper-font-subhead);
        border:none;
        outline: none;
        background: white;
        width: 100%;
        text-align: left;
      }

      :host([hidden]), .paper-item[hidden] {
        display: none !important;
      }

      :host(.iron-selected), .paper-item.iron-selected {
        font-weight: var(--paper-item-selected-weight, bold);

        @apply(--paper-item-selected);
      }

      :host([disabled]), .paper-item[disabled] {
        color: var(--paper-item-disabled-color, --disabled-text-color);

        @apply(--paper-item-disabled);
      }

      :host(:focus), .paper-item:focus {
        position: relative;
        outline: 0;

        @apply(--paper-item-focused);
      }

      :host(:focus):before, .paper-item:focus:before {
        @apply(--layout-fit);

        background: currentColor;
        content: '';
        opacity: var(--dark-divider-opacity);
        pointer-events: none;

        @apply(--paper-item-focused-before);
      }
    </style>
  </template>
</dom-module>
<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
--><!--
Material design: [Lists](https://www.google.com/design/spec/components/lists.html)

`<paper-item>` is an interactive list item. By default, it is a horizontal flexbox.

    <paper-item>Item</paper-item>

Use this element with `<paper-item-body>` to make Material Design styled two-line and three-line
items.

    <paper-item>
      <paper-item-body two-line>
        <div>Show your status</div>
        <div secondary>Your status is visible to everyone</div>
      </paper-item-body>
      <iron-icon icon="warning"></iron-icon>
    </paper-item>

To use `paper-item` as a link, wrap it in an anchor tag. Since `paper-item` will
already receive focus, you may want to prevent the anchor tag from receiving
focus as well by setting its tabindex to -1.

    <a href="https://www.polymer-project.org/" tabindex="-1">
      <paper-item raised>Polymer Project</paper-item>
    </a>

If you are concerned about performance and want to use `paper-item` in a `paper-listbox`
with many items, you can just use a native `button` with the `paper-item` class
applied (provided you have correctly included the shared styles):

    <style is="custom-style" include="paper-item-shared-styles"></style>

    <paper-listbox>
      <button class="paper-item" role="option">Inbox</button>
      <button class="paper-item" role="option">Starred</button>
      <button class="paper-item" role="option">Sent mail</button>
    </paper-listbox>

### Styling

The following custom properties and mixins are available for styling:

Custom property               | Description                                  | Default
------------------------------|----------------------------------------------|----------
`--paper-item-min-height`     | Minimum height of the item                   | `48px`
`--paper-item`                | Mixin applied to the item                    | `{}`
`--paper-item-selected-weight`| The font weight of a selected item           | `bold`
`--paper-item-selected`       | Mixin applied to selected paper-items        | `{}`
`--paper-item-disabled-color` | The color for disabled paper-items           | `--disabled-text-color`
`--paper-item-disabled`       | Mixin applied to disabled paper-items        | `{}`
`--paper-item-focused`        | Mixin applied to focused paper-items         | `{}`
`--paper-item-focused-before` | Mixin applied to :before focused paper-items | `{}`

### Accessibility

This element has `role="listitem"` by default. Depending on usage, it may be more appropriate to set
`role="menuitem"`, `role="menuitemcheckbox"` or `role="menuitemradio"`.

    <paper-item role="menuitemcheckbox">
      <paper-item-body>
        Show your status
      </paper-item-body>
      <paper-checkbox></paper-checkbox>
    </paper-item>

@group Paper Elements
@element paper-item
@demo demo/index.html
-->

<dom-module id="paper-item" assetpath="../../bower_components/paper-item/">
  <template>
    <style include="paper-item-shared-styles"></style>
    <style>
      :host {
        @apply(--layout-horizontal);
        @apply(--layout-center);
        @apply(--paper-font-subhead);

        @apply(--paper-item);
      }
    </style>

    <content></content>
  </template>

  <script>
    Polymer({
      is: 'paper-item',

      behaviors: [
        Polymer.PaperItemBehavior
      ]
    });
  </script>
</dom-module>
<dom-module id="oav-area-ballot-item" assetpath="/">
  <style>
    .itemContent {
      @apply(--layout-vertical);
      position: relative;
      width: 300px !important;
      height: 320px;
      margin: 16px;
    }

    .itemContent[small] {
      width: 260px !important;
      height: 277px;
      margin: 0;
    }

    .itemContent[small][tiny] {
      width: 220px !important;
      height: 220px;
    }

    .itemSelectedFrame {
      background: transparent;
      border: none;
      width: 296px;
      height: 316px;
      position: absolute;
      top: 0;
      left: 0;
      z-index: 4;
    }

    .itemSelectedFrame[small] {
      width: 254px;
      height: 271px;
    }

    .itemSelectedFrame[small][tiny] {
      width: 214px;
      height: 214px;
    }

    .buttons {
      z-index: 5;
    }

    .itemSelectedFrame[selected] {
      background: transparent;
      border: solid 2px;
      border-color: var(--app-accent-color);
    }

    iron-image {
      height: 169px;
      width: 300px;
    }

    iron-image[small] {
      width: 260px;
      height: 146px;
    }

    iron-image[small][tiny] {
      width: 220px;
      height: 124px;
    }

    google-map {
      height: 169px;
      width: 300px;
      margin-bottom: 7px;
    }

    google-map[small] {
      width: 260px;
      height: 146px;
      z-index: 0 !important;
    }

    google-map[small][tiny] {
      width: 220px;
      height: 124px;
    }

    .descriptionContainer {
      height: 169px;
      width: 300px;
      margin: 0;
      overflow: hidden;
      background-color: var(--paper-blue-700);
      font-size: 18px;
      color: #FFF;
      font-weight: bold;
      text-align: left;
    }

    .descriptionContainer[small] {
      width: 260px;
      height: 146px;
      font-size: 16px;
      text-align: left;
    }

    .descriptionContainer[small][tiny] {
      width: 220px;
      height: 124px;
      font-size: 15px;
    }

    .description {
      padding: 8px;
      font-size: 16px;
      margin-top: 42px;
    }

    .name {
      font-size: 20px;
      padding: 8px;
      color: #222;
    }

    .name[small] {
      font-size: 17px;
      padding-top: 4px;
      padding-right: 4px;
      padding-top: 4px;
    }

    .name[small][tiny] {
      font-size: 14px;
    }

    .price {
      font-size: 25px;
      position: absolute;
      bottom: 8px;
      left: 105px;
      color: var(--app-accent-color);
    }

    .price[small] {
      left: 70px;
    }

    .price[small][tiny] {
      left: 42px;
    }
    
    .priceCurrency {
      font-size: 23px;
      color: var(--app-accent-color);
    }

    paper-fab.addRemoveButton {
      position: absolute;
      bottom: 12px;
      right: 12px;
      background-color: var(--app-accent-color);
      color: #fff;
    }

    paper-fab.removeButton {
      background-color: #fff !important;
      color: var(--app-accent-color) !important;
    }

    paper-fab.addFavoriteButton {
      position: absolute;
      bottom: 12px;
      left: 12px;
      background-color: #FFF;
      color: rgb(255,215,0);
      --paper-fab-iron-icon: {
        height: 33px;
        width: 33px;
      };
      padding: 0;
    }

    .shareIcon {
      position: absolute;
      top: 6px;
      left: 0;
      --paper-share-button-icon-color: var(--app-accent-color-light);
      --paper-share-button-icon-height: 46px;
      --paper-share-button-icon-width: 46px;
      -webkit-filter: drop-shadow( 1px 1px 10px #555 );
      filter: drop-shadow( 1px 1px 10px #555 );
    }

    .shareIcon[small] {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      top: 2px;
    }

    paper-fab.removeFavoriteButton {
      position: absolute;
      bottom: 12px;
      left: 12px;
      background-color: #FFF;
      color: rgb(255,215,0);
      --paper-fab-iron-icon: {
        height: 33px;
        width: 33px;
      };
      padding: 0;
    }

    paper-fab[disabled] {
      background-color: #b7b7b7;
    }

    .budgetContainer {
      @apply(--layout-horizontal);
      @apply(--layout-center-center);
    }

    .itemContent {
      background-color: #fbfbfb;
      color: #222;
    }

    .addRemoveButton {

    }

    .infoIcon {
      color: var(--app-accent-color-light);
      width: 32px;
      height: 32px;
      padding: 0;
      margin-right: 4px;
    }

    .infoLinks {
      position: absolute;
      top: 118px;
      right: 0px;
      z-index: 2;
    }

    .stateDropdown {
      color: var(--app-accent-color-light);
      position: absolute;
      top: 60px;
      right: 0;
      z-index: 2;
      padding-right: 0;
      margin-right: 0;
    }

    .dropdownMenuButton {
      position: absolute;
      top: 8px;
      right: 8px;
    }

    .dropdownButton {
      background-color: var(--app-accent-color);
      opacity: 0.8;
      color: #fff;
      padding: 2px;
      width: 32px;
      height: 26px;
    }

    .infoLinks[small] {
      top: 98px;
    }

    .infoLinks[small][tiny] {
      top: 78px;
    }

    .externalInfoIcon {
      color: #999;
      width: 45px;
      height: 45px;
    }

    .externalIconContainer {
      position: absolute;
      bottom: 4px;
      left: 0px;
      z-index: 2;
    }

    google-map {
      z-index: 5;
    }

    paper-fab {
      z-index: 5;
    }

    .favoriteButtons {
    }


  </style>

  <template>
    <iron-signals on-iron-signal-set-language="setLanguage"></iron-signals>
    <iron-media-query query="(max-width: 360px)" query-matches="{{tiny}}"></iron-media-query>

    <paper-material animated="" elevation="[[elevation]]" class="itemContent" small$="[[small]]" tiny$="[[tiny]]">
      <iron-image preload="" on-loaded-changed="_imageLoadedChanged" small$="[[small]]" tiny$="[[tiny]]" hidden$="[[!imageTabSelected]]" name="image" sizing="cover" src="[[item.image_url]]"></iron-image>
      <template is="dom-if" if="[[mapTabSelected]]" restamp="">
        <template is="dom-if" if="[[mapsHeight]]" restamp="">
          <iron-image class="main-image" sizing="cover" src$="https://maps.googleapis.com/maps/api/staticmap?center=[[latitude]],[[longitude]]&amp;zoom=15&amp;size=[[mapsWidth]]x[[mapsHeight]]&amp;markers=color:red%7Clabel:%7C[[latitude]],[[longitude]]&amp;key=[[staticMapsApiKey]]" hidden$="[[!mapTabSelected]]"></iron-image>
        </template>
      </template>
      <div hidden$="[[!descriptionTabSelected]]" name="description" class="descriptionContainer" tiny$="[[tiny]]" small$="[[small]]">
        <div id="description" class="description">
          [[item.description]]
        </div>
      </div>
      <paper-menu-button on-tap="_openMenu" small$="[[small]]" tiny$="[[tiny]]" class="dropdownMenuButton" horizontal-align="right">
        <paper-icon-button title$="{{localize('more_information')}}" class="dropdown-trigger dropdownButton" no-tap="_clickedDropDownMenu" icon="menu"></paper-icon-button>
        <paper-menu class="dropdown-content">
          <paper-item on-tap="_setImageMode">
            <iron-icon title$="{{localize('image_item_tab')}}" class="infoIcon" icon="image:photo"></iron-icon>{{localize('image_item_tab')}}
          </paper-item>
          <paper-item on-tap="_setDescriptionMode">
            <iron-icon title$="{{localize('description_item_tab')}}" class="infoIcon" icon="description"></iron-icon>{{localize('description_item_tab')}}
          </paper-item>
          <paper-item on-tap="_setMapMode">
            <iron-icon title$="{{localize('map_item_tab')}}" class="infoIcon" icon="maps:place"></iron-icon>{{localize('map_item_tab')}}
          </paper-item>
          <paper-item on-tap="_openPdf">
            <iron-icon title$="{{localize('design_pdf')}}" class="infoIcon" icon="image:picture-as-pdf"></iron-icon>{{localize('design_pdf')}}
          </paper-item>
        </paper-menu>
      </paper-menu-button>
      <div class="layout horizontal">
        <div class="name" small$="[[small]]" tiny$="[[tiny]]">[[item.name]]</div>
      </div>
      <div class="buttons">
        <paper-share-button hidden$="[[!imageLoaded]]" small$="[[small]]" on-share-tap="_shareTap" class="shareIcon" horizontal-align="left" id="shareButton" title$="{{localize('share_idea')}}" facebook="" twitter="" popup="" url$="[[itemShareUrl]]"></paper-share-button>

        <div class="price" small$="[[small]]" tiny$="[[tiny]]">Â£[[formatNumber(item.price)]]
          <span class="priceCurrency" hidden$="[[!_priceIsOne(item.price)]]">{{localize('million')}}</span>
          <span class="priceCurrency" hidden$="[[_priceIsOne(item.price)]]">{{localize('millions')}}</span>
        </div>
        <paper-fab mini="" id="addToBudgetButton" elevation="5" class="addRemoveButton" hidden$="[[selectedInBudget]]" disabled$="[[toExpensiveForBudget]]" title$="{{localize('add_to_budget')}}" icon="add" on-tap="_toggleInBudget">
        </paper-fab>
        <paper-fab mini="" elevation="5" class="addRemoveButton removeButton" hidden$="[[!selectedInBudget]]" disabled$="[[toExpensiveForBudget]]" title$="{{localize('remove_from_budget')}}" icon="remove" on-tap="_toggleInBudget">
        </paper-fab>
      </div>
    </paper-material>
  </template>
</dom-module>

<script>
  (function() {
    Polymer({

      is: 'oav-area-ballot-item',

      behaviors: [
        Polymer.appHelpers,
        Polymer.AppLocalizeBehavior
      ],

      properties: {
        item: {
          type: Object,
          observer: '_itemChanged'
        },

        staticMapsApiKey: {
          type: String,
          value: "AIzaSyBYy8UvdDD650mz7k1pY0j2hBFQmCPVnxA"
        },

        elevation: Number,

        budgetElement: {
          type: Object
        },

        selectedInBudget: {
          type: Boolean,
          value: false,
          observer: 'selectedInBudgetChanged'
        },

        toExpensiveForBudget: {
          type: Boolean,
          value: false
        },

        isFavorite: {
          type: Boolean,
          value: false
        },

        googleMapsApiKey: {
          type: String,
          value: "AIzaSyDkF_kak8BVZA5zfp5R4xRnrX8HP3hjiL0"
        },

        imageTabSelected: {
          type: Boolean,
          value: true
        },

        descriptionTabSelected: {
          type: Boolean,
          value: false
        },

        mapTabSelected: {
          type: Boolean,
          value: false
        },

        descriptionPdfLink: {
          type: String,
          computed: '_descriptionPdfLink(item)'
        },

        itemShareUrl: {
          type: String,
          computed: '_itemShareUrl(item)'
        },

        small: {
          type: Boolean,
          value: false,
          observer: '_smallChanged'
        },

        tiny: {
          type: Boolean,
          value: false,
          observer: '_tinyChanged'
        },

        mapsHeight: {
          type: String,
          value: null
        },

        mapsWidth: {
          type: String,
          value: null
        },

        longitude: {
          type: String,
          value: null
        },

        latitude: {
          type: String,
          value: null
        },

        imageLoaded: {
          type: Boolean,
          value: false
        }
      },

      _imageLoadedChanged: function (event, detail) {
        if (detail.value) {
          this.set('imageLoaded', true);
        }
      },

      _smallChanged: function (small) {
        if (small) {
          this.set('mapsHeight', '260');
          this.set('mapsWidth', '146');
        } else {
          this.set('mapsHeight', '169');
          this.set('mapsWidth', '300');
        }
      },

      _tinyChanged: function (tiny) {
        if (tiny) {
          this.set('mapsHeight', '220');
          this.set('mapsWidth', '124');
        } else {
          this.set('mapsHeight', '169');
          this.set('mapsWidth', '300');
        }
      },

      selectedInBudgetChanged: function (newValue, oldValue) {
        if (newValue===true) {
          this.set('elevation', "4");
        } else {
          this.set('elevation', "1");
        }
      },

      _clickedDropDownMenu: function () {
        window.appGlobals.activity('click', 'dropdown');
      },

      _priceIsOne: function (price) {
        if (price && price<=1.0) {
          return true;
        } else {
          return false;
        }
      },

      _openPdf: function () {
        window.appGlobals.activity('click', 'openPdf');
        window.open(this.item.pdf_url, '_blank');
      },

      _showPost: function () {
        window.appGlobals.activity('click', 'showPost');
        window.appLastArea = '/'+window.location.hash;
        window.location = "/#/post/"+this.item.idea_id;
      },

      _descriptionPdfLink: function (newItem) {
        if (newItem && window.appGlobals && window.appGlobals.configFromServer && window.appGlobals.configFromServer.ideas_without_pdfs) {
          var ideasWithOutPdfs = JSON.parse(window.appGlobals.configFromServer.ideas_without_pdfs);
          if (!ideasWithOutPdfs || ideasWithOutPdfs.indexOf(parseInt(newItem.idea_id)) > -1) {
            return null;
          } else {
            return 'https://s3-eu-west-1.amazonaws.com/oav-direct-assets/hverfid_mitt_2016/moreProjectInformation_'+newItem.idea_id+'.pdf';
          }
        } else {
          return null;
        }
      },

      _itemShareUrl: function (newItem) {
        if (newItem) {
          return encodeURIComponent("https://"+window.location.host+"/items/"+newItem.id);
        } else {
          return null;
        }
      },

      _shareTap: function (event, detail) {
        window.appGlobals.activity('click', 'shareItem');
      },

      _itemChanged: function (newItem) {
        if (newItem) {
          if (newItem.locations && newItem.locations.length>0) {
            this.set('longitude', newItem.locations[0].longitude);
            this.set('latitude', newItem.locations[0].latitude);
          }
          this.resetFromBudget();
        }
      },

      resetFromBudget: function () {
        //console.log("resetFromBudget itemId: "+this.item.id);
        if (this.budgetElement) {
          if (this.budgetElement.selectedItems.indexOf(this.item) > -1) {
            this.setInBudget();
            this.setNotTooExpensive();
            if (this.budgetElement.currentBallot.favoriteItem==this.item) {
              this.set('isFavorite', true);
            } else {
              this.set('isFavorite', false);
            }
          } else {
            var budgetLeft = this.budgetElement.totalBudget-this.budgetElement.selectedBudget;
            if (this.item.price>budgetLeft) {
              this.setTooExpensive()
            } else {
              this.setNotTooExpensive()
            }
            this.removeFromBudget();
          }
        }
        this._setImageMode(true);
      },

      _setImageMode: function (disableActivity) {
        if (!disableActivity || disableActivity===false) {
          window.appGlobals.activity('select', 'imageMode');
        }
        this.set('imageTabSelected', true);
        this.set('descriptionTabSelected', false);
        this.set('mapTabSelected', false);
      },

      _setMapMode: function () {
        window.appGlobals.activity('select', 'mapMode');
        this.set('imageTabSelected', false);
        this.set('descriptionTabSelected', false);
        this.set('mapTabSelected', true);
      },

      _setDescriptionMode: function () {
        window.appGlobals.activity('select', 'descriptionMode');
        this.set('imageTabSelected', false);
        this.set('descriptionTabSelected', true);
        this.set('mapTabSelected', false);
      },

      _toggleDescription: function () {
        window.appGlobals.activity('toggle', 'description');
        if (this.descriptionTabSelected===true) {
          this._setImageMode();
        } else {
          this._setDescriptionMode();
        }
      },

      _openMenu: function () {
        window.appGlobals.activity('open', 'itemMenu');
      },

      setInBudget: function () {
        //console.log("setInBudget itemId: "+this.item.id);
        this.set('selectedInBudget', true);
      },

      removeFromBudget: function () {
        //console.log("removeFromBudget itemId: "+this.item.id);
        this.set('selectedInBudget', false);
        this.set('isFavorite', false);
      },

      setTooExpensive: function () {
        //console.log("setTooExpensive itemId: "+this.item.id);
        this.set('toExpensiveForBudget', true);
      },

      setNotTooExpensive: function () {
        //console.log("setNotTooExpensive itemId: "+this.item.id);
        this.set('toExpensiveForBudget', false);
      },

      attached: function() {
        this.loadLanguage(this.resolveUrl('/src/locales.json'));
      },

      _toggleInBudget: function (event) {
        //console.log("_toggleInBudget itemId: "+this.item.id);
        this.fire('oav-toggle-item-in-budget', { item: this.item });
      }
    })
  })();

</script>

<!-- Import encryption libraries -->
<script>/*Copyright (c) 2009 pidder <www.pidder.com>*/
function pidCrypt(){function a(b){if(!b){b=8}var c=new Array(b);var e=[];for(var d=0;d<256;d++){e[d]=d}for(d=0;d<c.length;d++){c[d]=e[Math.floor(Math.random()*e.length)]}return c}this.setDefaults=function(){this.params.nBits=256;this.params.salt=a(8);this.params.salt=pidCryptUtil.byteArray2String(this.params.salt);this.params.salt=pidCryptUtil.convertToHex(this.params.salt);this.params.blockSize=16;this.params.UTF8=true;this.params.A0_PAD=true};this.debug=true;this.params={};this.params.dataIn="";this.params.dataOut="";this.params.decryptIn="";this.params.decryptOut="";this.params.encryptIn="";this.params.encryptOut="";this.params.key="";this.params.iv="";this.params.clear=true;this.setDefaults();this.errors="";this.warnings="";this.infos="";this.debugMsg="";this.setParams=function(c){if(!c){c={}}for(var b in c){this.params[b]=c[b]}};this.getParams=function(){return this.params};this.getParam=function(b){return this.params[b]||""};this.clearParams=function(){this.params={}};this.getNBits=function(){return this.params.nBits};this.getOutput=function(){return this.params.dataOut};this.setError=function(b){this.error=b};this.appendError=function(b){this.errors+=b;return""};this.getErrors=function(){return this.errors};this.isError=function(){if(this.errors.length>0){return true}return false};this.appendInfo=function(b){this.infos+=b;return""};this.getInfos=function(){return this.infos};this.setDebug=function(b){this.debug=b};this.appendDebug=function(b){this.debugMsg+=b;return""};this.isDebug=function(){return this.debug};this.getAllMessages=function(c){var g={lf:"\n",clr_mes:false,verbose:15};if(!c){c=g}for(var h in g){if(typeof(c[h])=="undefined"){c[h]=g[h]}}var b="";var e="";for(var f in this.params){switch(f){case"encryptOut":e=pidCryptUtil.toByteArray(this.params[f].toString());e=pidCryptUtil.fragment(e.join(),64,c.lf);break;case"key":case"iv":e=pidCryptUtil.formatHex(this.params[f],48);break;default:e=pidCryptUtil.fragment(this.params[f].toString(),64,c.lf)}b+="<p><b>"+f+"</b>:<pre>"+e+"</pre></p>"}if(this.debug){b+="debug: "+this.debug+c.lf}if(this.errors.length>0&&((c.verbose&1)==1)){b+="Errors:"+c.lf+this.errors+c.lf}if(this.warnings.length>0&&((c.verbose&2)==2)){b+="Warnings:"+c.lf+this.warnings+c.lf}if(this.infos.length>0&&((c.verbose&4)==4)){b+="Infos:"+c.lf+this.infos+c.lf}if(this.debug&&((c.verbose&8)==8)){b+="Debug messages:"+c.lf+this.debugMsg+c.lf}if(c.clr_mes){this.errors=this.infos=this.warnings=this.debug=""}return b};this.getRandomBytes=function(b){return a(b)}};</script>
<script>pidCryptUtil={};pidCryptUtil.encodeBase64=function(n,p){if(!n){n=""}var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";p=(typeof p=="undefined")?false:p;var f,b,a,r,o,k,j,h,i=[],d="",m,q,l;q=p?pidCryptUtil.encodeUTF8(n):n;m=q.length%3;if(m>0){while(m++<3){d+="=";q+="\0"}}for(m=0;m<q.length;m+=3){f=q.charCodeAt(m);b=q.charCodeAt(m+1);a=q.charCodeAt(m+2);r=f<<16|b<<8|a;o=r>>18&63;k=r>>12&63;j=r>>6&63;h=r&63;i[m/3]=g.charAt(o)+g.charAt(k)+g.charAt(j)+g.charAt(h)}l=i.join("");l=l.slice(0,l.length-d.length)+d;return l};pidCryptUtil.decodeBase64=function(n,e){if(!n){n=""}var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e=(typeof e=="undefined")?false:e;var f,b,a,o,k,i,h,q,j=[],p,m;m=e?pidCryptUtil.decodeUTF8(n):n;for(var l=0;l<m.length;l+=4){o=g.indexOf(m.charAt(l));k=g.indexOf(m.charAt(l+1));i=g.indexOf(m.charAt(l+2));h=g.indexOf(m.charAt(l+3));q=o<<18|k<<12|i<<6|h;f=q>>>16&255;b=q>>>8&255;a=q&255;j[l/4]=String.fromCharCode(f,b,a);if(h==64){j[l/4]=String.fromCharCode(f,b)}if(i==64){j[l/4]=String.fromCharCode(f)}}p=j.join("");p=e?pidCryptUtil.decodeUTF8(p):p;return p};pidCryptUtil.encodeUTF8=function(a){if(!a){a=""}a=a.replace(/[\u0080-\u07ff]/g,function(d){var b=d.charCodeAt(0);return String.fromCharCode(192|b>>6,128|b&63)});a=a.replace(/[\u0800-\uffff]/g,function(d){var b=d.charCodeAt(0);return String.fromCharCode(224|b>>12,128|b>>6&63,128|b&63)});return a};pidCryptUtil.decodeUTF8=function(a){if(!a){a=""}a=a.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(d){var b=(d.charCodeAt(0)&31)<<6|d.charCodeAt(1)&63;return String.fromCharCode(b)});a=a.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(d){var b=((d.charCodeAt(0)&15)<<12)|((d.charCodeAt(1)&63)<<6)|(d.charCodeAt(2)&63);return String.fromCharCode(b)});return a};pidCryptUtil.convertToHex=function(d){if(!d){d=""}var c="";var a="";for(var b=0;b<d.length;b++){a=d.charCodeAt(b).toString(16);c+=(a.length==1)?"0"+a:a}return c};pidCryptUtil.convertFromHex=function(c){if(!c){c=""}var b="";for(var a=0;a<c.length;a+=2){b+=String.fromCharCode(parseInt(c.substring(a,a+2),16))}return b};pidCryptUtil.stripLineFeeds=function(b){if(!b){b=""}var a="";a=b.replace(/\n/g,"");a=a.replace(/\r/g,"");return a};pidCryptUtil.toByteArray=function(b){if(!b){b=""}var c=[];for(var a=0;a<b.length;a++){c[a]=b.charCodeAt(a)}return c};pidCryptUtil.fragment=function(e,d,a){if(!e){e=""}if(!d||d>=e.length){return e}if(!a){a="\n"}var c="";for(var b=0;b<e.length;b+=d){c+=e.substr(b,d)+a}return c};pidCryptUtil.formatHex=function(f,e){if(!f){f=""}if(!e){e=45}var a="";var b=0;var d=f.toLowerCase();for(var c=0;c<d.length;c+=2){a+=d.substr(c,2)+":"}d=this.fragment(a,e);return d};pidCryptUtil.byteArray2String=function(a){var d="";for(var c=0;c<a.length;c++){d+=String.fromCharCode(a[c])}return d};</script>
<script>function Stream(a,b){if(a instanceof Stream){this.enc=a.enc;this.pos=a.pos}else{this.enc=a;this.pos=b}}Stream.prototype.parseStringHex=function(e,a){if(typeof(a)=="undefined"){a=this.enc.length}var d="";for(var b=e;b<a;++b){var c=this.get(b);d+=this.hexDigits.charAt(c>>4)+this.hexDigits.charAt(c&15)}return d};Stream.prototype.get=function(a){if(a==undefined){a=this.pos++}if(a>=this.enc.length){throw"Requesting byte offset "+a+" on a stream of length "+this.enc.length}return this.enc[a]};Stream.prototype.hexDigits="0123456789ABCDEF";Stream.prototype.hexDump=function(e,a){var d="";for(var b=e;b<a;++b){var c=this.get(b);d+=this.hexDigits.charAt(c>>4)+this.hexDigits.charAt(c&15);if((b&15)==7){d+=" "}d+=((b&15)==15)?"\n":" "}return d};Stream.prototype.parseStringISO=function(d,a){var c="";for(var b=d;b<a;++b){c+=String.fromCharCode(this.get(b))}return c};Stream.prototype.parseStringUTF=function(f,a){var d="",e=0;for(var b=f;b<a;){var e=this.get(b++);if(e<128){d+=String.fromCharCode(e)}else{if((e>191)&&(e<224)){d+=String.fromCharCode(((e&31)<<6)|(this.get(b++)&63))}else{d+=String.fromCharCode(((e&15)<<12)|((this.get(b++)&63)<<6)|(this.get(b++)&63))}}}return d};Stream.prototype.reTime=/^((?:1[89]|2\d)?\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/;Stream.prototype.parseTime=function(d,b){var c=this.parseStringISO(d,b);var a=this.reTime.exec(c);if(!a){return"Unrecognized time: "+c}c=a[1]+"-"+a[2]+"-"+a[3]+" "+a[4];if(a[5]){c+=":"+a[5];if(a[6]){c+=":"+a[6];if(a[7]){c+="."+a[7]}}}if(a[8]){c+=" UTC";if(a[8]!="Z"){c+=a[8];if(a[9]){c+=":"+a[9]}}}return c};Stream.prototype.parseInteger=function(d,a){if((a-d)>4){return undefined}var c=0;for(var b=d;b<a;++b){c=(c<<8)|this.get(b)}return c};Stream.prototype.parseOID=function(g,a){var d,f=0,e=0;for(var c=g;c<a;++c){var b=this.get(c);f=(f<<7)|(b&127);e+=7;if(!(b&128)){if(d==undefined){d=parseInt(f/40)+"."+(f%40)}else{d+="."+((e>=31)?"big":f)}f=e=0}d+=String.fromCharCode()}return d};if(typeof(pidCrypt)!="undefined"){pidCrypt.ASN1=function(d,e,c,a,b){this.stream=d;this.header=e;this.length=c;this.tag=a;this.sub=b};pidCrypt.ASN1.prototype.toHexTree=function(){var c={};c.type=this.typeName();if(c.type!="SEQUENCE"){c.value=this.stream.parseStringHex(this.posContent(),this.posEnd())}if(this.sub!=null){c.sub=[];for(var b=0,a=this.sub.length;b<a;++b){c.sub[b]=this.sub[b].toHexTree()}}return c};pidCrypt.ASN1.prototype.typeName=function(){if(this.tag==undefined){return"unknown"}var c=this.tag>>6;var a=(this.tag>>5)&1;var b=this.tag&31;switch(c){case 0:switch(b){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString";default:return"Universal_"+b.toString(16)}case 1:return"Application_"+b.toString(16);case 2:return"["+b+"]";case 3:return"Private_"+b.toString(16)}};pidCrypt.ASN1.prototype.content=function(){if(this.tag==undefined){return null}var d=this.tag>>6;if(d!=0){return null}var b=this.tag&31;var c=this.posContent();var a=Math.abs(this.length);switch(b){case 1:return(this.stream.get(c)==0)?"false":"true";case 2:return this.stream.parseInteger(c,c+a);case 6:return this.stream.parseOID(c,c+a);case 12:return this.stream.parseStringUTF(c,c+a);case 18:case 19:case 20:case 21:case 22:case 26:return this.stream.parseStringISO(c,c+a);case 23:case 24:return this.stream.parseTime(c,c+a)}return null};pidCrypt.ASN1.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+((this.sub==null)?"null":this.sub.length)+"]"};pidCrypt.ASN1.prototype.print=function(b){if(b==undefined){b=""}document.writeln(b+this);if(this.sub!=null){b+="  ";for(var c=0,a=this.sub.length;c<a;++c){this.sub[c].print(b)}}};pidCrypt.ASN1.prototype.toPrettyString=function(b){if(b==undefined){b=""}var d=b+this.typeName()+" @"+this.stream.pos;if(this.length>=0){d+="+"}d+=this.length;if(this.tag&32){d+=" (constructed)"}else{if(((this.tag==3)||(this.tag==4))&&(this.sub!=null)){d+=" (encapsulates)"}}d+="\n";if(this.sub!=null){b+="  ";for(var c=0,a=this.sub.length;c<a;++c){d+=this.sub[c].toPrettyString(b)}}return d};pidCrypt.ASN1.prototype.toDOM=function(){var b=document.createElement("div");b.className="node";b.asn1=this;var g=document.createElement("div");g.className="head";var j=this.typeName();g.innerHTML=j;b.appendChild(g);this.head=g;var h=document.createElement("div");h.className="value";j="Offset: "+this.stream.pos+"<br/>";j+="Length: "+this.header+"+";if(this.length>=0){j+=this.length}else{j+=(-this.length)+" (undefined)"}if(this.tag&32){j+="<br/>(constructed)"}else{if(((this.tag==3)||(this.tag==4))&&(this.sub!=null)){j+="<br/>(encapsulates)"}}var e=this.content();if(e!=null){j+="<br/>Value:<br/><b>"+e+"</b>";if((typeof(oids)=="object")&&(this.tag==6)){var c=oids[e];if(c){if(c.d){j+="<br/>"+c.d}if(c.c){j+="<br/>"+c.c}if(c.w){j+="<br/>(warning!)"}}}}h.innerHTML=j;b.appendChild(h);var a=document.createElement("div");a.className="sub";if(this.sub!=null){for(var d=0,f=this.sub.length;d<f;++d){a.appendChild(this.sub[d].toDOM())}}b.appendChild(a);g.switchNode=b;g.onclick=function(){var i=this.switchNode;i.className=(i.className=="node collapsed")?"node":"node collapsed"};return b};pidCrypt.ASN1.prototype.posStart=function(){return this.stream.pos};pidCrypt.ASN1.prototype.posContent=function(){return this.stream.pos+this.header};pidCrypt.ASN1.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)};pidCrypt.ASN1.prototype.toHexDOM_sub=function(d,c,e,f,a){if(f>=a){return}var b=document.createElement("span");b.className=c;b.appendChild(document.createTextNode(e.hexDump(f,a)));d.appendChild(b)};pidCrypt.ASN1.prototype.toHexDOM=function(){var d=document.createElement("span");d.className="hex";this.head.hexNode=d;this.head.onmouseover=function(){this.hexNode.className="hexCurrent"};this.head.onmouseout=function(){this.hexNode.className="hex"};this.toHexDOM_sub(d,"tag",this.stream,this.posStart(),this.posStart()+1);this.toHexDOM_sub(d,(this.length>=0)?"dlen":"ulen",this.stream,this.posStart()+1,this.posContent());if(this.sub==null){d.appendChild(document.createTextNode(this.stream.hexDump(this.posContent(),this.posEnd())))}else{if(this.sub.length>0){var e=this.sub[0];var c=this.sub[this.sub.length-1];this.toHexDOM_sub(d,"intro",this.stream,this.posContent(),e.posStart());for(var b=0,a=this.sub.length;b<a;++b){d.appendChild(this.sub[b].toHexDOM())}this.toHexDOM_sub(d,"outro",this.stream,c.posEnd(),this.posEnd())}}return d};pidCrypt.ASN1.decodeLength=function(d){var b=d.get();var a=b&127;if(a==b){return a}if(a>3){throw"Length over 24 bits not supported at position "+(d.pos-1)}if(a==0){return -1}b=0;for(var c=0;c<a;++c){b=(b<<8)|d.get()}return b};pidCrypt.ASN1.hasContent=function(b,a,g){if(b&32){return true}if((b<3)||(b>4)){return false}var f=new Stream(g);if(b==3){f.get()}var e=f.get();if((e>>6)&1){return false}try{var d=pidCrypt.ASN1.decodeLength(f);return((f.pos-g.pos)+d==a)}catch(c){return false}};pidCrypt.ASN1.decode=function(i){if(!(i instanceof Stream)){i=new Stream(i,0)}var h=new Stream(i);var k=i.get();var f=pidCrypt.ASN1.decodeLength(i);var d=i.pos-h.pos;var a=null;if(pidCrypt.ASN1.hasContent(k,f,i)){var b=i.pos;if(k==3){i.get()}a=[];if(f>=0){var c=b+f;while(i.pos<c){a[a.length]=pidCrypt.ASN1.decode(i)}if(i.pos!=c){throw"Content size is not correct for container starting at offset "+b}}else{try{for(;;){var j=pidCrypt.ASN1.decode(i);if(j.tag==0){break}a[a.length]=j}f=b-i.pos}catch(g){throw"Exception while decoding undefined length content: "+g}}}else{i.pos+=f}return new pidCrypt.ASN1(h,d,f,k,a)};pidCrypt.ASN1.test=function(){var f=[{value:[39],expected:39},{value:[129,201],expected:201},{value:[131,254,220,186],expected:16702650},];for(var c=0,a=f.length;c<a;++c){var e=0;var d=new Stream(f[c].value,0);var b=pidCrypt.ASN1.decodeLength(d);if(b!=f[c].expected){document.write("In test["+c+"] expected "+f[c].expected+" got "+b+"\n")}}}};</script>
<!-- <script src="jsbn_c.js"> -->
<script>
  var dbits;var canary=244837814094590;var j_lm=((canary&16777215)==15715070);function BigInteger(e,d,f){if(e!=null){if("number"==typeof e){this.fromNumber(e,d,f)}else{if(d==null&&"string"!=typeof e){this.fromString(e,256)}else{this.fromString(e,d)}}}}function nbi(){return new BigInteger(null)}function am1(f,a,b,e,h,g){while(--g>=0){var d=a*this[f++]+b[e]+h;h=Math.floor(d/67108864);b[e++]=d&67108863}return h}function am2(f,q,r,e,o,a){var k=q&32767,p=q>>15;while(--a>=0){var d=this[f]&32767;var g=this[f++]>>15;var b=p*d+g*k;d=k*d+((b&32767)<<15)+r[e]+(o&1073741823);o=(d>>>30)+(b>>>15)+p*g+(o>>>30);r[e++]=d&1073741823}return o}function am3(f,q,r,e,o,a){var k=q&16383,p=q>>14;while(--a>=0){var d=this[f]&16383;var g=this[f++]>>14;var b=p*d+g*k;d=k*d+((b&16383)<<14)+r[e]+o;o=(d>>28)+(b>>14)+p*g;r[e++]=d&268435455}return o}if(j_lm&&(navigator.appName=="Microsoft Internet Explorer")){BigInteger.prototype.am=am2;dbits=30}else{if(j_lm&&(navigator.appName!="Netscape")){BigInteger.prototype.am=am1;dbits=26}else{BigInteger.prototype.am=am3;dbits=28}}BigInteger.prototype.DB=dbits;BigInteger.prototype.DM=((1<<dbits)-1);BigInteger.prototype.DV=(1<<dbits);var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP);BigInteger.prototype.F1=BI_FP-dbits;BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz";var BI_RC=new Array();var rr,vv;rr="0".charCodeAt(0);for(vv=0;vv<=9;++vv){BI_RC[rr++]=vv}rr="a".charCodeAt(0);for(vv=10;vv<36;++vv){BI_RC[rr++]=vv}rr="A".charCodeAt(0);for(vv=10;vv<36;++vv){BI_RC[rr++]=vv}function int2char(a){return BI_RM.charAt(a)}function intAt(b,a){var d=BI_RC[b.charCodeAt(a)];return(d==null)?-1:d}function bnpCopyTo(b){for(var a=this.t-1;a>=0;--a){b[a]=this[a]}b.t=this.t;b.s=this.s}function bnpFromInt(a){this.t=1;this.s=(a<0)?-1:0;if(a>0){this[0]=a}else{if(a<-1){this[0]=a+DV}else{this.t=0}}}function nbv(a){var b=nbi();b.fromInt(a);return b}function bnpFromString(h,c){var e;if(c==16){e=4}else{if(c==8){e=3}else{if(c==256){e=8}else{if(c==2){e=1}else{if(c==32){e=5}else{if(c==4){e=2}else{this.fromRadix(h,c);return}}}}}}this.t=0;this.s=0;var g=h.length,d=false,f=0;while(--g>=0){var a=(e==8)?h[g]&255:intAt(h,g);if(a<0){if(h.charAt(g)=="-"){d=true}continue}d=false;if(f==0){this[this.t++]=a}else{if(f+e>this.DB){this[this.t-1]|=(a&((1<<(this.DB-f))-1))<<f;this[this.t++]=(a>>(this.DB-f))}else{this[this.t-1]|=a<<f}}f+=e;if(f>=this.DB){f-=this.DB}}if(e==8&&(h[0]&128)!=0){this.s=-1;if(f>0){this[this.t-1]|=((1<<(this.DB-f))-1)<<f}}this.clamp();if(d){BigInteger.ZERO.subTo(this,this)}}function bnpClamp(){var a=this.s&this.DM;while(this.t>0&&this[this.t-1]==a){--this.t}}function bnToString(c){if(this.s<0){return"-"+this.negate().toString(c)}var e;if(c==16){e=4}else{if(c==8){e=3}else{if(c==2){e=1}else{if(c==32){e=5}else{if(c==4){e=2}else{return this.toRadix(c)}}}}}var g=(1<<e)-1,l,a=false,h="",f=this.t;var j=this.DB-(f*this.DB)%e;if(f-->0){if(j<this.DB&&(l=this[f]>>j)>0){a=true;h=int2char(l)}while(f>=0){if(j<e){l=(this[f]&((1<<j)-1))<<(e-j);l|=this[--f]>>(j+=this.DB-e)}else{l=(this[f]>>(j-=e))&g;if(j<=0){j+=this.DB;--f}}if(l>0){a=true}if(a){h+=int2char(l)}}}return a?h:"0"}function bnNegate(){var a=nbi();BigInteger.ZERO.subTo(this,a);return a}function bnAbs(){return(this.s<0)?this.negate():this}function bnCompareTo(b){var d=this.s-b.s;if(d!=0){return d}var c=this.t;d=c-b.t;if(d!=0){return d}while(--c>=0){if((d=this[c]-b[c])!=0){return d}}return 0}function nbits(a){var c=1,b;if((b=a>>>16)!=0){a=b;c+=16}if((b=a>>8)!=0){a=b;c+=8}if((b=a>>4)!=0){a=b;c+=4}if((b=a>>2)!=0){a=b;c+=2}if((b=a>>1)!=0){a=b;c+=1}return c}function bnBitLength(){if(this.t<=0){return 0}return this.DB*(this.t-1)+nbits(this[this.t-1]^(this.s&this.DM))}function bnpDLShiftTo(c,b){var a;for(a=this.t-1;a>=0;--a){b[a+c]=this[a]}for(a=c-1;a>=0;--a){b[a]=0}b.t=this.t+c;b.s=this.s}function bnpDRShiftTo(c,b){for(var a=c;a<this.t;++a){b[a-c]=this[a]}b.t=Math.max(this.t-c,0);b.s=this.s}function bnpLShiftTo(j,e){var b=j%this.DB;var a=this.DB-b;var g=(1<<a)-1;var f=Math.floor(j/this.DB),h=(this.s<<b)&this.DM,d;for(d=this.t-1;d>=0;--d){e[d+f+1]=(this[d]>>a)|h;h=(this[d]&g)<<b}for(d=f-1;d>=0;--d){e[d]=0}e[f]=h;e.t=this.t+f+1;e.s=this.s;e.clamp()}function bnpRShiftTo(g,d){d.s=this.s;var e=Math.floor(g/this.DB);if(e>=this.t){d.t=0;return}var b=g%this.DB;var a=this.DB-b;var f=(1<<b)-1;d[0]=this[e]>>b;for(var c=e+1;c<this.t;++c){d[c-e-1]|=(this[c]&f)<<a;d[c-e]=this[c]>>b}if(b>0){d[this.t-e-1]|=(this.s&f)<<a}d.t=this.t-e;d.clamp()}function bnpSubTo(d,f){var e=0,g=0,b=Math.min(d.t,this.t);while(e<b){g+=this[e]-d[e];f[e++]=g&this.DM;g>>=this.DB}if(d.t<this.t){g-=d.s;while(e<this.t){g+=this[e];f[e++]=g&this.DM;g>>=this.DB}g+=this.s}else{g+=this.s;while(e<d.t){g-=d[e];f[e++]=g&this.DM;g>>=this.DB}g-=d.s}f.s=(g<0)?-1:0;if(g<-1){f[e++]=this.DV+g}else{if(g>0){f[e++]=g}}f.t=e;f.clamp()}function bnpMultiplyTo(c,e){var b=this.abs(),f=c.abs();var d=b.t;e.t=d+f.t;while(--d>=0){e[d]=0}for(d=0;d<f.t;++d){e[d+b.t]=b.am(0,f[d],e,d,0,b.t)}e.s=0;e.clamp();if(this.s!=c.s){BigInteger.ZERO.subTo(e,e)}}function bnpSquareTo(d){var a=this.abs();var b=d.t=2*a.t;while(--b>=0){d[b]=0}for(b=0;b<a.t-1;++b){var e=a.am(b,a[b],d,2*b,0,1);if((d[b+a.t]+=a.am(b+1,2*a[b],d,2*b+1,e,a.t-b-1))>=a.DV){d[b+a.t]-=a.DV;d[b+a.t+1]=1}}if(d.t>0){d[d.t-1]+=a.am(b,a[b],d,2*b,0,1)}d.s=0;d.clamp()}function bnpDivRemTo(n,h,g){var w=n.abs();if(w.t<=0){return}var k=this.abs();if(k.t<w.t){if(h!=null){h.fromInt(0)}if(g!=null){this.copyTo(g)}return}if(g==null){g=nbi()}var d=nbi(),a=this.s,l=n.s;var v=this.DB-nbits(w[w.t-1]);if(v>0){w.lShiftTo(v,d);k.lShiftTo(v,g)}else{w.copyTo(d);k.copyTo(g)}var p=d.t;var b=d[p-1];if(b==0){return}var o=b*(1<<this.F1)+((p>1)?d[p-2]>>this.F2:0);var A=this.FV/o,z=(1<<this.F1)/o,x=1<<this.F2;var u=g.t,s=u-p,f=(h==null)?nbi():h;d.dlShiftTo(s,f);if(g.compareTo(f)>=0){g[g.t++]=1;g.subTo(f,g)}BigInteger.ONE.dlShiftTo(p,f);f.subTo(d,d);while(d.t<p){d[d.t++]=0}while(--s>=0){var c=(g[--u]==b)?this.DM:Math.floor(g[u]*A+(g[u-1]+x)*z);if((g[u]+=d.am(0,c,g,s,0,p))<c){d.dlShiftTo(s,f);g.subTo(f,g);while(g[u]<--c){g.subTo(f,g)}}}if(h!=null){g.drShiftTo(p,h);if(a!=l){BigInteger.ZERO.subTo(h,h)}}g.t=p;g.clamp();if(v>0){g.rShiftTo(v,g)}if(a<0){BigInteger.ZERO.subTo(g,g)}}function bnMod(b){var c=nbi();this.abs().divRemTo(b,null,c);if(this.s<0&&c.compareTo(BigInteger.ZERO)>0){b.subTo(c,c)}return c}function Classic(a){this.m=a}function cConvert(a){if(a.s<0||a.compareTo(this.m)>=0){return a.mod(this.m)}else{return a}}function cRevert(a){return a}function cReduce(a){a.divRemTo(this.m,null,a)}function cMulTo(a,c,b){a.multiplyTo(c,b);this.reduce(b)}function cSqrTo(a,b){a.squareTo(b);this.reduce(b)}Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;function bnpInvDigit(){if(this.t<1){return 0}var a=this[0];if((a&1)==0){return 0}var b=a&3;b=(b*(2-(a&15)*b))&15;b=(b*(2-(a&255)*b))&255;b=(b*(2-(((a&65535)*b)&65535)))&65535;b=(b*(2-a*b%this.DV))%this.DV;return(b>0)?this.DV-b:-b}function Montgomery(a){this.m=a;this.mp=a.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<(a.DB-15))-1;this.mt2=2*a.t}function montConvert(a){var b=nbi();a.abs().dlShiftTo(this.m.t,b);b.divRemTo(this.m,null,b);if(a.s<0&&b.compareTo(BigInteger.ZERO)>0){this.m.subTo(b,b)}return b}function montRevert(a){var b=nbi();a.copyTo(b);this.reduce(b);return b}function montReduce(a){while(a.t<=this.mt2){a[a.t++]=0}for(var c=0;c<this.m.t;++c){var b=a[c]&32767;var d=(b*this.mpl+(((b*this.mph+(a[c]>>15)*this.mpl)&this.um)<<15))&a.DM;b=c+this.m.t;a[b]+=this.m.am(0,d,a,c,0,this.m.t);while(a[b]>=a.DV){a[b]-=a.DV;a[++b]++}}a.clamp();a.drShiftTo(this.m.t,a);if(a.compareTo(this.m)>=0){a.subTo(this.m,a)}}function montSqrTo(a,b){a.squareTo(b);this.reduce(b)}function montMulTo(a,c,b){a.multiplyTo(c,b);this.reduce(b)}Montgomery.prototype.convert=montConvert;Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return((this.t>0)?(this[0]&1):this.s)==0}function bnpExp(h,j){if(h>4294967295||h<1){return BigInteger.ONE}var f=nbi(),a=nbi(),d=j.convert(this),c=nbits(h)-1;d.copyTo(f);while(--c>=0){j.sqrTo(f,a);if((h&(1<<c))>0){j.mulTo(a,d,f)}else{var b=f;f=a;a=b}}return j.revert(f)}function bnModPowInt(b,a){var c;if(b<256||a.isEven()){c=new Classic(a)}else{c=new Montgomery(a)}return this.exp(b,c)}BigInteger.prototype.copyTo=bnpCopyTo;BigInteger.prototype.fromInt=bnpFromInt;BigInteger.prototype.fromString=bnpFromString;BigInteger.prototype.clamp=bnpClamp;BigInteger.prototype.dlShiftTo=bnpDLShiftTo;BigInteger.prototype.drShiftTo=bnpDRShiftTo;BigInteger.prototype.lShiftTo=bnpLShiftTo;BigInteger.prototype.rShiftTo=bnpRShiftTo;BigInteger.prototype.subTo=bnpSubTo;BigInteger.prototype.multiplyTo=bnpMultiplyTo;BigInteger.prototype.squareTo=bnpSquareTo;BigInteger.prototype.divRemTo=bnpDivRemTo;BigInteger.prototype.invDigit=bnpInvDigit;BigInteger.prototype.isEven=bnpIsEven;BigInteger.prototype.exp=bnpExp;BigInteger.prototype.toString=bnToString;BigInteger.prototype.negate=bnNegate;BigInteger.prototype.abs=bnAbs;BigInteger.prototype.compareTo=bnCompareTo;BigInteger.prototype.bitLength=bnBitLength;BigInteger.prototype.mod=bnMod;BigInteger.prototype.modPowInt=bnModPowInt;BigInteger.ZERO=nbv(0);BigInteger.ONE=nbv(1);function bnClone(){var a=nbi();this.copyTo(a);return a}function bnIntValue(){if(this.s<0){if(this.t==1){return this[0]-this.DV}else{if(this.t==0){return -1}}}else{if(this.t==1){return this[0]}else{if(this.t==0){return 0}}}return((this[1]&((1<<(32-this.DB))-1))<<this.DB)|this[0]}function bnByteValue(){return(this.t==0)?this.s:(this[0]<<24)>>24}function bnShortValue(){return(this.t==0)?this.s:(this[0]<<16)>>16}function bnpChunkSize(a){return Math.floor(Math.LN2*this.DB/Math.log(a))}function bnSigNum(){if(this.s<0){return -1}else{if(this.t<=0||(this.t==1&&this[0]<=0)){return 0}else{return 1}}}function bnpToRadix(c){if(c==null){c=10}if(this.signum()==0||c<2||c>36){return"0"}var f=this.chunkSize(c);var e=Math.pow(c,f);var i=nbv(e),j=nbi(),h=nbi(),g="";this.divRemTo(i,j,h);while(j.signum()>0){g=(e+h.intValue()).toString(c).substr(1)+g;j.divRemTo(i,j,h)}return h.intValue().toString(c)+g}function bnpFromRadix(m,h){this.fromInt(0);if(h==null){h=10}var f=this.chunkSize(h);var g=Math.pow(h,f),e=false,a=0,l=0;for(var c=0;c<m.length;++c){var k=intAt(m,c);if(k<0){if(m.charAt(c)=="-"&&this.signum()==0){e=true}continue}l=h*l+k;if(++a>=f){this.dMultiply(g);this.dAddOffset(l,0);a=0;l=0}}if(a>0){this.dMultiply(Math.pow(h,a));this.dAddOffset(l,0)}if(e){BigInteger.ZERO.subTo(this,this)}}function bnpFromNumber(f,e,h){if("number"==typeof e){if(f<2){this.fromInt(1)}else{this.fromNumber(f,h);if(!this.testBit(f-1)){this.bitwiseTo(BigInteger.ONE.shiftLeft(f-1),op_or,this)}if(this.isEven()){this.dAddOffset(1,0)}while(!this.isProbablePrime(e)){this.dAddOffset(2,0);if(this.bitLength()>f){this.subTo(BigInteger.ONE.shiftLeft(f-1),this)}}}}else{var d=new Array(),g=f&7;d.length=(f>>3)+1;e.nextBytes(d);if(g>0){d[0]&=((1<<g)-1)}else{d[0]=0}this.fromString(d,256)}}function bnToByteArray(){var b=this.t,c=new Array();c[0]=this.s;var e=this.DB-(b*this.DB)%8,f,a=0;if(b-->0){if(e<this.DB&&(f=this[b]>>e)!=(this.s&this.DM)>>e){c[a++]=f|(this.s<<(this.DB-e))}while(b>=0){if(e<8){f=(this[b]&((1<<e)-1))<<(8-e);f|=this[--b]>>(e+=this.DB-8)}else{f=(this[b]>>(e-=8))&255;if(e<=0){e+=this.DB;--b}}if((f&128)!=0){f|=-256}if(a==0&&(this.s&128)!=(f&128)){++a}if(a>0||f!=this.s){c[a++]=f}}}return c}function bnEquals(b){return(this.compareTo(b)==0)}function bnMin(b){return(this.compareTo(b)<0)?this:b}function bnMax(b){return(this.compareTo(b)>0)?this:b}function bnpBitwiseTo(c,h,e){var d,g,b=Math.min(c.t,this.t);for(d=0;d<b;++d){e[d]=h(this[d],c[d])}if(c.t<this.t){g=c.s&this.DM;for(d=b;d<this.t;++d){e[d]=h(this[d],g)}e.t=this.t}else{g=this.s&this.DM;for(d=b;d<c.t;++d){e[d]=h(g,c[d])}e.t=c.t}e.s=h(this.s,c.s);e.clamp()}function op_and(a,b){return a&b}function bnAnd(b){var c=nbi();this.bitwiseTo(b,op_and,c);return c}function op_or(a,b){return a|b}function bnOr(b){var c=nbi();this.bitwiseTo(b,op_or,c);return c}function op_xor(a,b){return a^b}function bnXor(b){var c=nbi();this.bitwiseTo(b,op_xor,c);return c}function op_andnot(a,b){return a&~b}function bnAndNot(b){var c=nbi();this.bitwiseTo(b,op_andnot,c);return c}function bnNot(){var b=nbi();for(var a=0;a<this.t;++a){b[a]=this.DM&~this[a]}b.t=this.t;b.s=~this.s;return b}function bnShiftLeft(b){var a=nbi();if(b<0){this.rShiftTo(-b,a)}else{this.lShiftTo(b,a)}return a}function bnShiftRight(b){var a=nbi();if(b<0){this.lShiftTo(-b,a)}else{this.rShiftTo(b,a)}return a}function lbit(a){if(a==0){return -1}var b=0;if((a&65535)==0){a>>=16;b+=16}if((a&255)==0){a>>=8;b+=8}if((a&15)==0){a>>=4;b+=4}if((a&3)==0){a>>=2;b+=2}if((a&1)==0){++b}return b}function bnGetLowestSetBit(){for(var a=0;a<this.t;++a){if(this[a]!=0){return a*this.DB+lbit(this[a])}}if(this.s<0){return this.t*this.DB}return -1}function cbit(a){var b=0;while(a!=0){a&=a-1;++b}return b}function bnBitCount(){var c=0,a=this.s&this.DM;for(var b=0;b<this.t;++b){c+=cbit(this[b]^a)}return c}function bnTestBit(b){var a=Math.floor(b/this.DB);if(a>=this.t){return(this.s!=0)}return((this[a]&(1<<(b%this.DB)))!=0)}function bnpChangeBit(c,b){var a=BigInteger.ONE.shiftLeft(c);this.bitwiseTo(a,b,a);return a}function bnSetBit(a){return this.changeBit(a,op_or)}function bnClearBit(a){return this.changeBit(a,op_andnot)}function bnFlipBit(a){return this.changeBit(a,op_xor)}function bnpAddTo(d,f){var e=0,g=0,b=Math.min(d.t,this.t);while(e<b){g+=this[e]+d[e];f[e++]=g&this.DM;g>>=this.DB}if(d.t<this.t){g+=d.s;while(e<this.t){g+=this[e];f[e++]=g&this.DM;g>>=this.DB}g+=this.s}else{g+=this.s;while(e<d.t){g+=d[e];f[e++]=g&this.DM;g>>=this.DB}g+=d.s}f.s=(g<0)?-1:0;if(g>0){f[e++]=g}else{if(g<-1){f[e++]=this.DV+g}}f.t=e;f.clamp()}function bnAdd(b){var c=nbi();this.addTo(b,c);return c}function bnSubtract(b){var c=nbi();this.subTo(b,c);return c}function bnMultiply(b){var c=nbi();this.multiplyTo(b,c);return c}function bnDivide(b){var c=nbi();this.divRemTo(b,c,null);return c}function bnRemainder(b){var c=nbi();this.divRemTo(b,null,c);return c}function bnDivideAndRemainder(b){var d=nbi(),c=nbi();this.divRemTo(b,d,c);return new Array(d,c)}function bnpDMultiply(a){this[this.t]=this.am(0,a-1,this,0,0,this.t);++this.t;this.clamp()}function bnpDAddOffset(b,a){while(this.t<=a){this[this.t++]=0}this[a]+=b;while(this[a]>=this.DV){this[a]-=this.DV;if(++a>=this.t){this[this.t++]=0}++this[a]}}function NullExp(){}function nNop(a){return a}function nMulTo(a,c,b){a.multiplyTo(c,b)}function nSqrTo(a,b){a.squareTo(b)}NullExp.prototype.convert=nNop;NullExp.prototype.revert=nNop;NullExp.prototype.mulTo=nMulTo;NullExp.prototype.sqrTo=nSqrTo;function bnPow(a){return this.exp(a,new NullExp())}function bnpMultiplyLowerTo(b,f,e){var d=Math.min(this.t+b.t,f);e.s=0;e.t=d;while(d>0){e[--d]=0}var c;for(c=e.t-this.t;d<c;++d){e[d+this.t]=this.am(0,b[d],e,d,0,this.t)}for(c=Math.min(b.t,f);d<c;++d){this.am(0,b[d],e,d,0,f-d)}e.clamp()}function bnpMultiplyUpperTo(b,e,d){--e;var c=d.t=this.t+b.t-e;d.s=0;while(--c>=0){d[c]=0}for(c=Math.max(e-this.t,0);c<b.t;++c){d[this.t+c-e]=this.am(e-c,b[c],d,0,0,this.t+c-e)}d.clamp();d.drShiftTo(1,d)}function Barrett(a){this.r2=nbi();this.q3=nbi();BigInteger.ONE.dlShiftTo(2*a.t,this.r2);this.mu=this.r2.divide(a);this.m=a}function barrettConvert(a){if(a.s<0||a.t>2*this.m.t){return a.mod(this.m)}else{if(a.compareTo(this.m)<0){return a}else{var b=nbi();a.copyTo(b);this.reduce(b);return b}}}function barrettRevert(a){return a}function barrettReduce(a){a.drShiftTo(this.m.t-1,this.r2);if(a.t>this.m.t+1){a.t=this.m.t+1;a.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(a.compareTo(this.r2)<0){a.dAddOffset(1,this.m.t+1)}a.subTo(this.r2,a);while(a.compareTo(this.m)>=0){a.subTo(this.m,a)}}function barrettSqrTo(a,b){a.squareTo(b);this.reduce(b)}function barrettMulTo(a,c,b){a.multiplyTo(c,b);this.reduce(b)}Barrett.prototype.convert=barrettConvert;Barrett.prototype.revert=barrettRevert;Barrett.prototype.reduce=barrettReduce;Barrett.prototype.mulTo=barrettMulTo;Barrett.prototype.sqrTo=barrettSqrTo;function bnModPow(q,f){var o=q.bitLength(),h,b=nbv(1),v;if(o<=0){return b}else{if(o<18){h=1}else{if(o<48){h=3}else{if(o<144){h=4}else{if(o<768){h=5}else{h=6}}}}}if(o<8){v=new Classic(f)}else{if(f.isEven()){v=new Barrett(f)}else{v=new Montgomery(f)}}var p=new Array(),d=3,s=h-1,a=(1<<h)-1;p[1]=v.convert(this);if(h>1){var A=nbi();v.sqrTo(p[1],A);while(d<=a){p[d]=nbi();v.mulTo(A,p[d-2],p[d]);d+=2}}var l=q.t-1,x,u=true,c=nbi(),y;o=nbits(q[l])-1;while(l>=0){if(o>=s){x=(q[l]>>(o-s))&a}else{x=(q[l]&((1<<(o+1))-1))<<(s-o);if(l>0){x|=q[l-1]>>(this.DB+o-s)}}d=h;while((x&1)==0){x>>=1;--d}if((o-=d)<0){o+=this.DB;--l}if(u){p[x].copyTo(b);u=false}else{while(d>1){v.sqrTo(b,c);v.sqrTo(c,b);d-=2}if(d>0){v.sqrTo(b,c)}else{y=b;b=c;c=y}v.mulTo(c,p[x],b)}while(l>=0&&(q[l]&(1<<o))==0){v.sqrTo(b,c);y=b;b=c;c=y;if(--o<0){o=this.DB-1;--l}}}return v.revert(b)}function bnGCD(c){var b=(this.s<0)?this.negate():this.clone();var h=(c.s<0)?c.negate():c.clone();if(b.compareTo(h)<0){var e=b;b=h;h=e}var d=b.getLowestSetBit(),f=h.getLowestSetBit();if(f<0){return b}if(d<f){f=d}if(f>0){b.rShiftTo(f,b);h.rShiftTo(f,h)}while(b.signum()>0){if((d=b.getLowestSetBit())>0){b.rShiftTo(d,b)}if((d=h.getLowestSetBit())>0){h.rShiftTo(d,h)}if(b.compareTo(h)>=0){b.subTo(h,b);b.rShiftTo(1,b)}else{h.subTo(b,h);h.rShiftTo(1,h)}}if(f>0){h.lShiftTo(f,h)}return h}function bnpModInt(e){if(e<=0){return 0}var c=this.DV%e,b=(this.s<0)?e-1:0;if(this.t>0){if(c==0){b=this[0]%e}else{for(var a=this.t-1;a>=0;--a){b=(c*b+this[a])%e}}}return b}function bnModInverse(f){var j=f.isEven();if((this.isEven()&&j)||f.signum()==0){return BigInteger.ZERO}var i=f.clone(),h=this.clone();var g=nbv(1),e=nbv(0),l=nbv(0),k=nbv(1);while(i.signum()!=0){while(i.isEven()){i.rShiftTo(1,i);if(j){if(!g.isEven()||!e.isEven()){g.addTo(this,g);e.subTo(f,e)}g.rShiftTo(1,g)}else{if(!e.isEven()){e.subTo(f,e)}}e.rShiftTo(1,e)}while(h.isEven()){h.rShiftTo(1,h);if(j){if(!l.isEven()||!k.isEven()){l.addTo(this,l);k.subTo(f,k)}l.rShiftTo(1,l)}else{if(!k.isEven()){k.subTo(f,k)}}k.rShiftTo(1,k)}if(i.compareTo(h)>=0){i.subTo(h,i);if(j){g.subTo(l,g)}e.subTo(k,e)}else{h.subTo(i,h);if(j){l.subTo(g,l)}k.subTo(e,k)}}if(h.compareTo(BigInteger.ONE)!=0){return BigInteger.ZERO}if(k.compareTo(f)>=0){return k.subtract(f)}if(k.signum()<0){k.addTo(f,k)}else{return k}if(k.signum()<0){return k.add(f)}else{return k}}var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509];var lplim=(1<<26)/lowprimes[lowprimes.length-1];function bnIsProbablePrime(e){var d,b=this.abs();if(b.t==1&&b[0]<=lowprimes[lowprimes.length-1]){for(d=0;d<lowprimes.length;++d){if(b[0]==lowprimes[d]){return true}}return false}if(b.isEven()){return false}d=1;while(d<lowprimes.length){var a=lowprimes[d],c=d+1;while(c<lowprimes.length&&a<lplim){a*=lowprimes[c++]}a=b.modInt(a);while(d<c){if(a%lowprimes[d++]==0){return false}}}return b.millerRabin(e)}function bnpMillerRabin(f){var g=this.subtract(BigInteger.ONE);var c=g.getLowestSetBit();if(c<=0){return false}var h=g.shiftRight(c);f=(f+1)>>1;if(f>lowprimes.length){f=lowprimes.length}var b=nbi();for(var e=0;e<f;++e){b.fromInt(lowprimes[e]);var l=b.modPow(h,this);if(l.compareTo(BigInteger.ONE)!=0&&l.compareTo(g)!=0){var d=1;while(d++<c&&l.compareTo(g)!=0){l=l.modPowInt(2,this);if(l.compareTo(BigInteger.ONE)==0){return false}}if(l.compareTo(g)!=0){return false}}}return true}BigInteger.prototype.chunkSize=bnpChunkSize;BigInteger.prototype.toRadix=bnpToRadix;BigInteger.prototype.fromRadix=bnpFromRadix;BigInteger.prototype.fromNumber=bnpFromNumber;BigInteger.prototype.bitwiseTo=bnpBitwiseTo;BigInteger.prototype.changeBit=bnpChangeBit;BigInteger.prototype.addTo=bnpAddTo;BigInteger.prototype.dMultiply=bnpDMultiply;BigInteger.prototype.dAddOffset=bnpDAddOffset;BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo;BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo;BigInteger.prototype.modInt=bnpModInt;BigInteger.prototype.millerRabin=bnpMillerRabin;BigInteger.prototype.clone=bnClone;BigInteger.prototype.intValue=bnIntValue;BigInteger.prototype.byteValue=bnByteValue;BigInteger.prototype.shortValue=bnShortValue;BigInteger.prototype.signum=bnSigNum;BigInteger.prototype.toByteArray=bnToByteArray;BigInteger.prototype.equals=bnEquals;BigInteger.prototype.min=bnMin;BigInteger.prototype.max=bnMax;BigInteger.prototype.and=bnAnd;BigInteger.prototype.or=bnOr;BigInteger.prototype.xor=bnXor;BigInteger.prototype.andNot=bnAndNot;BigInteger.prototype.not=bnNot;BigInteger.prototype.shiftLeft=bnShiftLeft;BigInteger.prototype.shiftRight=bnShiftRight;BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit;BigInteger.prototype.bitCount=bnBitCount;BigInteger.prototype.testBit=bnTestBit;BigInteger.prototype.setBit=bnSetBit;BigInteger.prototype.clearBit=bnClearBit;BigInteger.prototype.flipBit=bnFlipBit;BigInteger.prototype.add=bnAdd;BigInteger.prototype.subtract=bnSubtract;BigInteger.prototype.multiply=bnMultiply;BigInteger.prototype.divide=bnDivide;BigInteger.prototype.remainder=bnRemainder;BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder;BigInteger.prototype.modPow=bnModPow;BigInteger.prototype.modInverse=bnModInverse;BigInteger.prototype.pow=bnPow;BigInteger.prototype.gcd=bnGCD;BigInteger.prototype.isProbablePrime=bnIsProbablePrime;
</script>
<script>function SecureRandom(){this.rng_state;this.rng_pool;this.rng_pptr;this.rng_seed_int=function(c){this.rng_pool[this.rng_pptr++]^=c&255;this.rng_pool[this.rng_pptr++]^=(c>>8)&255;this.rng_pool[this.rng_pptr++]^=(c>>16)&255;this.rng_pool[this.rng_pptr++]^=(c>>24)&255;if(this.rng_pptr>=rng_psize){this.rng_pptr-=rng_psize}};this.rng_seed_time=function(){this.rng_seed_int(new Date().getTime())};if(this.rng_pool==null){this.rng_pool=new Array();this.rng_pptr=0;var a;if(navigator.appName=="Netscape"&&navigator.appVersion<"5"&&window.crypto){var b=window.crypto.random(32);for(a=0;a<b.length;++a){this.rng_pool[this.rng_pptr++]=b.charCodeAt(a)&255}}while(this.rng_pptr<rng_psize){a=Math.floor(65536*Math.random());this.rng_pool[this.rng_pptr++]=a>>>8;this.rng_pool[this.rng_pptr++]=a&255}this.rng_pptr=0;this.rng_seed_time()}this.rng_get_byte=function(){if(this.rng_state==null){this.rng_seed_time();this.rng_state=prng_newstate();this.rng_state.init(this.rng_pool);for(this.rng_pptr=0;this.rng_pptr<this.rng_pool.length;++this.rng_pptr){this.rng_pool[this.rng_pptr]=0}this.rng_pptr=0}return this.rng_state.next()};this.nextBytes=function(d){var c;for(c=0;c<d.length;++c){d[c]=this.rng_get_byte()}}};</script>
<script>function Arcfour(){this.i=0;this.j=0;this.S=new Array()}function ARC4init(d){var c,a,b;for(c=0;c<256;++c){this.S[c]=c}a=0;for(c=0;c<256;++c){a=(a+this.S[c]+d[c%d.length])&255;b=this.S[c];this.S[c]=this.S[a];this.S[a]=b}this.i=0;this.j=0}function ARC4next(){var a;this.i=(this.i+1)&255;this.j=(this.j+this.S[this.i])&255;a=this.S[this.i];this.S[this.i]=this.S[this.j];this.S[this.j]=a;return this.S[(a+this.S[this.i])&255]}Arcfour.prototype.init=ARC4init;Arcfour.prototype.next=ARC4next;function prng_newstate(){return new Arcfour()}var rng_psize=256;</script>
<script>if(typeof(pidCrypt)!="undefined"&&typeof(BigInteger)!="undefined"&&typeof(SecureRandom)!="undefined"&&typeof(Arcfour)!="undefined"){function parseBigInt(b,a){return new BigInteger(b,a)}function linebrk(c,d){var a="";var b=0;while(b+d<c.length){a+=c.substring(b,b+d)+"\n";b+=d}return a+c.substring(b,c.length)}function byte2Hex(a){if(a<16){return"0"+a.toString(16)}else{return a.toString(16)}}function pkcs1unpad2(f,g){var a=f.toByteArray();var e=0;while(e<a.length&&a[e]==0){++e}if(a.length-e!=g-1||a[e]!=2){return null}++e;while(a[e]!=0){if(++e>=a.length){return null}}var c="";while(++e<a.length){c+=String.fromCharCode(a[e])}return c}function pkcs1pad2(d,f){if(f<d.length+11){alert("Message too long for RSA");return null}var e=new Array();var c=d.length-1;while(c>=0&&f>0){e[--f]=d.charCodeAt(c--)}e[--f]=0;var b=new SecureRandom();var a=new Array();while(f>2){a[0]=0;while(a[0]==0){b.nextBytes(a)}e[--f]=a[0]}e[--f]=2;e[--f]=0;return new BigInteger(e)}pidCrypt.RSA=function(){this.n=null;this.e=0;this.d=null;this.p=null;this.q=null;this.dmp1=null;this.dmq1=null;this.coeff=null};pidCrypt.RSA.prototype.doPrivate=function(a){if(this.p==null||this.q==null){return a.modPow(this.d,this.n)}var c=a.mod(this.p).modPow(this.dmp1,this.p);var b=a.mod(this.q).modPow(this.dmq1,this.q);while(c.compareTo(b)<0){c=c.add(this.p)}return c.subtract(b).multiply(this.coeff).mod(this.p).multiply(this.q).add(b)};pidCrypt.RSA.prototype.setPublic=function(c,b,a){if(typeof(a)=="undefined"){a=16}if(c!=null&&b!=null&&c.length>0&&b.length>0){this.n=parseBigInt(c,a);this.e=parseInt(b,a)}else{alert("Invalid RSA public key")}};pidCrypt.RSA.prototype.doPublic=function(a){return a.modPowInt(this.e,this.n)};pidCrypt.RSA.prototype.encryptRaw=function(d){var a=pkcs1pad2(d,(this.n.bitLength()+7)>>3);if(a==null){return null}var e=this.doPublic(a);if(e==null){return null}var b=e.toString(16);if((b.length&1)==0){return b}else{return"0"+b}};pidCrypt.RSA.prototype.encrypt=function(a){a=pidCryptUtil.encodeBase64(a);return this.encryptRaw(a)};pidCrypt.RSA.prototype.decryptRaw=function(b){var d=parseBigInt(b,16);var a=this.doPrivate(d);if(a==null){return null}return pkcs1unpad2(a,(this.n.bitLength()+7)>>3)};pidCrypt.RSA.prototype.decrypt=function(b){var a=this.decryptRaw(b);a=(a)?pidCryptUtil.decodeBase64(a):"";return a};pidCrypt.RSA.prototype.setPrivate=function(d,b,c,a){if(typeof(a)=="undefined"){a=16}if(d!=null&&b!=null&&d.length>0&&b.length>0){this.n=parseBigInt(d,a);this.e=parseInt(b,a);this.d=parseBigInt(c,a)}else{alert("Invalid RSA private key")}};pidCrypt.RSA.prototype.setPrivateEx=function(e,i,a,d,c,h,g,b,f){if(typeof(f)=="undefined"){f=16}if(e!=null&&i!=null&&e.length>0&&i.length>0){this.n=parseBigInt(e,f);this.e=parseInt(i,f);this.d=parseBigInt(a,f);this.p=parseBigInt(d,f);this.q=parseBigInt(c,f);this.dmp1=parseBigInt(h,f);this.dmq1=parseBigInt(g,f);this.coeff=parseBigInt(b,f)}else{alert("Invalid RSA private key")}};pidCrypt.RSA.prototype.generate=function(b,i){var a=new SecureRandom();var f=b>>1;this.e=parseInt(i,16);var c=new BigInteger(i,16);for(;;){for(;;){this.p=new BigInteger(b-f,1,a);if(this.p.subtract(BigInteger.ONE).gcd(c).compareTo(BigInteger.ONE)==0&&this.p.isProbablePrime(10)){break}}for(;;){this.q=new BigInteger(f,1,a);if(this.q.subtract(BigInteger.ONE).gcd(c).compareTo(BigInteger.ONE)==0&&this.q.isProbablePrime(10)){break}}if(this.p.compareTo(this.q)<=0){var h=this.p;this.p=this.q;this.q=h}var g=this.p.subtract(BigInteger.ONE);var d=this.q.subtract(BigInteger.ONE);var e=g.multiply(d);if(e.gcd(c).compareTo(BigInteger.ONE)==0){this.n=this.p.multiply(this.q);this.d=c.modInverse(e);this.dmp1=this.d.mod(g);this.dmq1=this.d.mod(d);this.coeff=this.q.modInverse(this.p);break}}};pidCrypt.RSA.prototype.getASNData=function(a){var e={};var c=[];var d=0;if(a.value&&a.type=="INTEGER"){c[d++]=a.value}if(a.sub){for(var b=0;b<a.sub.length;b++){c=c.concat(this.getASNData(a.sub[b]))}}return c};pidCrypt.RSA.prototype.setKeyFromASN=function(c,e){var d=["N","E","D","P","Q","DP","DQ","C"];var f={};var a=this.getASNData(e);switch(c){case"Public":case"public":for(var b=0;b<a.length;b++){f[d[b]]=a[b].toLowerCase()}this.setPublic(f.N,f.E,16);break;case"Private":case"private":for(var b=1;b<a.length;b++){f[d[b-1]]=a[b].toLowerCase()}this.setPrivateEx(f.N,f.E,f.D,f.P,f.Q,f.DP,f.DQ,f.C,16);break}};pidCrypt.RSA.prototype.setPublicKeyFromASN=function(a){this.setKeyFromASN("public",a)};pidCrypt.RSA.prototype.setPrivateKeyFromASN=function(a){this.setKeyFromASN("private",a)};pidCrypt.RSA.prototype.getParameters=function(){var a={};if(this.n!=null){a.n=this.n}a.e=this.e;if(this.d!=null){a.d=this.d}if(this.p!=null){a.p=this.p}if(this.q!=null){a.q=this.q}if(this.dmp1!=null){a.dmp1=this.dmp1}if(this.dmq1!=null){a.dmq1=this.dmq1}if(this.coeff!=null){a.c=this.coeff}return a}};</script>

<script>
  /**
   * @polymerBehavior ballotEncryptionBehavior
   */
  Polymer.ballotEncryptionBehavior = {

    certParser: function (cert) {
      var lines = cert.split('\n');
      var read = false;
      var b64 = false;
      var end = false;
      var flag = '';
      var retObj = {};
      retObj.info = '';
      retObj.salt = '';
      //retObj.iv;
      retObj.b64 = '';
      retObj.aes = false;
      retObj.mode = '';
      retObj.bits = 0;
      for(var i=0; i< lines.length; i++){
        flag = lines[i].substr(0,9);
        if(i==1 && flag != 'Proc-Type' && flag.indexOf('M') == 0)//unencrypted cert?
          b64 = true;
        switch(flag){
          case '-----BEGI':
            read = true;
            break;
          case 'Proc-Type':
            if(read)
              retObj.info = lines[i];
            break;
          case 'DEK-Info:':
            if(read){
              var tmp = lines[i].split(',');
              var dek = tmp[0].split(': ');
              var aes = dek[1].split('-');
              retObj.aes = (aes[0] == 'AES') ? true : false;
              retObj.mode = aes[2];
              retObj.bits = parseInt(aes[1]);
              retObj.salt = tmp[1].substr(0,16);
              retObj.iv = tmp[1];
            }
            break;
          case '':
            if(read)
              b64 = true;
            break;
          case '-----END ':
            if(read){
              b64 = false;
              read = false;
            }
            break;
          default:
            if(read && b64)
              retObj.b64 += pidCryptUtil.stripLineFeeds(lines[i]);
        }
      }
      return retObj;
    },

    encryptVote: function (selectedItemIds) {
      var encryptedVote;

      if (window.appGlobals.votePublicKey) {
        var params = this.certParser(window.appGlobals.votePublicKey);
        if(params.b64) {
          try {
            var key = pidCryptUtil.decodeBase64(params.b64);
            //new RSA instance
            var rsa = new pidCrypt.RSA();
            //RSA encryption
            //ASN1 parsing
            var asn = pidCrypt.ASN1.decode(pidCryptUtil.toByteArray(key));
            //alert(asn);
            var tree = asn.toHexTree();
            //setting the public key for encryption
            rsa.setPublicKeyFromASN(tree);
            crypted = rsa.encrypt(JSON.stringify(selectedItemIds));
            encryptedVote = pidCryptUtil.fragment(pidCryptUtil.encodeBase64(pidCryptUtil.convertFromHex(crypted)),64);
            return encryptedVote;
          } catch(err) {
            this.fire('oav-error', this.localize('error_encryption', 'err', err));
            return null;
          }
        } else {
          this.fire('oav-error', this.localize('error_invalid_public_key'));
          return null;
        }
      } else {
        this.fire('oav-error', this.localize('error_public_key_not_found'));
        return null;
      }
    }
  }
</script>
<script>// PolymerTS - Polymer for TypeScript
//
// https://github.com/nippur72/PolymerTS
//
// Antonino Porcino, nino.porcino@gmail.com
var polymer;
(function (polymer) {
    // create an ES6 inheritable Polymer.Base object, referenced as "polymer.Base"
    function createEs6PolymerBase() {
        // create a placeholder class
        var pb = function () { };
        // make it available as polymer.Base
        window["polymer"]["Base"] = pb;
        // add a default create method()
        pb["create"] = function () {
            throw "element not yet registered in Polymer";
        };
        // add a default create method()
        pb["register"] = function (dontRegister) {
            if (dontRegister === true)
                polymer.createClass(this);
            else
                polymer.createElement(this);
        };
    }
    polymer.createEs6PolymerBase = createEs6PolymerBase;
    function prepareForRegistration(elementClass) {
        // copies members from inheritance chain to Polymer object
        function copyMembers(dest, source) {
            if (source === undefined || source === null)
                return;
            Object.keys(source).map(function (member) {
                // copy only if has not been defined
                if (!dest.hasOwnProperty(member))
                    dest[member] = source[member];
            });
            copyMembers(dest, source.__proto__);
        }
        // backward compatibility with TypeScript 1.4 (no decorators)
        if (elementClass.prototype.is === undefined) {
            var proto = elementClass.prototype;
            var instance = new elementClass();
            if (!instance.is) {
                throw new Error("no name for " + elementClass);
            }
            proto.is = instance.is;
            if (instance.extends) {
                proto.extends = instance.extends;
            }
            if (instance.properties) {
                proto.properties = instance.properties;
            }
            if (instance.listeners) {
                proto.listeners = instance.listeners;
            }
            if (instance.observers) {
                proto.observers = instance.observers;
            }
            if (instance.behaviors) {
                proto.behaviors = instance.behaviors;
            }
            if (instance.hostAttributes) {
                proto.hostAttributes = instance.hostAttributes;
            }
            if (instance.style) {
                proto.style = instance.style;
            }
            if (instance.template) {
                proto.template = instance.template;
            }
        }
        var preparedElement = elementClass.prototype;
        // artificial constructor: call constructor() and copies members
        preparedElement["$custom_cons"] = function () {
            // reads arguments coming from factoryImpl
            var args = this.$custom_cons_args;
            // applies class constructor on the polymer element (this)
            elementClass.apply(this, args);
        };
        // arguments for artifical constructor
        preparedElement["$custom_cons_args"] = [];
        // modify "factoryImpl"
        if (preparedElement["factoryImpl"] !== undefined) {
            throw "do not use factoryImpl() use constructor() instead";
        }
        else {
            preparedElement["factoryImpl"] = function () {
                this.$custom_cons_args = arguments;
            };
        }
        // modify "attached" event function
        var attachToFunction = "attached";
        var oldFunction = preparedElement[attachToFunction];
        preparedElement[attachToFunction] = function () {
            this.$custom_cons();
            if (oldFunction !== undefined)
                oldFunction.apply(this);
        };
        // copy inherited class members
        copyMembers(preparedElement, elementClass.prototype.__proto__);
        return preparedElement;
    }
    polymer.prepareForRegistration = prepareForRegistration;
    /*
    // see https://github.com/Polymer/polymer/issues/2114
    export function createDomModule(definition: polymer.Element) {
       var domModule: any = document.createElement('dom-module');
 
       var proto = <any> definition.prototype;
 
       domModule.id = proto.is;
 
       // attaches style
       if (proto.style !== undefined) {
          var elemStyle = (<any> document).createElement('style', 'custom-style');
          domModule.appendChild(elemStyle);
          elemStyle.textContent = proto.style;
       }
 
       // attaches template
       if (proto.template !== undefined) {
          var elemTemplate = document.createElement('template');
          domModule.appendChild(elemTemplate);
          elemTemplate.innerHTML = proto.template;
       }
 
       // tells polymer the element has been created
       domModule.createdCallback();
    }
    */
    // a version that works in IE11 too
    function createDomModule(definition) {
        var domModule = document.createElement('dom-module');
        var proto = definition.prototype;
        domModule.id = proto.is;
        var html = "";
        var style = "";
        if (proto.style !== undefined)
            style = "<style>" + proto.style + "</style>";
        if (proto.template !== undefined)
            html = "<template>" + style + proto.template + "</template>";
        domModule.innerHTML = html;
        domModule.createdCallback();
    }
    polymer.createDomModule = createDomModule;
    /*
    // temporary version until https://github.com/Polymer/polymer/issues/2114 is fixed
    export function createDomModule(definition: polymer.Element) {
       var contentDoc = document.implementation.createHTMLDocument('template');
 
       var domModule: any = document.createElement('dom-module');
 
       var proto = <any> definition.prototype;
 
       domModule.id = proto.is;
 
       // attaches style
       if (proto.style !== undefined) {
          var elemStyle = (<any> document).createElement('style', 'custom-style');
          domModule.appendChild(elemStyle);
          elemStyle.textContent = proto.style;
       }
 
       // attaches template
       if (proto.template !== undefined) {
          var elemTemplate = document.createElement('template');
          domModule.appendChild(elemTemplate);
          contentDoc.body.innerHTML = proto.template;
          while (contentDoc.body.firstChild) {
            (<any>elemTemplate).content.appendChild(contentDoc.body.firstChild);
          }
       }
 
       // tells polymer the element has been created
       domModule.createdCallback();
    }
    */
    function createElement(element) {
        if (polymer.isRegistered(element)) {
            throw "element already registered in Polymer";
        }
        if ((element.prototype).template !== undefined || (element.prototype).style !== undefined) {
            polymer.createDomModule(element);
        }
        // register element and make available its constructor as "create()"
        var maker = Polymer(polymer.prepareForRegistration(element));
        element["create"] = function () {
            var newOb = Object.create(maker.prototype);
            return maker.apply(newOb, arguments);
        };
        return maker;
    }
    polymer.createElement = createElement;
    function createClass(element) {
        if (polymer.isRegistered(element)) {
            throw "element already registered in Polymer";
        }
        if ((element.prototype).template !== undefined || (element.prototype).style !== undefined) {
            polymer.createDomModule(element);
        }
        // register element and make available its constructor as "create()"
        var maker = Polymer.Class(polymer.prepareForRegistration(element));
        element["create"] = function () {
            var newOb = Object.create(maker.prototype);
            return maker.apply(newOb, arguments);
        };
        return maker;
    }
    polymer.createClass = createClass;
    function isRegistered(element) {
        return (element.prototype).$custom_cons !== undefined;
    }
    polymer.isRegistered = isRegistered;
})(polymer || (polymer = {})); // end module
// modifies Polymer.Base and makes it available as an ES6 class named polymer.Base
polymer.createEs6PolymerBase();
// @component decorator
function component(tagname, extendsTag) {
    return function (target) {
        target.prototype["is"] = tagname;
        if (extendsTag !== undefined) {
            target.prototype["extends"] = extendsTag;
        }
    };
}
// @extend decorator
function extend(tagname) {
    return function (target) {
        target.prototype["extends"] = tagname;
    };
}
// @template decorator
function template(templateString) {
    return function (target) {
        target.prototype["template"] = templateString;
    };
}
// @style decorator
function style(styleString) {
    return function (target) {
        target.prototype["style"] = styleString;
    };
}
// @hostAttributes decorator
function hostAttributes(attributes) {
    return function (target) {
        target.prototype["hostAttributes"] = attributes;
    };
}
// @property decorator with automatic name for computed props
function property(ob) {
    return function (target, propertyKey) {
        target.properties = target.properties || {};
        if (typeof (target[propertyKey]) === "function") {
            // property is function, treat it as a computed property
            var params = ob["computed"];
            var getterName = "get_computed_" + propertyKey;
            ob["computed"] = getterName + "(" + params + ")";
            target.properties[propertyKey] = ob;
            target[getterName] = target[propertyKey];
        }
        else {
            // normal property
            target.properties[propertyKey] = ob || {};
        }
    };
}
// @computed decorator
function computed(ob) {
    return function (target, computedFuncName) {
        target.properties = target.properties || {};
        var propOb = ob || {};
        var getterName = "get_computed_" + computedFuncName;
        var funcText = target[computedFuncName].toString();
        var start = funcText.indexOf("(");
        var end = funcText.indexOf(")");
        var propertiesList = funcText.substring(start + 1, end);
        propOb["computed"] = getterName + "(" + propertiesList + ")";
        target.properties[computedFuncName] = propOb;
        target[getterName] = target[computedFuncName];
    };
}
// @listen decorator
function listen(eventName) {
    return function (target, propertyKey) {
        target.listeners = target.listeners || {};
        target.listeners[eventName] = propertyKey;
    };
}
// @behavior decorator
function behavior(behaviorObject) {
    return function (target) {
        if (typeof (target) === "function") {
            // decorator applied externally, target is the class object
            target.prototype["behaviors"] = target.prototype["behaviors"] || [];
            var beObject = behaviorObject.prototype === undefined ? behaviorObject : behaviorObject.prototype;
            target.prototype["behaviors"].push(beObject);
        }
        else {
            // decorator applied internally, target is class.prototype
            target.behaviors = target.behaviors || [];
            var beObject = behaviorObject.prototype === undefined ? behaviorObject : behaviorObject.prototype;
            target.behaviors.push(beObject);
        }
    };
}
// @observe decorator
function observe(observedProps) {
    if (observedProps.indexOf(",") > 0 || observedProps.indexOf(".") > 0) {
        // observing multiple properties or path
        return function (target, observerFuncName) {
            target.observers = target.observers || [];
            target.observers.push(observerFuncName + "(" + observedProps + ")");
        };
    }
    else {
        // observing single property
        return function (target, observerName) {
            target.properties = target.properties || {};
            target.properties[observedProps] = target.properties[observedProps] || {};
            target.properties[observedProps].observer = observerName;
        };
    }
}
//# sourceMappingURL=polymer-ts.js.map</script>
<dom-module id="resize-aware" assetpath="../../bower_components/resize-aware/">

	<template>
		<style>
			:host {
				display: block;
				margin: 0px;
				padding: 0px;
				border: none;
				position: relative;
			}
			
			saw {
				display: inline-block;
				margin: 0px;
				padding: 0px;
				border: none;
				position: relative;
			}
			/* Resize Sensor Styles 
         Browsers supported by Polymer no longer require prefixes
      */
			
			@keyframes resizeanim {
				from {
					opacity: 0;
				}
				to {
					opacity: 0;
				}
			}
			
			.ResizeSensor__resizeTriggers {
				animation: 1ms resizeanim;
				visibility: hidden;
				opacity: 0;
			}
			
			.ResizeSensor__resizeTriggers,
			.ResizeSensor__resizeTriggers>div,
			.ResizeSensor__contractTrigger:before {
				content: ' ';
				display: block;
				position: absolute;
				top: 0;
				left: 0;
				height: 100%;
				width: 100%;
				overflow: hidden;
			}
			
			.ResizeSensor__resizeTriggers>div {
				background: #eee;
				overflow: auto;
			}
			
			.ResizeSensor__contractTrigger:before {
				width: 200%;
				height: 200%;
			}
		</style>
		<div id="saw">
			<slot></slot>
			<div id="rsrt" class="ResizeSensor ResizeSensor__resizeTriggers">
				<div id="rsexpt" class="ResizeSensor__expandTrigger">
					<div id="rsexptc" style="width: 1px; height: 1px;"></div>
				</div>
				<div id="rscntrt" class="ResizeSensor__contractTrigger">
				</div>
			</div>
		</div>
	</template>

	<script>
		Polymer({

			is: 'resize-aware',
			properties: {
				/**
				 * Current element size in px. { height: width: }
				 * @type {Object}
				 */
				elementSize: {
					type: Object,
					notify: true,
					readOnly: true,
					value: function () {
						return {
							width: 0,
							height: 0
						};
					}
				},
				_rsApi: {
					type: Object
				}
			},
			/**
			 * Initialize listening for size changes
			 */
			ready: function () {
				this._rsApi = this._resizeSensorApi(this._resizeSensor(this));
				this._rsApi.create(this.$.saw, [this.$.rsrt, this.$.rsexpt, this.$.rsexptc, this.$.rscntrt], this._handleResize.bind(
					this));
			},
			/**
			 * Handle resize events
			 * @param  {[type]} e [description]
			 * @return {[type]}   [description]
			 */
			_handleResize: function (e) {
				this.fire('element-resize', e);
				this._setElementSize({
					width: e.width,
					height: e.height
				});
			},
			/**
			 * The API for resize sensor
			 *
			 * Adapted from procurios/ResizeSensor - https://github.com/procurios/ResizeSensor
			 * in order to work in Polymer and Shadow DOM. This includes removing dynamic generation
			 * of CSS styles and the sensor divs and moving that into the template markup.
			 * @param  ResizeSensor ResizeSensor
			 * @return ResizeSensorApi              public API of ResizeSensor
			 */
			_resizeSensorApi: function (ResizeSensor) {
				'use strict';

				/** {{}} Map of all resize sensors (id => ResizeSensor) */
				var allResizeSensors = {};

				/**
				 * @constructor
				 */
				var ResizeSensorApi = function () {};

				/**
				 * @param {HTMLElement} targetElement
				 * @param {Function} callback
				 * @returns {ResizeSensor}
				 */
				ResizeSensorApi.prototype.create = function (targetElement, trigElements, callback) {
					var sensorId = this.getSensorId(targetElement);

					if (allResizeSensors[sensorId]) {
						return allResizeSensors[sensorId];
					}

					var Instance = new ResizeSensor(targetElement, trigElements, callback);
					allResizeSensors[sensorId] = Instance;
					return Instance;
				};

				/**
				 * @param {HTMLElement} targetElement
				 */
				ResizeSensorApi.prototype.destroy = function (targetElement) {
					var sensorId = this.getSensorId(targetElement);

					/** @var ResizeSensor */
					var Sensor = allResizeSensors[sensorId];

					if (!Sensor) {
						console && console.error("Can't destroy ResizeSensor (404 not found).", targetElement);
					}

					Sensor.destroy();
					delete allResizeSensors[sensorId];
				};

				/**
				 * @param {HTMLElement} targetElement
				 * @returns {string}
				 */
				ResizeSensorApi.prototype.getSensorId = function (targetElement) {
					return targetElement.id;
				};

				return new ResizeSensorApi();
			},

			/**
			 * Resize sensor core function
			 *
			 * Adapted with fairly minor changes from
			 * procurios/ResizeSensor - https://github.com/procurios/ResizeSensor
			 * in order to work in Polymer and Shadow DOM
			 *
			 * @param  HTMLElement rootNode the shadow root of this component
			 * @return ResizeSensor          core function class
			 */
			_resizeSensor: function (rootNode) {
				'use strict';

				/** ----- Feature tests and polyfills ----- */

				/** {array} */
				var unsuitableElements = ['IMG', 'COL', 'TR', 'THEAD', 'TFOOT'];
				/** {boolean} */
				var supportsAttachEvent = ('attachEvent' in document);

				if (!supportsAttachEvent) {
					var browserSupportsCSSAnimations = isCSSAnimationSupported();
					var animationPropertiesForBrowser = (browserSupportsCSSAnimations) ? getAnimationPropertiesForBrowser() : {};
					insertResizeSensorStyles();

					if (!('requestAnimationFrame' in window) || !('cancelAnimationFrame' in window)) {
						polyfillRAF();
					}
				}

				/** ----- ResizeSensor ----- */

				/**
				 * @param {HTMLElement} targetElement
				 * @param {Function} callback
				 * @constructor
				 */
				var ResizeSensor = function (targetElement, trigElements, callback) {
					if (isUnsuitableElement(targetElement)) {
						console && console.error(
							"Given element isn't suitable to act as a resize sensor. Try wrapping it with one that is. Unsuitable elements are:",
							unsuitableElements);
						return;
					}

					/** @var {HTMLElement} */
					this.targetElement = targetElement;
					/** @var {Function} */
					this.callback = callback;
					/** @var {{width: int, height: int}} */
					this.dimensions = {
						width: 0,
						height: 0
					};

					if (supportsAttachEvent) {
						this.boundOnResizeHandler = this.onElementResize.bind(this);
						this.targetElement.attachEvent('onresize', this.boundOnResizeHandler);
						return;
					}

					/** @var {{container: HTMLElement, expand: HTMLElement, expandChild: HTMLElement, contract: HTMLElement}} */
					/** trigger elements */
					this.triggerElements = {};
					this.triggerElements.container = trigElements[0];
					this.triggerElements.expand = trigElements[1];
					this.triggerElements.expandChild = trigElements[2];
					this.triggerElements.contract = trigElements[3];
					/** @var {int} */
					this.resizeRAF = 0;

					this.setup();
				};

				ResizeSensor.prototype.setup = function () {
					// Make sure the target element is "positioned"
					forcePositionedBox(this.targetElement);

					// Create and append resize trigger elements
					this.insertResizeTriggerElements();

					// Start listening to events
					this.boundScrollListener = this.handleElementScroll.bind(this);
					this.targetElement.addEventListener('scroll', this.boundScrollListener, true);

					if (browserSupportsCSSAnimations) {
						this.boundAnimationStartListener = this.resetTriggersOnAnimationStart.bind(this);
						this.triggerElements.container.addEventListener(animationPropertiesForBrowser.animationStartEvent, this.boundAnimationStartListener);
					}

					// Initial value reset of all triggers
					this.resetTriggers();
				};

				ResizeSensor.prototype.insertResizeTriggerElements = function () {
					
				};

				ResizeSensor.prototype.onElementResize = function () {
					var currentDimensions = this.getDimensions();

					if (this.isResized(currentDimensions)) {
						this.dimensions.width = currentDimensions.width;
						this.dimensions.height = currentDimensions.height;
						this.elementResized();
					}
				};

				ResizeSensor.prototype.handleElementScroll = function () {
					var _this = this;

					this.resetTriggers();

					if (this.resizeRAF) {
						window.cancelAnimationFrame(this.resizeRAF);
					}

					this.resizeRAF = window.requestAnimationFrame(function () {
						var currentDimensions = _this.getDimensions();
						if (_this.isResized(currentDimensions)) {
							_this.dimensions.width = currentDimensions.width;
							_this.dimensions.height = currentDimensions.height;
							_this.elementResized();
						}
					});
				};

				/**
				 * @param {{width: number, height: number}} currentDimensions
				 * @returns {boolean}
				 */
				ResizeSensor.prototype.isResized = function (currentDimensions) {
					return (currentDimensions.width !== this.dimensions.width || currentDimensions.height !== this.dimensions.height)
				};

				/**
				 * @returns {{width: number, height: number}}
				 */
				ResizeSensor.prototype.getDimensions = function () {
					return {
						width: this.targetElement.offsetWidth,
						height: this.targetElement.offsetHeight
					};
				};

				/**
				 * @param {Event} event
				 */
				ResizeSensor.prototype.resetTriggersOnAnimationStart = function (event) {
					if (event.animationName === animationPropertiesForBrowser.animationName) {
						this.resetTriggers();
					}
				};

				ResizeSensor.prototype.resetTriggers = function () {
					this.triggerElements.contract.scrollLeft = this.triggerElements.contract.scrollWidth;
					this.triggerElements.contract.scrollTop = this.triggerElements.contract.scrollHeight;
					this.triggerElements.expandChild.style.width = this.triggerElements.expand.offsetWidth + 1 + 'px';
					this.triggerElements.expandChild.style.height = this.triggerElements.expand.offsetHeight + 1 + 'px';
					this.triggerElements.expand.scrollLeft = this.triggerElements.expand.scrollWidth;
					this.triggerElements.expand.scrollTop = this.triggerElements.expand.scrollHeight;
				};

				ResizeSensor.prototype.elementResized = function () {
					this.callback(this.dimensions);
				};

				ResizeSensor.prototype.destroy = function () {
					this.removeEventListeners();
					this.targetElement.removeChild(this.triggerElements.container);
					delete this.boundAnimationStartListener;
					delete this.boundScrollListener;
					delete this.callback;
					delete this.targetElement;
				};

				ResizeSensor.prototype.removeEventListeners = function () {
					if (supportsAttachEvent) {
						this.targetElement.detachEvent('onresize', this.boundOnResizeHandler);
					}

					this.triggerElements.container.removeEventListener(animationPropertiesForBrowser.animationStartEvent, this.boundAnimationStartListener);
					this.targetElement.removeEventListener('scroll', this.boundScrollListener, true);
				};

				/** ----- Various helper functions ----- */

				/**
				 * An element is said to be positioned if its 'position' property has a value other than 'static'
				 * @see http://www.w3.org/TR/CSS2/visuren.html#propdef-position
				 * @param {HTMLElement} element
				 */
				function forcePositionedBox(element) {
					var position = getStyle(element, 'position');

					if (position === 'static') {
						element.style.position = 'relative';
					}
				}

				/**
				 * @returns {boolean}
				 */
				function isCSSAnimationSupported() {
					var testElement = document.createElement('div');
					var isAnimationSupported = ('animationName' in testElement.style);

					if (isAnimationSupported) {
						return true;
					}

					var browserPrefixes = 'Webkit Moz O ms'.split(' ');
					var i = 0;
					var l = browserPrefixes.length;

					for (; i < l; i++) {
						if ((browserPrefixes[i] + 'AnimationName') in testElement.style) {
							return true;
						}
					}

					return false;
				}

				/**
				 * @param {HTMLElement} targetElement
				 * @returns {boolean}
				 */
				function isUnsuitableElement(targetElement) {
					var tagName = targetElement.tagName.toUpperCase();
					return (unsuitableElements.indexOf(tagName) > -1);
				}

				/**
				 * Determines which style convention (properties) to follow
				 * @see https://developer.mozilla.org/en-US/docs/Web/Guide/CSS/Using_CSS_animations/Detecting_CSS_animation_support
				 * @returns {{keyframesRule: string, styleDeclaration: string, animationStartEvent: string, animationName: string}}
				 */
				function getAnimationPropertiesForBrowser() {
					var testElement = document.createElement('div');
					var supportsUnprefixedAnimationProperties = ('animationName' in testElement.style);

					// Unprefixed animation properties
					var animationStartEvent = 'animationstart';
					var animationName = 'resizeanim';

					if (supportsUnprefixedAnimationProperties) {
						return {
							keyframesRule: '@keyframes ' + animationName + ' {from { opacity: 0; } to { opacity: 0; }}',
							styleDeclaration: 'animation: 1ms ' + animationName + ';',
							animationStartEvent: animationStartEvent,
							animationName: animationName
						};
					}

					// Browser specific animation properties
					var keyframePrefix = '';
					var browserPrefixes = 'Webkit Moz O ms'.split(' ');
					var startEvents = 'webkitAnimationStart animationstart oAnimationStart MSAnimationStart'.split(' ');

					var i;
					var l = browserPrefixes.length;

					for (i = 0; i < l; i++) {
						if ((browserPrefixes[i] + 'AnimationName') in testElement.style) {
							keyframePrefix = '-' + browserPrefixes[i].toLowerCase() + '-';
							animationStartEvent = startEvents[i];
							break;
						}
					}

					return {
						keyframesRule: '@' + keyframePrefix + 'keyframes ' + animationName +
							' {from { opacity: 0; } to { opacity: 0; }}',
						styleDeclaration: keyframePrefix + 'animation: 1ms ' + animationName + ';',
						animationStartEvent: animationStartEvent,
						animationName: animationName
					};
				}

				/**
				 * Provides requestAnimationFrame in a cross browser way
				 * @see https://gist.github.com/mrdoob/838785
				 */
				function polyfillRAF() {
					if (!window.requestAnimationFrame) {
						window.requestAnimationFrame = (function () {
							return window.webkitRequestAnimationFrame ||
								window.mozRequestAnimationFrame ||
								window.oRequestAnimationFrame ||
								window.msRequestAnimationFrame ||
								function (callback) {
									window.setTimeout(callback, 1000 / 60);
								};
						})();
					}

					if (!window.cancelAnimationFrame) {
						window.cancelAnimationFrame = (function () {
							return window.webkitCancelAnimationFrame ||
								window.mozCancelAnimationFrame ||
								window.oCancelAnimationFrame ||
								window.msCancelAnimationFrame ||
								window.clearTimeout;
						})();
					}
				}

				/**
				 * Adds a style block that contains CSS essential for detecting resize events
				 */
				function insertResizeSensorStyles() {
					
				}

				/**
				 *
				 * @param {HTMLElement} element
				 * @param {string} property
				 * @returns {null|string}
				 */
				function getStyle(element, property) {
					var value = null;

					if (element.currentStyle) {
						value = element.currentStyle[property];
					} else if (window.getComputedStyle) {
						value = document.defaultView.getComputedStyle(element, null).getPropertyValue(property);
					}

					return value;
				}

				return ResizeSensor;
			}

		});
	</script>
</dom-module><iron-iconset-svg size="24" name="papmapinf">
<svg><defs>
<g id="close"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></g>
</defs></svg>
</iron-iconset-svg>
<!--
@license
Copyright (c) 2016 Murray Lisook. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
--><script>//     Underscore.js 1.8.3
//     http://underscorejs.org
//     (c) 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

(function() {

  // Baseline setup
  // --------------

  // Establish the root object, `window` in the browser, or `exports` on the server.
  var root = this;

  // Save the previous value of the `_` variable.
  var previousUnderscore = root._;

  // Save bytes in the minified (but not gzipped) version:
  var ArrayProto = Array.prototype, ObjProto = Object.prototype, FuncProto = Function.prototype;

  // Create quick reference variables for speed access to core prototypes.
  var
    push             = ArrayProto.push,
    slice            = ArrayProto.slice,
    toString         = ObjProto.toString,
    hasOwnProperty   = ObjProto.hasOwnProperty;

  // All **ECMAScript 5** native function implementations that we hope to use
  // are declared here.
  var
    nativeIsArray      = Array.isArray,
    nativeKeys         = Object.keys,
    nativeBind         = FuncProto.bind,
    nativeCreate       = Object.create;

  // Naked function reference for surrogate-prototype-swapping.
  var Ctor = function(){};

  // Create a safe reference to the Underscore object for use below.
  var _ = function(obj) {
    if (obj instanceof _) return obj;
    if (!(this instanceof _)) return new _(obj);
    this._wrapped = obj;
  };

  // Export the Underscore object for **Node.js**, with
  // backwards-compatibility for the old `require()` API. If we're in
  // the browser, add `_` as a global object.
  if (typeof exports !== 'undefined') {
    if (typeof module !== 'undefined' && module.exports) {
      exports = module.exports = _;
    }
    exports._ = _;
  } else {
    root._ = _;
  }

  // Current version.
  _.VERSION = '1.8.3';

  // Internal function that returns an efficient (for current engines) version
  // of the passed-in callback, to be repeatedly applied in other Underscore
  // functions.
  var optimizeCb = function(func, context, argCount) {
    if (context === void 0) return func;
    switch (argCount == null ? 3 : argCount) {
      case 1: return function(value) {
        return func.call(context, value);
      };
      case 2: return function(value, other) {
        return func.call(context, value, other);
      };
      case 3: return function(value, index, collection) {
        return func.call(context, value, index, collection);
      };
      case 4: return function(accumulator, value, index, collection) {
        return func.call(context, accumulator, value, index, collection);
      };
    }
    return function() {
      return func.apply(context, arguments);
    };
  };

  // A mostly-internal function to generate callbacks that can be applied
  // to each element in a collection, returning the desired result â either
  // identity, an arbitrary callback, a property matcher, or a property accessor.
  var cb = function(value, context, argCount) {
    if (value == null) return _.identity;
    if (_.isFunction(value)) return optimizeCb(value, context, argCount);
    if (_.isObject(value)) return _.matcher(value);
    return _.property(value);
  };
  _.iteratee = function(value, context) {
    return cb(value, context, Infinity);
  };

  // An internal function for creating assigner functions.
  var createAssigner = function(keysFunc, undefinedOnly) {
    return function(obj) {
      var length = arguments.length;
      if (length < 2 || obj == null) return obj;
      for (var index = 1; index < length; index++) {
        var source = arguments[index],
            keys = keysFunc(source),
            l = keys.length;
        for (var i = 0; i < l; i++) {
          var key = keys[i];
          if (!undefinedOnly || obj[key] === void 0) obj[key] = source[key];
        }
      }
      return obj;
    };
  };

  // An internal function for creating a new object that inherits from another.
  var baseCreate = function(prototype) {
    if (!_.isObject(prototype)) return {};
    if (nativeCreate) return nativeCreate(prototype);
    Ctor.prototype = prototype;
    var result = new Ctor;
    Ctor.prototype = null;
    return result;
  };

  var property = function(key) {
    return function(obj) {
      return obj == null ? void 0 : obj[key];
    };
  };

  // Helper for collection methods to determine whether a collection
  // should be iterated as an array or as an object
  // Related: http://people.mozilla.org/~jorendorff/es6-draft.html#sec-tolength
  // Avoids a very nasty iOS 8 JIT bug on ARM-64. #2094
  var MAX_ARRAY_INDEX = Math.pow(2, 53) - 1;
  var getLength = property('length');
  var isArrayLike = function(collection) {
    var length = getLength(collection);
    return typeof length == 'number' && length >= 0 && length <= MAX_ARRAY_INDEX;
  };

  // Collection Functions
  // --------------------

  // The cornerstone, an `each` implementation, aka `forEach`.
  // Handles raw objects in addition to array-likes. Treats all
  // sparse array-likes as if they were dense.
  _.each = _.forEach = function(obj, iteratee, context) {
    iteratee = optimizeCb(iteratee, context);
    var i, length;
    if (isArrayLike(obj)) {
      for (i = 0, length = obj.length; i < length; i++) {
        iteratee(obj[i], i, obj);
      }
    } else {
      var keys = _.keys(obj);
      for (i = 0, length = keys.length; i < length; i++) {
        iteratee(obj[keys[i]], keys[i], obj);
      }
    }
    return obj;
  };

  // Return the results of applying the iteratee to each element.
  _.map = _.collect = function(obj, iteratee, context) {
    iteratee = cb(iteratee, context);
    var keys = !isArrayLike(obj) && _.keys(obj),
        length = (keys || obj).length,
        results = Array(length);
    for (var index = 0; index < length; index++) {
      var currentKey = keys ? keys[index] : index;
      results[index] = iteratee(obj[currentKey], currentKey, obj);
    }
    return results;
  };

  // Create a reducing function iterating left or right.
  function createReduce(dir) {
    // Optimized iterator function as using arguments.length
    // in the main function will deoptimize the, see #1991.
    function iterator(obj, iteratee, memo, keys, index, length) {
      for (; index >= 0 && index < length; index += dir) {
        var currentKey = keys ? keys[index] : index;
        memo = iteratee(memo, obj[currentKey], currentKey, obj);
      }
      return memo;
    }

    return function(obj, iteratee, memo, context) {
      iteratee = optimizeCb(iteratee, context, 4);
      var keys = !isArrayLike(obj) && _.keys(obj),
          length = (keys || obj).length,
          index = dir > 0 ? 0 : length - 1;
      // Determine the initial value if none is provided.
      if (arguments.length < 3) {
        memo = obj[keys ? keys[index] : index];
        index += dir;
      }
      return iterator(obj, iteratee, memo, keys, index, length);
    };
  }

  // **Reduce** builds up a single result from a list of values, aka `inject`,
  // or `foldl`.
  _.reduce = _.foldl = _.inject = createReduce(1);

  // The right-associative version of reduce, also known as `foldr`.
  _.reduceRight = _.foldr = createReduce(-1);

  // Return the first value which passes a truth test. Aliased as `detect`.
  _.find = _.detect = function(obj, predicate, context) {
    var key;
    if (isArrayLike(obj)) {
      key = _.findIndex(obj, predicate, context);
    } else {
      key = _.findKey(obj, predicate, context);
    }
    if (key !== void 0 && key !== -1) return obj[key];
  };

  // Return all the elements that pass a truth test.
  // Aliased as `select`.
  _.filter = _.select = function(obj, predicate, context) {
    var results = [];
    predicate = cb(predicate, context);
    _.each(obj, function(value, index, list) {
      if (predicate(value, index, list)) results.push(value);
    });
    return results;
  };

  // Return all the elements for which a truth test fails.
  _.reject = function(obj, predicate, context) {
    return _.filter(obj, _.negate(cb(predicate)), context);
  };

  // Determine whether all of the elements match a truth test.
  // Aliased as `all`.
  _.every = _.all = function(obj, predicate, context) {
    predicate = cb(predicate, context);
    var keys = !isArrayLike(obj) && _.keys(obj),
        length = (keys || obj).length;
    for (var index = 0; index < length; index++) {
      var currentKey = keys ? keys[index] : index;
      if (!predicate(obj[currentKey], currentKey, obj)) return false;
    }
    return true;
  };

  // Determine if at least one element in the object matches a truth test.
  // Aliased as `any`.
  _.some = _.any = function(obj, predicate, context) {
    predicate = cb(predicate, context);
    var keys = !isArrayLike(obj) && _.keys(obj),
        length = (keys || obj).length;
    for (var index = 0; index < length; index++) {
      var currentKey = keys ? keys[index] : index;
      if (predicate(obj[currentKey], currentKey, obj)) return true;
    }
    return false;
  };

  // Determine if the array or object contains a given item (using `===`).
  // Aliased as `includes` and `include`.
  _.contains = _.includes = _.include = function(obj, item, fromIndex, guard) {
    if (!isArrayLike(obj)) obj = _.values(obj);
    if (typeof fromIndex != 'number' || guard) fromIndex = 0;
    return _.indexOf(obj, item, fromIndex) >= 0;
  };

  // Invoke a method (with arguments) on every item in a collection.
  _.invoke = function(obj, method) {
    var args = slice.call(arguments, 2);
    var isFunc = _.isFunction(method);
    return _.map(obj, function(value) {
      var func = isFunc ? method : value[method];
      return func == null ? func : func.apply(value, args);
    });
  };

  // Convenience version of a common use case of `map`: fetching a property.
  _.pluck = function(obj, key) {
    return _.map(obj, _.property(key));
  };

  // Convenience version of a common use case of `filter`: selecting only objects
  // containing specific `key:value` pairs.
  _.where = function(obj, attrs) {
    return _.filter(obj, _.matcher(attrs));
  };

  // Convenience version of a common use case of `find`: getting the first object
  // containing specific `key:value` pairs.
  _.findWhere = function(obj, attrs) {
    return _.find(obj, _.matcher(attrs));
  };

  // Return the maximum element (or element-based computation).
  _.max = function(obj, iteratee, context) {
    var result = -Infinity, lastComputed = -Infinity,
        value, computed;
    if (iteratee == null && obj != null) {
      obj = isArrayLike(obj) ? obj : _.values(obj);
      for (var i = 0, length = obj.length; i < length; i++) {
        value = obj[i];
        if (value > result) {
          result = value;
        }
      }
    } else {
      iteratee = cb(iteratee, context);
      _.each(obj, function(value, index, list) {
        computed = iteratee(value, index, list);
        if (computed > lastComputed || computed === -Infinity && result === -Infinity) {
          result = value;
          lastComputed = computed;
        }
      });
    }
    return result;
  };

  // Return the minimum element (or element-based computation).
  _.min = function(obj, iteratee, context) {
    var result = Infinity, lastComputed = Infinity,
        value, computed;
    if (iteratee == null && obj != null) {
      obj = isArrayLike(obj) ? obj : _.values(obj);
      for (var i = 0, length = obj.length; i < length; i++) {
        value = obj[i];
        if (value < result) {
          result = value;
        }
      }
    } else {
      iteratee = cb(iteratee, context);
      _.each(obj, function(value, index, list) {
        computed = iteratee(value, index, list);
        if (computed < lastComputed || computed === Infinity && result === Infinity) {
          result = value;
          lastComputed = computed;
        }
      });
    }
    return result;
  };

  // Shuffle a collection, using the modern version of the
  // [Fisher-Yates shuffle](http://en.wikipedia.org/wiki/FisherâYates_shuffle).
  _.shuffle = function(obj) {
    var set = isArrayLike(obj) ? obj : _.values(obj);
    var length = set.length;
    var shuffled = Array(length);
    for (var index = 0, rand; index < length; index++) {
      rand = _.random(0, index);
      if (rand !== index) shuffled[index] = shuffled[rand];
      shuffled[rand] = set[index];
    }
    return shuffled;
  };

  // Sample **n** random values from a collection.
  // If **n** is not specified, returns a single random element.
  // The internal `guard` argument allows it to work with `map`.
  _.sample = function(obj, n, guard) {
    if (n == null || guard) {
      if (!isArrayLike(obj)) obj = _.values(obj);
      return obj[_.random(obj.length - 1)];
    }
    return _.shuffle(obj).slice(0, Math.max(0, n));
  };

  // Sort the object's values by a criterion produced by an iteratee.
  _.sortBy = function(obj, iteratee, context) {
    iteratee = cb(iteratee, context);
    return _.pluck(_.map(obj, function(value, index, list) {
      return {
        value: value,
        index: index,
        criteria: iteratee(value, index, list)
      };
    }).sort(function(left, right) {
      var a = left.criteria;
      var b = right.criteria;
      if (a !== b) {
        if (a > b || a === void 0) return 1;
        if (a < b || b === void 0) return -1;
      }
      return left.index - right.index;
    }), 'value');
  };

  // An internal function used for aggregate "group by" operations.
  var group = function(behavior) {
    return function(obj, iteratee, context) {
      var result = {};
      iteratee = cb(iteratee, context);
      _.each(obj, function(value, index) {
        var key = iteratee(value, index, obj);
        behavior(result, value, key);
      });
      return result;
    };
  };

  // Groups the object's values by a criterion. Pass either a string attribute
  // to group by, or a function that returns the criterion.
  _.groupBy = group(function(result, value, key) {
    if (_.has(result, key)) result[key].push(value); else result[key] = [value];
  });

  // Indexes the object's values by a criterion, similar to `groupBy`, but for
  // when you know that your index values will be unique.
  _.indexBy = group(function(result, value, key) {
    result[key] = value;
  });

  // Counts instances of an object that group by a certain criterion. Pass
  // either a string attribute to count by, or a function that returns the
  // criterion.
  _.countBy = group(function(result, value, key) {
    if (_.has(result, key)) result[key]++; else result[key] = 1;
  });

  // Safely create a real, live array from anything iterable.
  _.toArray = function(obj) {
    if (!obj) return [];
    if (_.isArray(obj)) return slice.call(obj);
    if (isArrayLike(obj)) return _.map(obj, _.identity);
    return _.values(obj);
  };

  // Return the number of elements in an object.
  _.size = function(obj) {
    if (obj == null) return 0;
    return isArrayLike(obj) ? obj.length : _.keys(obj).length;
  };

  // Split a collection into two arrays: one whose elements all satisfy the given
  // predicate, and one whose elements all do not satisfy the predicate.
  _.partition = function(obj, predicate, context) {
    predicate = cb(predicate, context);
    var pass = [], fail = [];
    _.each(obj, function(value, key, obj) {
      (predicate(value, key, obj) ? pass : fail).push(value);
    });
    return [pass, fail];
  };

  // Array Functions
  // ---------------

  // Get the first element of an array. Passing **n** will return the first N
  // values in the array. Aliased as `head` and `take`. The **guard** check
  // allows it to work with `_.map`.
  _.first = _.head = _.take = function(array, n, guard) {
    if (array == null) return void 0;
    if (n == null || guard) return array[0];
    return _.initial(array, array.length - n);
  };

  // Returns everything but the last entry of the array. Especially useful on
  // the arguments object. Passing **n** will return all the values in
  // the array, excluding the last N.
  _.initial = function(array, n, guard) {
    return slice.call(array, 0, Math.max(0, array.length - (n == null || guard ? 1 : n)));
  };

  // Get the last element of an array. Passing **n** will return the last N
  // values in the array.
  _.last = function(array, n, guard) {
    if (array == null) return void 0;
    if (n == null || guard) return array[array.length - 1];
    return _.rest(array, Math.max(0, array.length - n));
  };

  // Returns everything but the first entry of the array. Aliased as `tail` and `drop`.
  // Especially useful on the arguments object. Passing an **n** will return
  // the rest N values in the array.
  _.rest = _.tail = _.drop = function(array, n, guard) {
    return slice.call(array, n == null || guard ? 1 : n);
  };

  // Trim out all falsy values from an array.
  _.compact = function(array) {
    return _.filter(array, _.identity);
  };

  // Internal implementation of a recursive `flatten` function.
  var flatten = function(input, shallow, strict, startIndex) {
    var output = [], idx = 0;
    for (var i = startIndex || 0, length = getLength(input); i < length; i++) {
      var value = input[i];
      if (isArrayLike(value) && (_.isArray(value) || _.isArguments(value))) {
        //flatten current level of array or arguments object
        if (!shallow) value = flatten(value, shallow, strict);
        var j = 0, len = value.length;
        output.length += len;
        while (j < len) {
          output[idx++] = value[j++];
        }
      } else if (!strict) {
        output[idx++] = value;
      }
    }
    return output;
  };

  // Flatten out an array, either recursively (by default), or just one level.
  _.flatten = function(array, shallow) {
    return flatten(array, shallow, false);
  };

  // Return a version of the array that does not contain the specified value(s).
  _.without = function(array) {
    return _.difference(array, slice.call(arguments, 1));
  };

  // Produce a duplicate-free version of the array. If the array has already
  // been sorted, you have the option of using a faster algorithm.
  // Aliased as `unique`.
  _.uniq = _.unique = function(array, isSorted, iteratee, context) {
    if (!_.isBoolean(isSorted)) {
      context = iteratee;
      iteratee = isSorted;
      isSorted = false;
    }
    if (iteratee != null) iteratee = cb(iteratee, context);
    var result = [];
    var seen = [];
    for (var i = 0, length = getLength(array); i < length; i++) {
      var value = array[i],
          computed = iteratee ? iteratee(value, i, array) : value;
      if (isSorted) {
        if (!i || seen !== computed) result.push(value);
        seen = computed;
      } else if (iteratee) {
        if (!_.contains(seen, computed)) {
          seen.push(computed);
          result.push(value);
        }
      } else if (!_.contains(result, value)) {
        result.push(value);
      }
    }
    return result;
  };

  // Produce an array that contains the union: each distinct element from all of
  // the passed-in arrays.
  _.union = function() {
    return _.uniq(flatten(arguments, true, true));
  };

  // Produce an array that contains every item shared between all the
  // passed-in arrays.
  _.intersection = function(array) {
    var result = [];
    var argsLength = arguments.length;
    for (var i = 0, length = getLength(array); i < length; i++) {
      var item = array[i];
      if (_.contains(result, item)) continue;
      for (var j = 1; j < argsLength; j++) {
        if (!_.contains(arguments[j], item)) break;
      }
      if (j === argsLength) result.push(item);
    }
    return result;
  };

  // Take the difference between one array and a number of other arrays.
  // Only the elements present in just the first array will remain.
  _.difference = function(array) {
    var rest = flatten(arguments, true, true, 1);
    return _.filter(array, function(value){
      return !_.contains(rest, value);
    });
  };

  // Zip together multiple lists into a single array -- elements that share
  // an index go together.
  _.zip = function() {
    return _.unzip(arguments);
  };

  // Complement of _.zip. Unzip accepts an array of arrays and groups
  // each array's elements on shared indices
  _.unzip = function(array) {
    var length = array && _.max(array, getLength).length || 0;
    var result = Array(length);

    for (var index = 0; index < length; index++) {
      result[index] = _.pluck(array, index);
    }
    return result;
  };

  // Converts lists into objects. Pass either a single array of `[key, value]`
  // pairs, or two parallel arrays of the same length -- one of keys, and one of
  // the corresponding values.
  _.object = function(list, values) {
    var result = {};
    for (var i = 0, length = getLength(list); i < length; i++) {
      if (values) {
        result[list[i]] = values[i];
      } else {
        result[list[i][0]] = list[i][1];
      }
    }
    return result;
  };

  // Generator function to create the findIndex and findLastIndex functions
  function createPredicateIndexFinder(dir) {
    return function(array, predicate, context) {
      predicate = cb(predicate, context);
      var length = getLength(array);
      var index = dir > 0 ? 0 : length - 1;
      for (; index >= 0 && index < length; index += dir) {
        if (predicate(array[index], index, array)) return index;
      }
      return -1;
    };
  }

  // Returns the first index on an array-like that passes a predicate test
  _.findIndex = createPredicateIndexFinder(1);
  _.findLastIndex = createPredicateIndexFinder(-1);

  // Use a comparator function to figure out the smallest index at which
  // an object should be inserted so as to maintain order. Uses binary search.
  _.sortedIndex = function(array, obj, iteratee, context) {
    iteratee = cb(iteratee, context, 1);
    var value = iteratee(obj);
    var low = 0, high = getLength(array);
    while (low < high) {
      var mid = Math.floor((low + high) / 2);
      if (iteratee(array[mid]) < value) low = mid + 1; else high = mid;
    }
    return low;
  };

  // Generator function to create the indexOf and lastIndexOf functions
  function createIndexFinder(dir, predicateFind, sortedIndex) {
    return function(array, item, idx) {
      var i = 0, length = getLength(array);
      if (typeof idx == 'number') {
        if (dir > 0) {
            i = idx >= 0 ? idx : Math.max(idx + length, i);
        } else {
            length = idx >= 0 ? Math.min(idx + 1, length) : idx + length + 1;
        }
      } else if (sortedIndex && idx && length) {
        idx = sortedIndex(array, item);
        return array[idx] === item ? idx : -1;
      }
      if (item !== item) {
        idx = predicateFind(slice.call(array, i, length), _.isNaN);
        return idx >= 0 ? idx + i : -1;
      }
      for (idx = dir > 0 ? i : length - 1; idx >= 0 && idx < length; idx += dir) {
        if (array[idx] === item) return idx;
      }
      return -1;
    };
  }

  // Return the position of the first occurrence of an item in an array,
  // or -1 if the item is not included in the array.
  // If the array is large and already in sort order, pass `true`
  // for **isSorted** to use binary search.
  _.indexOf = createIndexFinder(1, _.findIndex, _.sortedIndex);
  _.lastIndexOf = createIndexFinder(-1, _.findLastIndex);

  // Generate an integer Array containing an arithmetic progression. A port of
  // the native Python `range()` function. See
  // [the Python documentation](http://docs.python.org/library/functions.html#range).
  _.range = function(start, stop, step) {
    if (stop == null) {
      stop = start || 0;
      start = 0;
    }
    step = step || 1;

    var length = Math.max(Math.ceil((stop - start) / step), 0);
    var range = Array(length);

    for (var idx = 0; idx < length; idx++, start += step) {
      range[idx] = start;
    }

    return range;
  };

  // Function (ahem) Functions
  // ------------------

  // Determines whether to execute a function as a constructor
  // or a normal function with the provided arguments
  var executeBound = function(sourceFunc, boundFunc, context, callingContext, args) {
    if (!(callingContext instanceof boundFunc)) return sourceFunc.apply(context, args);
    var self = baseCreate(sourceFunc.prototype);
    var result = sourceFunc.apply(self, args);
    if (_.isObject(result)) return result;
    return self;
  };

  // Create a function bound to a given object (assigning `this`, and arguments,
  // optionally). Delegates to **ECMAScript 5**'s native `Function.bind` if
  // available.
  _.bind = function(func, context) {
    if (nativeBind && func.bind === nativeBind) return nativeBind.apply(func, slice.call(arguments, 1));
    if (!_.isFunction(func)) throw new TypeError('Bind must be called on a function');
    var args = slice.call(arguments, 2);
    var bound = function() {
      return executeBound(func, bound, context, this, args.concat(slice.call(arguments)));
    };
    return bound;
  };

  // Partially apply a function by creating a version that has had some of its
  // arguments pre-filled, without changing its dynamic `this` context. _ acts
  // as a placeholder, allowing any combination of arguments to be pre-filled.
  _.partial = function(func) {
    var boundArgs = slice.call(arguments, 1);
    var bound = function() {
      var position = 0, length = boundArgs.length;
      var args = Array(length);
      for (var i = 0; i < length; i++) {
        args[i] = boundArgs[i] === _ ? arguments[position++] : boundArgs[i];
      }
      while (position < arguments.length) args.push(arguments[position++]);
      return executeBound(func, bound, this, this, args);
    };
    return bound;
  };

  // Bind a number of an object's methods to that object. Remaining arguments
  // are the method names to be bound. Useful for ensuring that all callbacks
  // defined on an object belong to it.
  _.bindAll = function(obj) {
    var i, length = arguments.length, key;
    if (length <= 1) throw new Error('bindAll must be passed function names');
    for (i = 1; i < length; i++) {
      key = arguments[i];
      obj[key] = _.bind(obj[key], obj);
    }
    return obj;
  };

  // Memoize an expensive function by storing its results.
  _.memoize = function(func, hasher) {
    var memoize = function(key) {
      var cache = memoize.cache;
      var address = '' + (hasher ? hasher.apply(this, arguments) : key);
      if (!_.has(cache, address)) cache[address] = func.apply(this, arguments);
      return cache[address];
    };
    memoize.cache = {};
    return memoize;
  };

  // Delays a function for the given number of milliseconds, and then calls
  // it with the arguments supplied.
  _.delay = function(func, wait) {
    var args = slice.call(arguments, 2);
    return setTimeout(function(){
      return func.apply(null, args);
    }, wait);
  };

  // Defers a function, scheduling it to run after the current call stack has
  // cleared.
  _.defer = _.partial(_.delay, _, 1);

  // Returns a function, that, when invoked, will only be triggered at most once
  // during a given window of time. Normally, the throttled function will run
  // as much as it can, without ever going more than once per `wait` duration;
  // but if you'd like to disable the execution on the leading edge, pass
  // `{leading: false}`. To disable execution on the trailing edge, ditto.
  _.throttle = function(func, wait, options) {
    var context, args, result;
    var timeout = null;
    var previous = 0;
    if (!options) options = {};
    var later = function() {
      previous = options.leading === false ? 0 : _.now();
      timeout = null;
      result = func.apply(context, args);
      if (!timeout) context = args = null;
    };
    return function() {
      var now = _.now();
      if (!previous && options.leading === false) previous = now;
      var remaining = wait - (now - previous);
      context = this;
      args = arguments;
      if (remaining <= 0 || remaining > wait) {
        if (timeout) {
          clearTimeout(timeout);
          timeout = null;
        }
        previous = now;
        result = func.apply(context, args);
        if (!timeout) context = args = null;
      } else if (!timeout && options.trailing !== false) {
        timeout = setTimeout(later, remaining);
      }
      return result;
    };
  };

  // Returns a function, that, as long as it continues to be invoked, will not
  // be triggered. The function will be called after it stops being called for
  // N milliseconds. If `immediate` is passed, trigger the function on the
  // leading edge, instead of the trailing.
  _.debounce = function(func, wait, immediate) {
    var timeout, args, context, timestamp, result;

    var later = function() {
      var last = _.now() - timestamp;

      if (last < wait && last >= 0) {
        timeout = setTimeout(later, wait - last);
      } else {
        timeout = null;
        if (!immediate) {
          result = func.apply(context, args);
          if (!timeout) context = args = null;
        }
      }
    };

    return function() {
      context = this;
      args = arguments;
      timestamp = _.now();
      var callNow = immediate && !timeout;
      if (!timeout) timeout = setTimeout(later, wait);
      if (callNow) {
        result = func.apply(context, args);
        context = args = null;
      }

      return result;
    };
  };

  // Returns the first function passed as an argument to the second,
  // allowing you to adjust arguments, run code before and after, and
  // conditionally execute the original function.
  _.wrap = function(func, wrapper) {
    return _.partial(wrapper, func);
  };

  // Returns a negated version of the passed-in predicate.
  _.negate = function(predicate) {
    return function() {
      return !predicate.apply(this, arguments);
    };
  };

  // Returns a function that is the composition of a list of functions, each
  // consuming the return value of the function that follows.
  _.compose = function() {
    var args = arguments;
    var start = args.length - 1;
    return function() {
      var i = start;
      var result = args[start].apply(this, arguments);
      while (i--) result = args[i].call(this, result);
      return result;
    };
  };

  // Returns a function that will only be executed on and after the Nth call.
  _.after = function(times, func) {
    return function() {
      if (--times < 1) {
        return func.apply(this, arguments);
      }
    };
  };

  // Returns a function that will only be executed up to (but not including) the Nth call.
  _.before = function(times, func) {
    var memo;
    return function() {
      if (--times > 0) {
        memo = func.apply(this, arguments);
      }
      if (times <= 1) func = null;
      return memo;
    };
  };

  // Returns a function that will be executed at most one time, no matter how
  // often you call it. Useful for lazy initialization.
  _.once = _.partial(_.before, 2);

  // Object Functions
  // ----------------

  // Keys in IE < 9 that won't be iterated by `for key in ...` and thus missed.
  var hasEnumBug = !{toString: null}.propertyIsEnumerable('toString');
  var nonEnumerableProps = ['valueOf', 'isPrototypeOf', 'toString',
                      'propertyIsEnumerable', 'hasOwnProperty', 'toLocaleString'];

  function collectNonEnumProps(obj, keys) {
    var nonEnumIdx = nonEnumerableProps.length;
    var constructor = obj.constructor;
    var proto = (_.isFunction(constructor) && constructor.prototype) || ObjProto;

    // Constructor is a special case.
    var prop = 'constructor';
    if (_.has(obj, prop) && !_.contains(keys, prop)) keys.push(prop);

    while (nonEnumIdx--) {
      prop = nonEnumerableProps[nonEnumIdx];
      if (prop in obj && obj[prop] !== proto[prop] && !_.contains(keys, prop)) {
        keys.push(prop);
      }
    }
  }

  // Retrieve the names of an object's own properties.
  // Delegates to **ECMAScript 5**'s native `Object.keys`
  _.keys = function(obj) {
    if (!_.isObject(obj)) return [];
    if (nativeKeys) return nativeKeys(obj);
    var keys = [];
    for (var key in obj) if (_.has(obj, key)) keys.push(key);
    // Ahem, IE < 9.
    if (hasEnumBug) collectNonEnumProps(obj, keys);
    return keys;
  };

  // Retrieve all the property names of an object.
  _.allKeys = function(obj) {
    if (!_.isObject(obj)) return [];
    var keys = [];
    for (var key in obj) keys.push(key);
    // Ahem, IE < 9.
    if (hasEnumBug) collectNonEnumProps(obj, keys);
    return keys;
  };

  // Retrieve the values of an object's properties.
  _.values = function(obj) {
    var keys = _.keys(obj);
    var length = keys.length;
    var values = Array(length);
    for (var i = 0; i < length; i++) {
      values[i] = obj[keys[i]];
    }
    return values;
  };

  // Returns the results of applying the iteratee to each element of the object
  // In contrast to _.map it returns an object
  _.mapObject = function(obj, iteratee, context) {
    iteratee = cb(iteratee, context);
    var keys =  _.keys(obj),
          length = keys.length,
          results = {},
          currentKey;
      for (var index = 0; index < length; index++) {
        currentKey = keys[index];
        results[currentKey] = iteratee(obj[currentKey], currentKey, obj);
      }
      return results;
  };

  // Convert an object into a list of `[key, value]` pairs.
  _.pairs = function(obj) {
    var keys = _.keys(obj);
    var length = keys.length;
    var pairs = Array(length);
    for (var i = 0; i < length; i++) {
      pairs[i] = [keys[i], obj[keys[i]]];
    }
    return pairs;
  };

  // Invert the keys and values of an object. The values must be serializable.
  _.invert = function(obj) {
    var result = {};
    var keys = _.keys(obj);
    for (var i = 0, length = keys.length; i < length; i++) {
      result[obj[keys[i]]] = keys[i];
    }
    return result;
  };

  // Return a sorted list of the function names available on the object.
  // Aliased as `methods`
  _.functions = _.methods = function(obj) {
    var names = [];
    for (var key in obj) {
      if (_.isFunction(obj[key])) names.push(key);
    }
    return names.sort();
  };

  // Extend a given object with all the properties in passed-in object(s).
  _.extend = createAssigner(_.allKeys);

  // Assigns a given object with all the own properties in the passed-in object(s)
  // (https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/assign)
  _.extendOwn = _.assign = createAssigner(_.keys);

  // Returns the first key on an object that passes a predicate test
  _.findKey = function(obj, predicate, context) {
    predicate = cb(predicate, context);
    var keys = _.keys(obj), key;
    for (var i = 0, length = keys.length; i < length; i++) {
      key = keys[i];
      if (predicate(obj[key], key, obj)) return key;
    }
  };

  // Return a copy of the object only containing the whitelisted properties.
  _.pick = function(object, oiteratee, context) {
    var result = {}, obj = object, iteratee, keys;
    if (obj == null) return result;
    if (_.isFunction(oiteratee)) {
      keys = _.allKeys(obj);
      iteratee = optimizeCb(oiteratee, context);
    } else {
      keys = flatten(arguments, false, false, 1);
      iteratee = function(value, key, obj) { return key in obj; };
      obj = Object(obj);
    }
    for (var i = 0, length = keys.length; i < length; i++) {
      var key = keys[i];
      var value = obj[key];
      if (iteratee(value, key, obj)) result[key] = value;
    }
    return result;
  };

   // Return a copy of the object without the blacklisted properties.
  _.omit = function(obj, iteratee, context) {
    if (_.isFunction(iteratee)) {
      iteratee = _.negate(iteratee);
    } else {
      var keys = _.map(flatten(arguments, false, false, 1), String);
      iteratee = function(value, key) {
        return !_.contains(keys, key);
      };
    }
    return _.pick(obj, iteratee, context);
  };

  // Fill in a given object with default properties.
  _.defaults = createAssigner(_.allKeys, true);

  // Creates an object that inherits from the given prototype object.
  // If additional properties are provided then they will be added to the
  // created object.
  _.create = function(prototype, props) {
    var result = baseCreate(prototype);
    if (props) _.extendOwn(result, props);
    return result;
  };

  // Create a (shallow-cloned) duplicate of an object.
  _.clone = function(obj) {
    if (!_.isObject(obj)) return obj;
    return _.isArray(obj) ? obj.slice() : _.extend({}, obj);
  };

  // Invokes interceptor with the obj, and then returns obj.
  // The primary purpose of this method is to "tap into" a method chain, in
  // order to perform operations on intermediate results within the chain.
  _.tap = function(obj, interceptor) {
    interceptor(obj);
    return obj;
  };

  // Returns whether an object has a given set of `key:value` pairs.
  _.isMatch = function(object, attrs) {
    var keys = _.keys(attrs), length = keys.length;
    if (object == null) return !length;
    var obj = Object(object);
    for (var i = 0; i < length; i++) {
      var key = keys[i];
      if (attrs[key] !== obj[key] || !(key in obj)) return false;
    }
    return true;
  };


  // Internal recursive comparison function for `isEqual`.
  var eq = function(a, b, aStack, bStack) {
    // Identical objects are equal. `0 === -0`, but they aren't identical.
    // See the [Harmony `egal` proposal](http://wiki.ecmascript.org/doku.php?id=harmony:egal).
    if (a === b) return a !== 0 || 1 / a === 1 / b;
    // A strict comparison is necessary because `null == undefined`.
    if (a == null || b == null) return a === b;
    // Unwrap any wrapped objects.
    if (a instanceof _) a = a._wrapped;
    if (b instanceof _) b = b._wrapped;
    // Compare `[[Class]]` names.
    var className = toString.call(a);
    if (className !== toString.call(b)) return false;
    switch (className) {
      // Strings, numbers, regular expressions, dates, and booleans are compared by value.
      case '[object RegExp]':
      // RegExps are coerced to strings for comparison (Note: '' + /a/i === '/a/i')
      case '[object String]':
        // Primitives and their corresponding object wrappers are equivalent; thus, `"5"` is
        // equivalent to `new String("5")`.
        return '' + a === '' + b;
      case '[object Number]':
        // `NaN`s are equivalent, but non-reflexive.
        // Object(NaN) is equivalent to NaN
        if (+a !== +a) return +b !== +b;
        // An `egal` comparison is performed for other numeric values.
        return +a === 0 ? 1 / +a === 1 / b : +a === +b;
      case '[object Date]':
      case '[object Boolean]':
        // Coerce dates and booleans to numeric primitive values. Dates are compared by their
        // millisecond representations. Note that invalid dates with millisecond representations
        // of `NaN` are not equivalent.
        return +a === +b;
    }

    var areArrays = className === '[object Array]';
    if (!areArrays) {
      if (typeof a != 'object' || typeof b != 'object') return false;

      // Objects with different constructors are not equivalent, but `Object`s or `Array`s
      // from different frames are.
      var aCtor = a.constructor, bCtor = b.constructor;
      if (aCtor !== bCtor && !(_.isFunction(aCtor) && aCtor instanceof aCtor &&
                               _.isFunction(bCtor) && bCtor instanceof bCtor)
                          && ('constructor' in a && 'constructor' in b)) {
        return false;
      }
    }
    // Assume equality for cyclic structures. The algorithm for detecting cyclic
    // structures is adapted from ES 5.1 section 15.12.3, abstract operation `JO`.

    // Initializing stack of traversed objects.
    // It's done here since we only need them for objects and arrays comparison.
    aStack = aStack || [];
    bStack = bStack || [];
    var length = aStack.length;
    while (length--) {
      // Linear search. Performance is inversely proportional to the number of
      // unique nested structures.
      if (aStack[length] === a) return bStack[length] === b;
    }

    // Add the first object to the stack of traversed objects.
    aStack.push(a);
    bStack.push(b);

    // Recursively compare objects and arrays.
    if (areArrays) {
      // Compare array lengths to determine if a deep comparison is necessary.
      length = a.length;
      if (length !== b.length) return false;
      // Deep compare the contents, ignoring non-numeric properties.
      while (length--) {
        if (!eq(a[length], b[length], aStack, bStack)) return false;
      }
    } else {
      // Deep compare objects.
      var keys = _.keys(a), key;
      length = keys.length;
      // Ensure that both objects contain the same number of properties before comparing deep equality.
      if (_.keys(b).length !== length) return false;
      while (length--) {
        // Deep compare each member
        key = keys[length];
        if (!(_.has(b, key) && eq(a[key], b[key], aStack, bStack))) return false;
      }
    }
    // Remove the first object from the stack of traversed objects.
    aStack.pop();
    bStack.pop();
    return true;
  };

  // Perform a deep comparison to check if two objects are equal.
  _.isEqual = function(a, b) {
    return eq(a, b);
  };

  // Is a given array, string, or object empty?
  // An "empty" object has no enumerable own-properties.
  _.isEmpty = function(obj) {
    if (obj == null) return true;
    if (isArrayLike(obj) && (_.isArray(obj) || _.isString(obj) || _.isArguments(obj))) return obj.length === 0;
    return _.keys(obj).length === 0;
  };

  // Is a given value a DOM element?
  _.isElement = function(obj) {
    return !!(obj && obj.nodeType === 1);
  };

  // Is a given value an array?
  // Delegates to ECMA5's native Array.isArray
  _.isArray = nativeIsArray || function(obj) {
    return toString.call(obj) === '[object Array]';
  };

  // Is a given variable an object?
  _.isObject = function(obj) {
    var type = typeof obj;
    return type === 'function' || type === 'object' && !!obj;
  };

  // Add some isType methods: isArguments, isFunction, isString, isNumber, isDate, isRegExp, isError.
  _.each(['Arguments', 'Function', 'String', 'Number', 'Date', 'RegExp', 'Error'], function(name) {
    _['is' + name] = function(obj) {
      return toString.call(obj) === '[object ' + name + ']';
    };
  });

  // Define a fallback version of the method in browsers (ahem, IE < 9), where
  // there isn't any inspectable "Arguments" type.
  if (!_.isArguments(arguments)) {
    _.isArguments = function(obj) {
      return _.has(obj, 'callee');
    };
  }

  // Optimize `isFunction` if appropriate. Work around some typeof bugs in old v8,
  // IE 11 (#1621), and in Safari 8 (#1929).
  if (typeof /./ != 'function' && typeof Int8Array != 'object') {
    _.isFunction = function(obj) {
      return typeof obj == 'function' || false;
    };
  }

  // Is a given object a finite number?
  _.isFinite = function(obj) {
    return isFinite(obj) && !isNaN(parseFloat(obj));
  };

  // Is the given value `NaN`? (NaN is the only number which does not equal itself).
  _.isNaN = function(obj) {
    return _.isNumber(obj) && obj !== +obj;
  };

  // Is a given value a boolean?
  _.isBoolean = function(obj) {
    return obj === true || obj === false || toString.call(obj) === '[object Boolean]';
  };

  // Is a given value equal to null?
  _.isNull = function(obj) {
    return obj === null;
  };

  // Is a given variable undefined?
  _.isUndefined = function(obj) {
    return obj === void 0;
  };

  // Shortcut function for checking if an object has a given property directly
  // on itself (in other words, not on a prototype).
  _.has = function(obj, key) {
    return obj != null && hasOwnProperty.call(obj, key);
  };

  // Utility Functions
  // -----------------

  // Run Underscore.js in *noConflict* mode, returning the `_` variable to its
  // previous owner. Returns a reference to the Underscore object.
  _.noConflict = function() {
    root._ = previousUnderscore;
    return this;
  };

  // Keep the identity function around for default iteratees.
  _.identity = function(value) {
    return value;
  };

  // Predicate-generating functions. Often useful outside of Underscore.
  _.constant = function(value) {
    return function() {
      return value;
    };
  };

  _.noop = function(){};

  _.property = property;

  // Generates a function for a given object that returns a given property.
  _.propertyOf = function(obj) {
    return obj == null ? function(){} : function(key) {
      return obj[key];
    };
  };

  // Returns a predicate for checking whether an object has a given set of
  // `key:value` pairs.
  _.matcher = _.matches = function(attrs) {
    attrs = _.extendOwn({}, attrs);
    return function(obj) {
      return _.isMatch(obj, attrs);
    };
  };

  // Run a function **n** times.
  _.times = function(n, iteratee, context) {
    var accum = Array(Math.max(0, n));
    iteratee = optimizeCb(iteratee, context, 1);
    for (var i = 0; i < n; i++) accum[i] = iteratee(i);
    return accum;
  };

  // Return a random integer between min and max (inclusive).
  _.random = function(min, max) {
    if (max == null) {
      max = min;
      min = 0;
    }
    return min + Math.floor(Math.random() * (max - min + 1));
  };

  // A (possibly faster) way to get the current timestamp as an integer.
  _.now = Date.now || function() {
    return new Date().getTime();
  };

   // List of HTML entities for escaping.
  var escapeMap = {
    '&': '&amp;',
    '<': '&lt;',
    '>': '&gt;',
    '"': '&quot;',
    "'": '&#x27;',
    '`': '&#x60;'
  };
  var unescapeMap = _.invert(escapeMap);

  // Functions for escaping and unescaping strings to/from HTML interpolation.
  var createEscaper = function(map) {
    var escaper = function(match) {
      return map[match];
    };
    // Regexes for identifying a key that needs to be escaped
    var source = '(?:' + _.keys(map).join('|') + ')';
    var testRegexp = RegExp(source);
    var replaceRegexp = RegExp(source, 'g');
    return function(string) {
      string = string == null ? '' : '' + string;
      return testRegexp.test(string) ? string.replace(replaceRegexp, escaper) : string;
    };
  };
  _.escape = createEscaper(escapeMap);
  _.unescape = createEscaper(unescapeMap);

  // If the value of the named `property` is a function then invoke it with the
  // `object` as context; otherwise, return it.
  _.result = function(object, property, fallback) {
    var value = object == null ? void 0 : object[property];
    if (value === void 0) {
      value = fallback;
    }
    return _.isFunction(value) ? value.call(object) : value;
  };

  // Generate a unique integer id (unique within the entire client session).
  // Useful for temporary DOM ids.
  var idCounter = 0;
  _.uniqueId = function(prefix) {
    var id = ++idCounter + '';
    return prefix ? prefix + id : id;
  };

  // By default, Underscore uses ERB-style template delimiters, change the
  // following template settings to use alternative delimiters.
  _.templateSettings = {
    evaluate    : /<%([\s\S]+?)%>/g,
    interpolate : /<%=([\s\S]+?)%>/g,
    escape      : /<%-([\s\S]+?)%>/g
  };

  // When customizing `templateSettings`, if you don't want to define an
  // interpolation, evaluation or escaping regex, we need one that is
  // guaranteed not to match.
  var noMatch = /(.)^/;

  // Certain characters need to be escaped so that they can be put into a
  // string literal.
  var escapes = {
    "'":      "'",
    '\\':     '\\',
    '\r':     'r',
    '\n':     'n',
    '\u2028': 'u2028',
    '\u2029': 'u2029'
  };

  var escaper = /\\|'|\r|\n|\u2028|\u2029/g;

  var escapeChar = function(match) {
    return '\\' + escapes[match];
  };

  // JavaScript micro-templating, similar to John Resig's implementation.
  // Underscore templating handles arbitrary delimiters, preserves whitespace,
  // and correctly escapes quotes within interpolated code.
  // NB: `oldSettings` only exists for backwards compatibility.
  _.template = function(text, settings, oldSettings) {
    if (!settings && oldSettings) settings = oldSettings;
    settings = _.defaults({}, settings, _.templateSettings);

    // Combine delimiters into one regular expression via alternation.
    var matcher = RegExp([
      (settings.escape || noMatch).source,
      (settings.interpolate || noMatch).source,
      (settings.evaluate || noMatch).source
    ].join('|') + '|$', 'g');

    // Compile the template source, escaping string literals appropriately.
    var index = 0;
    var source = "__p+='";
    text.replace(matcher, function(match, escape, interpolate, evaluate, offset) {
      source += text.slice(index, offset).replace(escaper, escapeChar);
      index = offset + match.length;

      if (escape) {
        source += "'+\n((__t=(" + escape + "))==null?'':_.escape(__t))+\n'";
      } else if (interpolate) {
        source += "'+\n((__t=(" + interpolate + "))==null?'':__t)+\n'";
      } else if (evaluate) {
        source += "';\n" + evaluate + "\n__p+='";
      }

      // Adobe VMs need the match returned to produce the correct offest.
      return match;
    });
    source += "';\n";

    // If a variable is not specified, place data values in local scope.
    if (!settings.variable) source = 'with(obj||{}){\n' + source + '}\n';

    source = "var __t,__p='',__j=Array.prototype.join," +
      "print=function(){__p+=__j.call(arguments,'');};\n" +
      source + 'return __p;\n';

    try {
      var render = new Function(settings.variable || 'obj', '_', source);
    } catch (e) {
      e.source = source;
      throw e;
    }

    var template = function(data) {
      return render.call(this, data, _);
    };

    // Provide the compiled source as a convenience for precompilation.
    var argument = settings.variable || 'obj';
    template.source = 'function(' + argument + '){\n' + source + '}';

    return template;
  };

  // Add a "chain" function. Start chaining a wrapped Underscore object.
  _.chain = function(obj) {
    var instance = _(obj);
    instance._chain = true;
    return instance;
  };

  // OOP
  // ---------------
  // If Underscore is called as a function, it returns a wrapped object that
  // can be used OO-style. This wrapper holds altered versions of all the
  // underscore functions. Wrapped objects may be chained.

  // Helper function to continue chaining intermediate results.
  var result = function(instance, obj) {
    return instance._chain ? _(obj).chain() : obj;
  };

  // Add your own custom functions to the Underscore object.
  _.mixin = function(obj) {
    _.each(_.functions(obj), function(name) {
      var func = _[name] = obj[name];
      _.prototype[name] = function() {
        var args = [this._wrapped];
        push.apply(args, arguments);
        return result(this, func.apply(_, args));
      };
    });
  };

  // Add all of the Underscore functions to the wrapper object.
  _.mixin(_);

  // Add all mutator Array functions to the wrapper.
  _.each(['pop', 'push', 'reverse', 'shift', 'sort', 'splice', 'unshift'], function(name) {
    var method = ArrayProto[name];
    _.prototype[name] = function() {
      var obj = this._wrapped;
      method.apply(obj, arguments);
      if ((name === 'shift' || name === 'splice') && obj.length === 0) delete obj[0];
      return result(this, obj);
    };
  });

  // Add all accessor Array functions to the wrapper.
  _.each(['concat', 'join', 'slice'], function(name) {
    var method = ArrayProto[name];
    _.prototype[name] = function() {
      return result(this, method.apply(this._wrapped, arguments));
    };
  });

  // Extracts the result from a wrapped and chained object.
  _.prototype.value = function() {
    return this._wrapped;
  };

  // Provide unwrapping proxy for some methods used in engine operations
  // such as arithmetic and JSON stringification.
  _.prototype.valueOf = _.prototype.toJSON = _.prototype.value;

  _.prototype.toString = function() {
    return '' + this._wrapped;
  };

  // AMD registration happens at the end for compatibility with AMD loaders
  // that may not enforce next-turn semantics on modules. Even though general
  // practice for AMD registration is to be anonymous, underscore registers
  // as a named module because, like jQuery, it is a base library that is
  // popular enough to be bundled in a third party lib, but not be part of
  // an AMD load request. Those cases could generate an error when an
  // anonymous define() is called outside of a loader request.
  if (typeof define === 'function' && define.amd) {
    define('underscore', [], function() {
      return _;
    });
  }
}.call(this));
</script>
<!--
An element providing a solution to no problem in particular.

Example:

    <paper-map-info></paper-map-info>

Example:

    <paper-map-info>
      <h2>Hello paper-map-info</h2>
    </paper-map-info>

@demo demo/index.html
@hero hero.svg
-->

<dom-module id="paper-map-info" assetpath="../../bower_components/paper-map-info/">
  <template>
    <style>
      :host {
        display: inline-block;
      }

      .infocard {
        position: absolute;
        z-index: 999;
        max-width: 80%;
        max-height: 75%;
        top: 0;
        left: 0;
        background: white;
        box-sizing: border-box;
        padding: 12px 28px 12px 12px;
        border-radius: 4px;
        opacity: 0;
        display: none;
        @apply(--paper-map-info-mixin);
      }

      .infocard-beak {
        position: absolute;
        opacity: 0;
        display: none;
      }

      #stdbeak svg rect {
        fill: blue;
        stroke: black;
        stroke-width: 1;
        @apply(--paper-map-info-beak-mixin)
      }

      div.card-content {
        overflow: hidden;
        @apply(--paper-map-info-content)
      }

      iron-icon.closeicon {
        --iron-icon-width: 32px;
        --iron-icon-height: 32px;
        position: absolute;
        left: 6px;
        top: 6px;
      }
    </style>
    <div id="stdbeak" class="infocard-beak">
      <svg width="20" height="20">
        <rect x="4" y="4" width="12" height="12" transform="rotate(45 10,10)">
      </rect></svg>
    </div>
    <div id="custombeak" class="infocard-beak">
      <content id="custombeakcontent" select=".paper-map-info-beak"></content>
    </div>
    <paper-material id="infocarddiv" class="infocard" elevation="[[elevation]]">
      <resize-aware>
        <div class="card-content">
          <content id="cardcontent" select="*"></content>
        </div>
      </resize-aware>
      <iron-icon class="closeicon" icon="papmapinf:close" on-tap="close"></iron-icon>
    </paper-material>

  </template>
  <script>/// <reference path="bower_components/polymer-ts/polymer-ts.d.ts" />
/// <reference path="typings/underscore.d.ts" />
var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var paperMapInfo = (function (_super) {
    __extends(paperMapInfo, _super);
    /**
     * script implements custom element <paper-map-info> as a Polymer element
     *
     *
     */
    function paperMapInfo() {
        return _super.apply(this, arguments) || this;
    }
    /**
     * close infowindow
     */
    paperMapInfo.prototype.close = function () {
        this._releaseListeners();
        // turn off the resize-aware ??
        this.isShowing = false;
        this.$.infocarddiv.style.opacity = 0;
        this.$.infocarddiv.style.left = 0;
        this.$.infocarddiv.style.display = "none";
        this.$.stdbeak.style.display = "none";
        this.$.custombeak.style.display = "none";
        this.$.stdbeak.style.opacity = 0;
        this.$.custombeak.style.opacity = 0;
        //this._marker = undefined;
    };
    /**
     * handle change to content
     */
    paperMapInfo.prototype._contentChanged = function () {
        if (this.isShowing) {
            this._getInfowindowSize();
            var placement = this._setInfowindowPosition();
            if (!this._placementInBounds(placement)) {
                this._panToShowInfowindow(placement);
            }
        }
    };
    /**
     * clean up when this element is detached from the DOM
     */
    paperMapInfo.prototype.detached = function () {
        this._releaseListeners();
        this.isShowing = false;
        this.$.infocarddiv.style.left = 0;
        this.$.infocarddiv.style.opacity = this.fadeIn ? 0 : 1;
        this.$.infocarddiv.style.display = "none";
        this.$.stdbeak.display = "none";
        this.$.custombeak.display = "none";
        this.$.stdbeak.opacity = 0;
        this.$.custombeak.opacity = 0;
        this._marker = undefined;
        this.map = undefined;
    };
    /**
     * perform fade in animation for card
     */
    paperMapInfo.prototype._doFadeIn = function () {
        var _this = this;
        if (this.isShowing) {
            var currentOpacity = parseFloat(this.$.infocarddiv.style.opacity);
            if (currentOpacity >= 0.9) {
                this.$.infocarddiv.style.opacity = "1";
            }
            else {
                currentOpacity += 0.1;
                this.$.infocarddiv.style.opacity = currentOpacity.toString();
                setTimeout(function () {
                    _this._doFadeIn();
                }, 40);
            }
        }
    };
    /**
     * get infowindow size
     */
    paperMapInfo.prototype._getInfowindowSize = function () {
        var icd = this.$.infocarddiv;
        this._dim.card.width = icd.offsetWidth;
        this._dim.card.height = icd.offsetHeight;
        // and the beak
        if (this._isCustomBeak) {
            this._dim.beak.height = this._bk.offsetHeight;
            this._dim.beak.width = this._bk.offsetWidth;
            this._dim.customBeak = true;
        }
        else {
            this._dim.beak = { height: 20, width: 20 };
            this._dim.customBeak = false;
        }
    };
    /**
     * get marker size
     */
    paperMapInfo.prototype._getMarkerSize = function () {
        if (this._marker && this._marker.getIcon()) {
            var mIcon = this._marker.getIcon();
            this._dim.marker.y = mIcon.anchor.y;
            this._dim.marker.x = 0;
        }
        else {
            this._dim.marker = { x: 0, y: 42 }; // height of standard pin
        }
    };
    /**
     * get map size
     */
    paperMapInfo.prototype._getMapSize = function () {
        var gm = this.map.getDiv();
        this._dim.map.width = gm.offsetWidth;
        this._dim.map.height = gm.offsetHeight;
    };
    /**
     * initialize map event listeners
     */
    paperMapInfo.prototype._initListeners = function () {
        var _this = this;
        this._mapListeners = [];
        this._overlay = new google.maps.OverlayView();
        this._overlay.draw = function () { };
        this._overlay.setMap(this.map);
        var reposition = function () {
            if (_this.isShowing) {
                _this._getInfowindowSize();
                _this._setInfowindowPosition();
            }
        };
        this._mapListeners.push(google.maps.event.addListener(this.map, 'projection_changed', function () {
            _this._overlay = new google.maps.OverlayView();
            _this._overlay.draw = function () { };
            _this._overlay.setMap(_this.map);
        }));
        this._mapListeners.push(google.maps.event.addListener(this.map, 'zoom_changed', function (e) {
            if (_this.isShowing) {
                _this._getInfowindowSize();
                _this._setInfowindowPosition();
            }
        }));
        this._mapListeners.push(google.maps.event.addListener(this.map, 'center_changed', function (e) {
            if (_this.isShowing) {
                reposition();
            }
        }));
        this._mapListeners.push(google.maps.event.addListener(this._marker, 'drag', function (e) {
            if (_this.isShowing) {
                _this._setInfowindowPosition();
            }
        }));
        if (!this._watchingSize) {
            this.$$('resize-aware').addEventListener('element-resize', function () { _this._contentChanged(); });
        }
    };
    /**
     * when the map is set, initialize the overlay,
     * which can take a moment since it is not loaded automatically
     * with the rest of the map apis
     */
    paperMapInfo.prototype._mapChanged = function (newVal, oldVal) {
        if (this.map) {
            this._overlay = new google.maps.OverlayView();
            this._overlay.draw = function () { };
            this._overlay.setMap(this.map);
        }
    };
    /**
     * Pan the map to move the info card into view
     * @param {Iplacement} placement current info card placement
     */
    paperMapInfo.prototype._panToShowInfowindow = function (placement) {
        var panby = { x: 0, y: 0 };
        if (placement.left < 0) {
            panby.x = placement.left - 10;
        }
        else {
            if ((placement.left + this._dim.card.width) > this._dim.map.width) {
                panby.x = (placement.left + this._dim.card.width) - this._dim.map.width + 10;
            }
        }
        if (placement.top < 0) {
            panby.y = placement.top - 10;
        }
        else {
            if ((placement.top + this._dim.card.height + this._dim.marker.y + 10) > this._dim.map.height) {
                panby.y = (placement.top + this._dim.card.height + this._dim.marker.y) - this._dim.map.height + 20;
            }
        }
        if (panby.x != 0 || panby.y != 0) {
            this.map.panBy(panby.x, panby.y);
        }
    };
    /**
     * Is the current info card placement within the bounds of the map's containing div?
     * @param  {Iplacement} placement current placement of the info card (top, left)
     * @return {boolean}              true if the info card fits inside the map's containing div
     */
    paperMapInfo.prototype._placementInBounds = function (placement) {
        var result = (placement.top >= 0
            && placement.left >= 0
            && (placement.left + this._dim.card.width) < this._dim.map.width
            && (placement.top + this._dim.card.height + this._dim.marker.y + 10) < this._dim.map.height);
        return result;
    };
    /**
     * initialize component
     */
    paperMapInfo.prototype.ready = function () {
        if (this.map) {
            this._overlay = new google.maps.OverlayView();
            this._overlay.draw = function () { };
            this._overlay.setMap(this.map);
        }
    };
    /**
     * release event listeners
     */
    paperMapInfo.prototype._releaseListeners = function () {
        for (var _i = 0, _a = this._mapListeners; _i < _a.length; _i++) {
            var l = _a[_i];
            google.maps.event.removeListener(l);
        }
        this._mapListeners = [];
        // turn off resize listener?
    };
    /**
     * Sets the info card's position relative to the map's containing div
     * @return {Iplacement} New position of the info card
     */
    paperMapInfo.prototype._setInfowindowPosition = function () {
        if (!this._overlay) {
            this._overlay = new google.maps.OverlayView();
            this._overlay.draw = function () { };
            this._overlay.setMap(this.map);
            console.log("overlay not set");
        }
        var result = { left: 0, top: 0 };
        try {
            var point = this._overlay.getProjection().fromLatLngToContainerPixel(this._marker.getPosition());
            // calculate placement
            var pleft = Math.round(point.x - this._dim.card.width / 2);
            var ptop = Math.round(point.y - this._dim.card.height - this._dim.marker.y - this._dim.beak.height + 10); // beak tucks 10px above bottom edge of window
            this.$.infocarddiv.style.left = pleft + 'px';
            this.$.infocarddiv.style.top = ptop + 'px';
            this._bk.style.left = (point.x - this._dim.beak.width / 2) + "px";
            this._bk.style.top = Math.floor(ptop - 10 + this._dim.card.height) + "px"; // beak tucks 10px above bottom edge of window
            result = { left: pleft, top: ptop };
        }
        catch (err) {
            console.log("setInfowindowPosition error");
            console.log(err);
        }
        ;
        return result;
    };
    /**
     * Shows the info card on top of the given google map marker
     * @param {google.maps.Marker} marker  The marker to attach the card to
     */
    paperMapInfo.prototype.showInfoWindow = function (marker) {
        var _this = this;
        if (this.map && marker) {
            if (this.isShowing) {
                this.close();
            }
            this._marker = marker;
            this._getMapSize();
            this._getMarkerSize();
            this.$.infocarddiv.style.display = "block";
            if (Polymer.dom(this.$.custombeakcontent).getDistributedNodes().length > 0) {
                this._bk = this.$.custombeak;
                this._nbk = this.$.stdbeak;
                this._isCustomBeak = true;
            }
            else {
                this._bk = this.$.stdbeak;
                this._nbk = this.$.custombeak;
                this._isCustomBeak = false;
            }
            this._bk.style.opacity = "0";
            this._bk.style.display = "block";
            this._nbk.style.opacity = "0";
            this._nbk.style.display = "none";
            // to minimize repositioning due to content size changes
            // as polymer instantiates webcomponents in the <content>,
            // we will pause a few ms before instantiating the infowindow.
            setTimeout(function () {
                _this._getInfowindowSize();
                var placement = _this._setInfowindowPosition();
                _this.$.infocarddiv.style.opacity = _this.fadeIn ? 0 : 1;
                _this._bk.style.opacity = "1";
                _this._initListeners();
                _this.isShowing = true;
                if (_this.fadeIn) {
                    _this._doFadeIn();
                }
                if (!_this._placementInBounds(placement)) {
                    _this._panToShowInfowindow(placement);
                }
            }, 33);
        }
    };
    return paperMapInfo;
}(polymer.Base));
__decorate([
    property({ type: Number, notify: true, value: 4 })
], paperMapInfo.prototype, "elevation", void 0);
__decorate([
    property({ type: Boolean, notify: true, value: false })
], paperMapInfo.prototype, "fadeIn", void 0);
__decorate([
    property({ type: Boolean, notify: true, value: false })
], paperMapInfo.prototype, "isShowing", void 0);
__decorate([
    property({ type: Object, notify: true, value: function () { return { card: { height: 10, width: 10 }, map: { height: 100, width: 100 }, marker: { x: 0, y: 42 }, beak: { width: 20, height: 20, customBeak: false } }; } })
], paperMapInfo.prototype, "_dim", void 0);
__decorate([
    property({ type: Object, notify: true, observer: '_mapChanged' })
], paperMapInfo.prototype, "map", void 0);
__decorate([
    property({ type: Array, notify: true, value: function () { return []; } })
], paperMapInfo.prototype, "_mapListeners", void 0);
__decorate([
    property({ type: Object, notify: true })
], paperMapInfo.prototype, "_marker", void 0);
__decorate([
    property({ type: Object, notify: true })
], paperMapInfo.prototype, "_overlay", void 0);
__decorate([
    property({ type: Object })
], paperMapInfo.prototype, "_bk", void 0);
__decorate([
    property({ type: Object })
], paperMapInfo.prototype, "_nbk", void 0);
__decorate([
    property({ type: Boolean, notify: true, value: false })
], paperMapInfo.prototype, "_isCustomBeak", void 0);
__decorate([
    property({ type: Boolean, notify: true, value: false })
], paperMapInfo.prototype, "_watchingSize", void 0);
paperMapInfo = __decorate([
    component('paper-map-info')
], paperMapInfo);
paperMapInfo.register();
//# sourceMappingURL=paper-map-info.js.map</script>
</dom-module>
<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
--><script>
  console.warn('This file is deprecated. Please use `iron-flex-layout/iron-flex-layout-classes.html`, and one of the specific dom-modules instead');
</script>

<style>

  /*******************************
            Flex Layout
  *******************************/

  html /deep/ .layout.horizontal,
  html /deep/ .layout.horizontal-reverse,
  html /deep/ .layout.vertical,
  html /deep/ .layout.vertical-reverse {
    display: -ms-flexbox;
    display: -webkit-flex;
    display: flex;
  }

  html /deep/ .layout.inline {
    display: -ms-inline-flexbox;
    display: -webkit-inline-flex;
    display: inline-flex;
  }

  html /deep/ .layout.horizontal {
    -ms-flex-direction: row;
    -webkit-flex-direction: row;
    flex-direction: row;
  }

  html /deep/ .layout.horizontal-reverse {
    -ms-flex-direction: row-reverse;
    -webkit-flex-direction: row-reverse;
    flex-direction: row-reverse;
  }

  html /deep/ .layout.vertical {
    -ms-flex-direction: column;
    -webkit-flex-direction: column;
    flex-direction: column;
  }

  html /deep/ .layout.vertical-reverse {
    -ms-flex-direction: column-reverse;
    -webkit-flex-direction: column-reverse;
    flex-direction: column-reverse;
  }

  html /deep/ .layout.wrap {
    -ms-flex-wrap: wrap;
    -webkit-flex-wrap: wrap;
    flex-wrap: wrap;
  }
  
  html /deep/ .layout-no-wrap {
    -ms-flex-wrap: nowrap;
    -webkit-flex-wrap: nowrap;
    flex-wrap: nowrap;
  }

  html /deep/ .layout.wrap-reverse {
    -ms-flex-wrap: wrap-reverse;
    -webkit-flex-wrap: wrap-reverse;
    flex-wrap: wrap-reverse;
  }

  html /deep/ .flex-auto {
    -ms-flex: 1 1 auto;
    -webkit-flex: 1 1 auto;
    flex: 1 1 auto;
  }

  html /deep/ .flex-none {
    -ms-flex: none;
    -webkit-flex: none;
    flex: none;
  }

  html /deep/ .flex,
  html /deep/ .flex-1 {
    -ms-flex: 1;
    -webkit-flex: 1;
    flex: 1;
  }

  html /deep/ .flex-2 {
    -ms-flex: 2;
    -webkit-flex: 2;
    flex: 2;
  }

  html /deep/ .flex-3 {
    -ms-flex: 3;
    -webkit-flex: 3;
    flex: 3;
  }

  html /deep/ .flex-4 {
    -ms-flex: 4;
    -webkit-flex: 4;
    flex: 4;
  }

  html /deep/ .flex-5 {
    -ms-flex: 5;
    -webkit-flex: 5;
    flex: 5;
  }

  html /deep/ .flex-6 {
    -ms-flex: 6;
    -webkit-flex: 6;
    flex: 6;
  }

  html /deep/ .flex-7 {
    -ms-flex: 7;
    -webkit-flex: 7;
    flex: 7;
  }

  html /deep/ .flex-8 {
    -ms-flex: 8;
    -webkit-flex: 8;
    flex: 8;
  }

  html /deep/ .flex-9 {
    -ms-flex: 9;
    -webkit-flex: 9;
    flex: 9;
  }

  html /deep/ .flex-10 {
    -ms-flex: 10;
    -webkit-flex: 10;
    flex: 10;
  }

  html /deep/ .flex-11 {
    -ms-flex: 11;
    -webkit-flex: 11;
    flex: 11;
  }

  html /deep/ .flex-12 {
    -ms-flex: 12;
    -webkit-flex: 12;
    flex: 12;
  }

  /* alignment in cross axis */

  html /deep/ .layout.start {
    -ms-flex-align: start;
    -webkit-align-items: flex-start;
    align-items: flex-start;
  }

  html /deep/ .layout.center,
  html /deep/ .layout.center-center {
    -ms-flex-align: center;
    -webkit-align-items: center;
    align-items: center;
  }

  html /deep/ .layout.end {
    -ms-flex-align: end;
    -webkit-align-items: flex-end;
    align-items: flex-end;
  }

  /* alignment in main axis */

  html /deep/ .layout.start-justified {
    -ms-flex-pack: start;
    -webkit-justify-content: flex-start;
    justify-content: flex-start;
  }

  html /deep/ .layout.center-justified,
  html /deep/ .layout.center-center {
    -ms-flex-pack: center;
    -webkit-justify-content: center;
    justify-content: center;
  }

  html /deep/ .layout.end-justified {
    -ms-flex-pack: end;
    -webkit-justify-content: flex-end;
    justify-content: flex-end;
  }

  html /deep/ .layout.around-justified {
    -ms-flex-pack: around;
    -webkit-justify-content: space-around;
    justify-content: space-around;
  }

  html /deep/ .layout.justified {
    -ms-flex-pack: justify;
    -webkit-justify-content: space-between;
    justify-content: space-between;
  }

  /* self alignment */

  html /deep/ .self-start {
    -ms-align-self: flex-start;
    -webkit-align-self: flex-start;
    align-self: flex-start;
  }

  html /deep/ .self-center {
    -ms-align-self: center;
    -webkit-align-self: center;
    align-self: center;
  }

  html /deep/ .self-end {
    -ms-align-self: flex-end;
    -webkit-align-self: flex-end;
    align-self: flex-end;
  }

  html /deep/ .self-stretch {
    -ms-align-self: stretch;
    -webkit-align-self: stretch;
    align-self: stretch;
  }

  /*******************************
            Other Layout
  *******************************/

  html /deep/ .block {
    display: block;
  }

  /* IE 10 support for HTML5 hidden attr */
  html /deep/ [hidden] {
    display: none !important;
  }

  html /deep/ .invisible {
    visibility: hidden !important;
  }

  html /deep/ .relative {
    position: relative;
  }

  html /deep/ .fit {
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
  }

  body.fullbleed {
    margin: 0;
    height: 100vh;
  }

  html /deep/ .scroll {
    -webkit-overflow-scrolling: touch;
    overflow: auto;
  }

  .fixed-bottom,
  .fixed-left,
  .fixed-right,
  .fixed-top {
    position: fixed;
  }

  html /deep/ .fixed-top {
    top: 0;
    left: 0;
    right: 0;
  }

  html /deep/ .fixed-right {
    top: 0;
    right: 0;
    bottom: 0;
  }

  html /deep/ .fixed-bottom {
    right: 0;
    bottom: 0;
    left: 0;
  }

  html /deep/ .fixed-left {
    top: 0;
    bottom: 0;
    left: 0;
  }

</style>
<script>
  console.warn('This file is deprecated. Please use `iron-flex-layout/iron-flex-layout-classes.html`, and one of the specific dom-modules instead');
</script><!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<style>

  /*******************************
            Flex Layout
  *******************************/

  .layout.horizontal,
  .layout.horizontal-reverse,
  .layout.vertical,
  .layout.vertical-reverse {
    display: -ms-flexbox;
    display: -webkit-flex;
    display: flex;
  }

  .layout.inline {
    display: -ms-inline-flexbox;
    display: -webkit-inline-flex;
    display: inline-flex;
  }

  .layout.horizontal {
    -ms-flex-direction: row;
    -webkit-flex-direction: row;
    flex-direction: row;
  }

  .layout.horizontal-reverse {
    -ms-flex-direction: row-reverse;
    -webkit-flex-direction: row-reverse;
    flex-direction: row-reverse;
  }

  .layout.vertical {
    -ms-flex-direction: column;
    -webkit-flex-direction: column;
    flex-direction: column;
  }

  .layout.vertical-reverse {
    -ms-flex-direction: column-reverse;
    -webkit-flex-direction: column-reverse;
    flex-direction: column-reverse;
  }

  .layout.wrap {
    -ms-flex-wrap: wrap;
    -webkit-flex-wrap: wrap;
    flex-wrap: wrap;
  }
  
  .layout.no-wrap {
    -ms-flex-wrap: nowrap;
    -webkit-flex-wrap: nowrap;
    flex-wrap: nowrap;
  }

  .layout.wrap-reverse {
    -ms-flex-wrap: wrap-reverse;
    -webkit-flex-wrap: wrap-reverse;
    flex-wrap: wrap-reverse;
  }

  .flex-auto {
    -ms-flex: 1 1 auto;
    -webkit-flex: 1 1 auto;
    flex: 1 1 auto;
  }

  .flex-none {
    -ms-flex: none;
    -webkit-flex: none;
    flex: none;
  }

  .flex,
  .flex-1 {
    -ms-flex: 1;
    -webkit-flex: 1;
    flex: 1;
  }

  .flex-2 {
    -ms-flex: 2;
    -webkit-flex: 2;
    flex: 2;
  }

  .flex-3 {
    -ms-flex: 3;
    -webkit-flex: 3;
    flex: 3;
  }

  .flex-4 {
    -ms-flex: 4;
    -webkit-flex: 4;
    flex: 4;
  }

  .flex-5 {
    -ms-flex: 5;
    -webkit-flex: 5;
    flex: 5;
  }

  .flex-6 {
    -ms-flex: 6;
    -webkit-flex: 6;
    flex: 6;
  }

  .flex-7 {
    -ms-flex: 7;
    -webkit-flex: 7;
    flex: 7;
  }

  .flex-8 {
    -ms-flex: 8;
    -webkit-flex: 8;
    flex: 8;
  }

  .flex-9 {
    -ms-flex: 9;
    -webkit-flex: 9;
    flex: 9;
  }

  .flex-10 {
    -ms-flex: 10;
    -webkit-flex: 10;
    flex: 10;
  }

  .flex-11 {
    -ms-flex: 11;
    -webkit-flex: 11;
    flex: 11;
  }

  .flex-12 {
    -ms-flex: 12;
    -webkit-flex: 12;
    flex: 12;
  }

  /* alignment in cross axis */

  .layout.start {
    -ms-flex-align: start;
    -webkit-align-items: flex-start;
    align-items: flex-start;
  }

  .layout.center,
  .layout.center-center {
    -ms-flex-align: center;
    -webkit-align-items: center;
    align-items: center;
  }

  .layout.end {
    -ms-flex-align: end;
    -webkit-align-items: flex-end;
    align-items: flex-end;
  }

  /* alignment in main axis */

  .layout.start-justified {
    -ms-flex-pack: start;
    -webkit-justify-content: flex-start;
    justify-content: flex-start;
  }

  .layout.center-justified,
  .layout.center-center {
    -ms-flex-pack: center;
    -webkit-justify-content: center;
    justify-content: center;
  }

  .layout.end-justified {
    -ms-flex-pack: end;
    -webkit-justify-content: flex-end;
    justify-content: flex-end;
  }

  .layout.around-justified {
    -ms-flex-pack: around;
    -webkit-justify-content: space-around;
    justify-content: space-around;
  }

  .layout.justified {
    -ms-flex-pack: justify;
    -webkit-justify-content: space-between;
    justify-content: space-between;
  }

  /* self alignment */

  .self-start {
    -ms-align-self: flex-start;
    -webkit-align-self: flex-start;
    align-self: flex-start;
  }

  .self-center {
    -ms-align-self: center;
    -webkit-align-self: center;
    align-self: center;
  }

  .self-end {
    -ms-align-self: flex-end;
    -webkit-align-self: flex-end;
    align-self: flex-end;
  }

  .self-stretch {
    -ms-align-self: stretch;
    -webkit-align-self: stretch;
    align-self: stretch;
  }

  /*******************************
            Other Layout
  *******************************/

  .block {
    display: block;
  }

  /* IE 10 support for HTML5 hidden attr */
  [hidden] {
    display: none !important;
  }

  .invisible {
    visibility: hidden !important;
  }

  .relative {
    position: relative;
  }

  .fit {
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
  }

  body.fullbleed {
    margin: 0;
    height: 100vh;
  }

  .scroll {
    -webkit-overflow-scrolling: touch;
    overflow: auto;
  }

  /* fixed position */

  .fixed-bottom,
  .fixed-left,
  .fixed-right,
  .fixed-top {
    position: fixed;
  }

  .fixed-top {
    top: 0;
    left: 0;
    right: 0;
  }

  .fixed-right {
    top: 0;
    right: 0;
    bottom: 0;
  }

  .fixed-bottom {
    right: 0;
    bottom: 0;
    left: 0;
  }

  .fixed-left {
    top: 0;
    bottom: 0;
    left: 0;
  }

</style>
<dom-module id="oav-items-map" assetpath="/">
  <template>
    <style include="iron-flex iron-flex-alignment">
      :host {
        display: block;
        width: 100% !important;
        height: 100% !important;
      }

      .topMapContainer {
        width: 100% !important;
        height: 100% !important;
      }

      .mapContainer {
        width: 100% !important;
        height: 100% !important;
        margin-top: 16px;
      }

      .noMapContainer {
        padding: 8px;
        margin: 16px;
        background-color: #FFF;
      }

      #map {
      }

      a {
        color: var(--primary-color-700);
      }

      h1 {
        padding: 24px;
      }


      #myInfoCard {
        background-color: #000;
        padding: 0;
        margin: 0 !important;
        --paper-map-info-mixin: {
          padding: 0;
          margin: 0 !important;
          background-color: #fbfbfb;
          color: var(--app-accent-color);
          max-width: 100%;
          max-height: 100%;
        };
        --paper-map-info-beak-mixin: {
          color: var(--app-accent-color);
        };
      }

      .ballotItem {
        margin: 0;
        padding: 0;
        color: #FFF;
      }
    </style>

    <iron-media-query query="(min-width: 1000px)" query-matches="{{wide}}"></iron-media-query>

    <div class="layout vertical center-center topMapContainer">
      <template is="dom-if" if="[[noItems]]">
        <paper-material elevation="3" class="noMapContainer">
          <h1>[[t('items.noMapItems')]]</h1>
        </paper-material>
      </template>

      <template is="dom-if" if="[[items]]" restamp="">
        <div class="mapContainer">
          <google-map disable-default-ui$="[[tiny]]" id="map" api-key="[[apiKey]]" fit-to-markers="">
            <template is="dom-repeat" items="[[items]]" as="item">
              <template is="dom-repeat" items="[[item.locations]]" as="location">
                <google-map-marker click-events="" item="[[item]]" latitude="[[location.latitude]]" longitude="[[location.longitude]]" class="marker" on-google-map-marker-click="markerClick">
                </google-map-marker>
              </template>
            </template>
            <paper-map-info id="myInfoCard" fade-in="">
              <oav-area-ballot-item on-oav-toggle-item-in-budget="_closeInfo" small="" elevation="0" id="ballotItem" budget-element="[[budgetElement]]" class="ballotItem" item="[[selectedItem]]"></oav-area-ballot-item>
            </paper-map-info>
          </google-map>
        </div>
      </template>

    </div>
  </template>

  <script>
    Polymer({
      is: 'oav-items-map',

      behaviors: [
        Polymer.appHelpers
      ],

      properties: {
        items: {
          type: Array,
          value: null,
          observer: '_itemsChanged'
        },

        budgetElement: {
          type: Object
        },

        selectedItem: {
          type: Object
        },

        noItems: {
          type: Boolean,
          value: false
        },

        apiKey: {
          type: String,
          value: "AIzaSyDkF_kak8BVZA5zfp5R4xRnrX8HP3hjiL0"
        },

        wide: {
          type: Boolean,
          observer: '_wideChanged'
        }
      },

      _itemsChanged: function (newItems) {
      },

      _closeInfo: function () {
        ///this.$$("#myInfoCard").close();
      },

      attached: function () {
        this.async(function () {
          this.resetMapHeight();
        }.bind(this));
      },

      _wideChanged: function () {
        this.resetMapHeight();
      },

      resetMapHeight: function () {
        var map = this.$$("#map");
        var windowHeight = window.innerHeight;
        if (map) {
          var height;
          if (this.wide) {
            height = windowHeight - 322;
          } else {
            height = windowHeight - 236;
          }
          map.style.height = height + 'px';
        }
      },

      setItemInBudget: function (item) {
        if (this.selectedItem && this.selectedItem.id == item.id) {
          var item = this.$$("#ballotItem");
          if (item) {
            item.setInBudget();
          }
        }
      },

      removeFromBudget: function (item) {
        if (this.selectedItem && this.selectedItem.id == item.id) {
          var item = this.$$("#ballotItem");
          if (item) {
            this.$$("#ballotItem").removeFromBudget();
          }
        }
      },

      checkIfSelectedItemToExpensive: function(budgetLeft) {
        if (this.selectedItem) {
          var item = this.$$("#ballotItem");
          if (item) {
            if (!item.selectedInBudget) {
              if (this.selectedItem.price<=budgetLeft) {
                item.setNotTooExpensive();
                console.log("item id "+this.selectedItem.id+ "Not Too Expensive");
              } else if (this.selectedItem) {
                console.log("item id "+this.selectedItem.id+ "Too Expensive");
                item.setTooExpensive();
              }
            }
          }
        }
      },

      markerClick: function(e) {
        window.appGlobals.activity('click', 'marker');
        this.set('selectedItem', e.model.get('item'));
        var a = this.selectedItem;
        if (e.srcElement) {
          this.$$("#myInfoCard").showInfoWindow(e.srcElement.marker);
        } else {
          this.$$("#myInfoCard").showInfoWindow(e.currentTarget.marker);
        }
        var infocardDiv = this.$$("#myInfoCard").$$("#infocarddiv");
        infocardDiv.children[1].style.zIndex = "20";
      }
    });
  </script>
</dom-module></div><dom-module id="oav-area-ballot">
  <style include="iron-flex iron-flex-alignment">

    :host {
    }

    iron-list {
      margin-top: 24px;
      padding-bottom: 16px;
      background-color: var(--app-main-backround-color);
    }

    .name {
      font-size: 19px;
      padding: 8px;
    }

    .description {
      padding-left: 8px;
      padding-rigth: 8px;
    }

    .price {
      font-size: 20px;
      position: absolute;
      bottom: 4px;
      left: 8px;
    }

    paper-button.addButton {
      position: absolute;
      bottom: 16px;
      right: 8px;
      background-color: #F00;
      color: #FFF;
    }

    .budgetContainer {
      @apply(--layout-horizontal);
      @apply(--layout-center-center);
    }

    .votingButtonContainer {
      position: absolute;
      bottom: 16px;
    }

    .topContainer {
      background-color: var(--app-main-backround-color);
      color: #333;
    }


    paper-tabs {
      margin: 8px;
      margin-right: 16px;
      margin-left: 16px;
    }

    paper-tab {
      font-size: 21px !important;
      margin-left: 24px;
      margin-right: 24px;
      width: 320px;
    }

    @media (max-width: 1000px) {
      paper-tab {
        font-size: 15px !important;
        margin-left: 16px;
        margin-right: 16px;
      }
    }

    @media (max-width: 360px) {
      paper-tab {
        font-size: 14px !important;
        margin-left: 16px;
        margin-right: 16px;
      }
    }

  </style>

  <template>
    <iron-signals on-iron-signal-set-language="setLanguage"></iron-signals>

    <iron-media-query query="(min-width: 1000px)" query-matches="{{wide}}"></iron-media-query>
    <div class="topContainer layout vertical">
      <div class="layout horizontal center-center tabsContainer">
        <paper-tabs selected="{{selectedView}}">
          <paper-tab>
            <template is="dom-if" if="[[wide]]">
              <div>[[area.name]]</div>
            </template>
            <template is="dom-if" if="[[!wide]]">
              <div class="layout vertical center-center">
                <div>[[area.name]]</div>
              </div>
            </template>
          </paper-tab>
          <paper-tab>{{localize('items_on_map')}}</paper-tab>
        </paper-tabs>
      </div>

      <template is="dom-if" if="[[budgetBallotItems]]" restamp="">
        <iron-pages role="main" selected="{{selectedView}}">
          <section>
            <div id="itemContainer" class="layout horizontal center-center wrap">
              <template is="dom-repeat" id="domRepeat" items="[[budgetBallotItems]]" as="item" scroll-target="document" grid="">
                <oav-area-ballot-item class="ballotAreaItem" budget-element="{{budgetElement}}" tabindex$="[[tabIndex]]" item="[[item]]"></oav-area-ballot-item>
              </template>
            </div>
          </section>
          <section>
            <oav-items-map id="itemsMap" budget-element="[[budgetElement]]" items="[[budgetBallotItems]]"></oav-items-map>
          </section>
        </iron-pages>
      </template>

      <div class="layout horizontal center-center">

        <!-- DISABLE IN PRODUCTION USE -->
        <oav-ajax id="fakeLoginAjax" url="/votes/force_session_id?ssn=1907724039"></oav-ajax>
        <!-- FAKE LOGIN ENDS -->

        <oav-ajax id="getBallotAjax" url="/votes/get_ballot" on-response="_ballotResponse"></oav-ajax>
        <oav-ajax id="postBallotAjax" method="post" url="/votes/post_vote" on-response="_ballotPostResponse"></oav-ajax>
        <oav-ajax id="pollForLoginAjax" url="/votes/is_logged_in" on-response="_isLoggedInResponse"></oav-ajax>
      </div>
    </div>
  </template>

</dom-module>

<script>
  (function() {
    Polymer({

      is: 'oav-area-ballot',

      behaviors: [
        Polymer.appHelpers,
        Polymer.ballotEncryptionBehavior,
        Polymer.AppLocalizeBehavior
      ],

      listeners: {
        'oav-toggle-item-in-budget': '_toggleItemInBudget',
        'oav-set-favorite-item-in-budget': '_toggleFavoriteItem',
        'oav-submit-vote': '_postVoteToServer',
        'oav-item-selected-in-budget': '_itemSelectedInBudget',
        'oav-item-de-selected-from-budget': '_itemDeSelectedFromBudget'
      },

      properties: {

        area: {
          type: Object
        },

        areaId: {
          type: String,
          observer: '_areaIdChanged'
        },

        areaIdRoutePath: {
          type: Object,
          observer: '_areaIdRoutePathChanged'
        },

        selectedView: {
          type: Number,
          value: 0,
          observer: '_selectedViewChanged'
        },

        budgetElement: {
          type: Object
        },

        budgetBallotItems: Array,

        wide: Boolean,

        isPollingForLogin: {
          type: Boolean,
          value: false
        },

        isSendingBallot: {
          type: Boolean,
          value: false
        },

        haveSentBallot: {
          type: Boolean,
          value: false
        },

        popupWindow: Object,

        favoriteItem: {
          type: Object,
          value: null,
          observer: '_favoriteItemChanged'
        },

        oldFavoriteItem: Object
      },

      _favoriteItemChanged: function (newValue, oldValue) {
        this.set('oldFavoriteItem', oldValue);
        if (!newValue && oldValue) {
          this.fire("oav-hide-favorite-item");
        }

      },

      _selectedViewChanged: function (view) {
        if (view && view==0) {
          window.appGlobals.activity('click', 'ideasTab');
        } else if (view && view==1) {
          window.appGlobals.activity('click', 'mapTab');
        }
      },

      refreshList: function () {
        var list = this.$$("#domRepeat");
        if (list) {
          list.fire('iron-resize');
        }
      },

      ready: function() {
        window.appBallot = this;
        if (LOAD_TESTING_MODE) {
          this.$.fakeLoginAjax.generateRequest();
        }
      },

      attached: function () {
        this.loadLanguage(this.resolveUrl('/src/locales.json'));
      },

      reset: function () {
        if (this.budgetElement) {
          this.budgetElement.reset();
        }
        this._resetBallotItems();
        this.set('budgetBallotItems', null);
        this.set('area', null);
        this.fire('oav-set-area', { areaName: null, totalBudget: null });
        var list =  this.$$("#domRepeat");
        if (list) {
          list.fire('iron-resize');
        }
      },

      _resetBallotItems: function () {
        var listItems = this.$$("#itemContainer");
        if (listItems) {
          for (var i = 0; i < listItems.children.length; i++) {
            var listItem = listItems.children[i];
            if (listItem.id != 'domRepeat') {
              listItem.setNotTooExpensive();
              listItem.removeFromBudget();
            }
          }
        }
      },

      _toggleFavoriteItem: function (event, detail) {
        var item = detail.item;
        if (item) {
          window.appGlobals.activity('toggle', 'favorite');
        } else {
          window.appGlobals.activity('detoggle', 'favorite');
        }
        if (this.favoriteItem != item) {
          this.set('favoriteItem', item);
          var listItems = this.$$("#itemContainer");
          for (var i = 0; i < listItems.children.length; i++) {
            var listItem = listItems.children[i];
            if (listItem.id != 'domRepeat') {
              listItem.resetFromBudget();
            }
          }
        } else {
          console.warn("Trying to set item as favorite a second time");
        }
      },

      _toggleItemInBudget: function (event, detail) {
        this.budgetElement.toggleBudgetItem(detail.item);
      },

      _itemSelectedInBudget: function (event, detail) {
        var listItems = this.$$("#itemContainer");
        for (var i = 0; i < listItems.children.length; i++) {
          var listItem = listItems.children[i];
          if (listItem.id != 'domRepeat' && listItem.item.id == detail.itemId) {
            listItem.setInBudget();
            this.$$("#itemsMap").setItemInBudget(listItem.item);
          }
        }
        this._setStateOfRemainingItems();
      },

      _itemDeSelectedFromBudget: function (event, detail) {
        var listItems = this.$$("#itemContainer");
        for (var i = 0; i < listItems.children.length; i++) {
          var listItem = listItems.children[i];
          if (listItem.id != 'domRepeat' && listItem.item.id == detail.itemId) {
            if (this.favoriteItem==listItem.item) {
              this.set('favoriteItem', null);
            }
            listItem.removeFromBudget();
            this.$$("#itemsMap").removeFromBudget(listItem.item);
            this.fire("oav-reset-favorite-icon-position");
          }
        }
        this._setStateOfRemainingItems();
      },

      _setStateOfRemainingItems: function () {
        var budgetLeft = this.budgetElement.totalBudget-this.budgetElement.selectedBudget;
        var listItems = this.$$("#itemContainer");
        for (var i = 0; i < listItems.children.length; i++) {
          var listItem = listItems.children[i];
          if (listItem.id != 'domRepeat' && !listItem.selectedInBudget) {
            if (listItem.item.price<=budgetLeft) {
              listItem.setNotTooExpensive();
            } else {
              listItem.setTooExpensive();
            }
          }
        }
        this.$$("#itemsMap").checkIfSelectedItemToExpensive(budgetLeft);
      },

      _clearLocalVoteStorage: function () {
        localStorage.setItem('oav-encrypted-votes', null);
        localStorage.setItem('oav-encrypted-votes-area-id', null);
      },

      _postVoteToServer: function () {
        if (LOAD_TESTING_MODE) {
          this.completePostingOfVote(this._createEncryptedVotes());
        } else if (this.budgetElement.selectedItems && this.budgetElement.selectedItems.length>0) {
          if (false) {
            if (this._isInAppiOSOrIE11()) {
              localStorage.setItem('oav-encrypted-votes', this._createEncryptedVotes());
              localStorage.setItem('oav-encrypted-votes-area-id', this.area.id);
              window.location = this._getSamlUrlWithLanguage();
            } else {
              var dialog = Polymer.dom(document).querySelector('oav-app').getDialog("authDialog");
              dialog.open();
              this._openSamlLogin();
              this.set('isPollingForLogin', true);
              this._pollForLoginAjax();
            }
          } else {
            var dialog = Polymer.dom(document).querySelector('oav-app').getDialog("oavInsecureEmailLogin");
            dialog.setup(this._insecureEmailLoginCompleted.bind(this));
            dialog.open(this.area.id, this.area.name);
          }
        } else {
          this.fire('oav-error', this.localize('error_no_items_selected'));
          console.error('error_no_items_selected');
        }
      },

      _insecureEmailLoginCompleted: function (user, userPostCode) {
        this.cancelLoginPolling();
        this.completePostingOfVote(this._createEncryptedVotes(), null, userPostCode);
      },

      _isInAppiOSOrIE11: function () {
        var iOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream && /FBAN/.test(navigator.userAgent);
        var isIE11 = /Trident.*rv[ :]*11\./.test(navigator.userAgent);
        return iOS || isIE11;
      },

      _pollForLoginAjax: function () {
        if (this.isPollingForLogin===true) {
          this.$.pollForLoginAjax.params = {time: new Date().getTime()};
          this.$.pollForLoginAjax.generateRequest();
        }
      },

      cancelLoginPolling: function () {
        this.set('isPollingForLogin', false);
      },

      _isLoggedInResponse: function (event, detail) {
        if (this.isPollingForLogin===true) {
          if (detail.response.isLoggedin===true) {
            this.cancelLoginPolling();
            this.completePostingOfVote(this._createEncryptedVotes());
          } else if (detail.response.isLoggedin===false && this.isPollingForLogin===true) {
            this.async(function () {
              this._pollForLoginAjax();
            }.bind(this), 1500)
          }
        }
      },

      _createEncryptedVotes: function () {
        var selectedItemIds = _.map(this.budgetElement.selectedItems, function (item) {
          return item.id;
        });
        return this.encryptVote({ selectedItemIds: selectedItemIds,
                                  favoriteItemId: this.favoriteItem ? this.favoriteItem.id : null });
      },

      completePostingOfVote: function (encryptedVotes, localStorageAreaId, userPostCode) {
        if (!encryptedVotes) {
          encryptedVotes = this._createEncryptedVotes();
        }
        this.cancelLoginPolling();

        var areaId;
        if (this.area) {
          areaId = this.area.id;
        } else if (localStorageAreaId) {
          areaId = localStorageAreaId;
        } else {
          console.warn("No area id in complete voting");
        }

        if (areaId) {
          if (this.isSendingBallot===false && this.haveSentBallot===false) {
            var encryptedVote = encryptedVotes;
            if (encryptedVote) {
              this.$.postBallotAjax.body = { encrypted_vote: encryptedVote, area_id: areaId, user_postcode: userPostCode};
              this.$.postBallotAjax.generateRequest();
              this.set('isSendingBallot', true);
              this.set('haveSentBallot', true);
            } else {
              console.error("No encrypted votes!");
            }
          } else {
            console.warn("Already sending ballot");
          }
        } else {
          console.warn("Not sending as no area id");
        }
      },

      _completePostingOfVoteAfterRedirect: function () {
        this.completePostingOfVote(localStorage.getItem('oav-encrypted-votes'), localStorage.getItem('oav-encrypted-votes-area-id'));
      },

      _getSamlUrlWithLanguage: function () {
        var url = window.appGlobals.configFromServer.rsk_url;
        if (this.language=='en') {
          url+='&siteLanguage=en';
        }
        return url;
      },

      _openSamlLogin: function () {
        var url = this._getSamlUrlWithLanguage();
        var     width = 1200,
                height = 650,
                top = (window.outerHeight - height) / 2,
                left = (window.outerWidth - width) / 2;

        window.open(url, 'saml_login', 'width=' + width + ',height=' + height + ',scrollbars=0,top=' + top + ',left=' + left);
      },

      _ballotPostResponse: function (event, detail) {
        this.cancelLoginPolling();
        this.set('isSendingBallot', false);
        var dialog = Polymer.dom(document).querySelector('oav-app').getDialog("authDialog");
        if (dialog) {
          dialog.close();
        }

        this._clearLocalVoteStorage();

        if (detail.response.vote_ok==true && detail.response.error==false) {
          this.reset();
          this.set('areaId', null);
          window.location = "/#/voting-completed"
        } else {
          this.fire('oav-error', this.localize('error_could_not_post_vote'));
        }
        if (LOAD_TESTING_MODE) {
          this.$.fakeLoginAjax.generateRequest();
        }
      },

      _areaIdRoutePathChanged: function (newPathForId) {
        if (newPathForId && newPathForId.prefix && newPathForId.prefix == "/area-ballot") {
          if (newPathForId.path.slice(1)=='completePostingOfVoteAfterRedirect') {
            this._completePostingOfVoteAfterRedirect();
          } else {
            this.set('areaId', newPathForId.path.slice(1));
          }
        }
      },

      _areaIdChanged: function (newAreaId, oldAreaId) {
        if (newAreaId) {
          this.reset();
          this.set('haveSentBallot', false);
          this.set('favoriteItem', null);
          this.set('oldFavoriteItem', null);
          this.fire('ak-clear-area');
          this.$.getBallotAjax.params = { area_id: newAreaId };
          this.$.getBallotAjax.generateRequest();
        }
      },

      _randomImage: function () {
        var myRandomImages = [
          "https://yrpri6-production.s3.amazonaws.com/5X/aK/tG-retina.png",
          "https://yrpri6-production.s3.amazonaws.com/Fc/gy/To-retina.png",
          "https://yrpri6-production.s3.amazonaws.com/Tr/Sw/b9-retina.png",
          "https://yrpri6-production.s3.amazonaws.com/GX/sE/Ei-retina.png",
          "https://yrpri6-production.s3.amazonaws.com/Aa/aW/EQ-retina.png",
          "https://yrpri6-production.s3.amazonaws.com/eo/4w/k7-retina.png",
          "https://yrpri6-production.s3.amazonaws.com/J8/GN/KB-retina.png",
          "https://yrpri6-production.s3.amazonaws.com/rH/9W/Ih-retina.png",
          "https://yrpri6-production.s3.amazonaws.com/F5/0N/Gs-retina.png",
          "https://yrpri6-production.s3.amazonaws.com/vv/TJ/YP-retina.png",
          "https://yrpri6-production.s3.amazonaws.com/KW/Xp/nh-retina.png",
          "https://yrpri6-production.s3.amazonaws.com/Y4/M6/a8-retina.png",
          "https://yrpri6-production.s3.amazonaws.com/li/3l/Mv-retina.png"
        ];

        var randomNum = Math.floor(Math.random() * myRandomImages.length);
        return myRandomImages[randomNum];
      },

      _setupLocationsAndTranslation: function (budgetBallotItems) {
        var arrayLength = budgetBallotItems.length;
        for (var i = 0; i < arrayLength; i++) {
          if (budgetBallotItems[i].locations && budgetBallotItems[i].locations != "") {
            var hashArray = [];
            var locationsArray = budgetBallotItems[i].locations.replace(' ','').replace(/[\n\r]/g, '').split(',');
            var counter = 0;
            while (counter<locationsArray.length) {
              hashArray.push({ latitude: locationsArray[counter], longitude: locationsArray[counter+1]});
              counter+=2;
            }
            budgetBallotItems[i].locations = hashArray;
          } else {
            budgetBallotItems[i].locations = [];
          }
          // Set the localized translation
          budgetBallotItems[i].name =  budgetBallotItems[i]['name_'+this.language];
          budgetBallotItems[i].description =  budgetBallotItems[i]['description_'+this.language];

          if (budgetBallotItems[i].image_url && budgetBallotItems[i].image_url.indexOf('imgur') > -1) {
            //budgetBallotItems[i].image_url = this._randomImage();
          }
        }
        return _.shuffle(budgetBallotItems);
      },

      _ballotResponse: function (event, detail) {
        this.set('area', detail.response.area);
        this.set('budgetBallotItems', this._setupLocationsAndTranslation(detail.response.budget_ballot_items));
        var localizeMethod = this.__computeLocalize(this.language, this.resources, this.formats);
        this.fire('oav-set-title', localizeMethod('ballot_area_name', 'area_name', this.area.name));
        this.fire('oav-set-area', { areaName: this.area.name, totalBudget: this.area.budget_amount });
        this.async(function () {
          this.$$("#domRepeat").fire('iron-resize');
        }, 10);
      }
    })
  })();

</script>

</body></html>