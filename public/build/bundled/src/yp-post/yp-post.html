<html><head><meta charset="UTF-8"><link rel="import" href="../oav-app.html?v=6.1.35"></head><body><div hidden="" by-vulcanize=""><dom-module id="yp-post-actions" assetpath="/">

  <template>

    <style>
      :host {
        display: block;
      }

      .action-bar {
        @apply(--layout-horizontal);
        position: absolute;
        bottom: -36px;
        right: 0;
        padding-right: 28px;
        background-color: #FFF;
        margin-bottom: 16px;
      }

      .action-bar[floating] {
        @apply(--layout-horizontal);
        position: relative;
        background-color: #FFF;
      }

      .action-bar-small {
        @apply(--layout-horizontal);
        @apply(--layout-flex);
        margin-top: 8px;
        position: absolute;
        width: 100%;
        bottom: -32px;
        vertical-align: bottom !important;
      }

      .action-text {
        font-size: 18px;
        text-align: left;
        vertical-align: bottom;
        padding-top: 8px;
        margin-top: 4px;
      }

      .action-icon {
      }

      .action-up {
        @apply(--layout-horizontal);
        @apply(--layout-start-justified);
        color: var(--primary-up-color-lighter, rgba(0,153,0,0.55));
      }

      .action-down {
        @apply(--layout-horizontal);
        @apply(--layout-end-justified);
        color: var(--primary-down-color-lighter, rgba(153,0,0,0.55));
      }

      .love-up {
        color: var(--primary-love-color-up, rgba(50,50,50,0.45));
      }

      .love-down {
        color: var(--primary-love-color-up, rgba(50,50,50,0.45));
      }

      .love-up-selected {
        color: var(--primary-love-color-up, rgba(168,0,0,0.65));
      }

      .love-down-selected {
        color: var(--primary-love-color-up, rgba(0,0,0,0.70));
      }

      .action-debate {
        @apply(--layout-horizontal);
        @apply(--layout-flex);
        @apply(--layout-center-justified);
        color: var(--primary-color, #9E9E9E);
      }

      .debate-text {
        padding-top: 10px;
        padding-right: 12px;
        color: #9e9e9e;
      }

      .down-text {
        padding-right: 0px;
        padding-top: 10px;
      }

      .up-text {
        padding-top: 10px;
        margin-right: 8px;
      }

      .down-vote-icon {
        margin-right: 0px;
      }

      paper-icon-button.largeButton {
        width: 52px;
        height: 52px;
      }

      .debate-icon::shadow #icon {
        padding-bottom: 0px;
        margin-top: 4px;
        margin-right: 12px;
        padding-right: 8px;
        padding-left: 8px;
        width: 30px !important;
        height: 30px !important;
        color: #9e9e9e;
      }

      .shareIcon::shadow #icon {
        width: 32px !important;
        height: 32px !important;
        color: #999;
      }

      .shareIcon {
        margin-left: 16px;
        margin-top: 2px;
      }

      .up-vote-icon {
        margin-left: 8px;
      }

      @media (max-width: 320px) {
        :host {
          width: 250px;
        }
      }

      .shareButtonContainer {
        position: absolute;
        bottom: 55px;
        right: -32px;
        padding: 0;
        margin: 0;
        margin-bottom: 8px;
      }

      .shareButton {
        padding: 2px;
      }

      .shareShare {
        padding: 0;
        margin: 0;
        background-color: #FFF;
      }

      @media screen and (-ms-high-contrast: active), (-ms-high-contrast: none) {
        .action-debate {
          display: none;
        }
      }
    </style>

    <iron-media-query query="(max-width: 420px)" query-matches="{{small}}"></iron-media-query>

    <paper-material elevation="[[elevationPlusOne]]" floating$="[[floating]]" animated="" class="action-bar">
      <div id="actionUp" class="action-up">
        <paper-icon-button disabled="[[allDisabled]]" title$="[[t('post.up_vote')]]" icon$="[[endorseModeIcon(endorseMode,'up')]]" class="action-icon up-vote-icon largeButton" on-tap="upVote"></paper-icon-button>
        <div class="action-text up-text">{{formatNumber(post.counter_endorsements_up)}}</div>
      </div>

      <div class="action-debate layout vertical" hidden$="[[_hideDebate(small,forceSmall)]]">
        <paper-icon-button disabled="[[allDisabled]]" title$="[[t('post.debate')]]" icon="chat-bubble-outline" class="action-icon debate-icon largeButton" on-tap="_goToPostIfNotHeader"></paper-icon-button>
        <div class="action-text debate-text">{{formatNumber(post.counter_points)}}</div>
      </div>

      <div class="" hidden$="[[!_hideDebate(small,forceSmall)]]"></div>

      <div id="actionDown" class="action-down">
        <paper-icon-button disabled="[[allDisabled]]" title$="[[t('post.down_vote')]]" icon$="[[endorseModeIcon(endorseMode,'down')]]" class="action-icon down-vote-icon largeButton" on-tap="downVote"></paper-icon-button>
        <div class="action-text down-text">{{formatNumber(post.counter_endorsements_down)}}</div>
      </div>
    </paper-material>

  </template>
  <script>
    Polymer({
      is: 'yp-post-actions',

      behaviors: [
        Polymer.appHelpers,
        Polymer.AppLocalizeBehavior
      ],

      properties: {
        post: {
          type: Object,
          observer: '_onPostChanged'
        },

        small: {
          type: Boolean,
          value: false
        },

        headerMode: {
          type: Boolean,
          value: false
        },

        forceSmall: {
          type: Boolean,
          value: false
        },

        endorseMode: {
          type: String,
          value: 'love'
        },

        endorseValue: {
          type: Number,
          value: 0
        },

        elevation: {
          type: Number,
          value: 3
        },

        elevationPlusOne: {
          type: Number,
          computed: '_elevationPlusOne(elevation)'
        },

        allDisabled: {
          type: Boolean,
          value: true
        },

        floating: Boolean
      },

      _toggleShare: function () {
        this.set('showShareButtons', !this.showShareButtons);
      },

      _shareMouseOver: function () {
        this.set('showShareButtons', true);
      },

      _shareMouseOut: function () {
        this.async(function () {
          this.set('showShareButtons', false);
        },1200);
      },

      _elevationPlusOne: function (elevation) {
        if (elevation<5) {
          return elevation + 1;
        } else {
          return elevation;
        }
      },

      _hideDebate: function (small, forceSmall) {
        return (small || forceSmall)
      },

      _onPostChanged: function (newValue, oldValue) {
        if (newValue) {
          this._updateEndorsements();
        }
      },

      _updateEndorsements: function () {

      },

      endorseModeIcon: function (endorseMode, upDown) {
        if (endorseMode=='thumbs' && upDown=='up') {
          return 'thumb-up';
        } else if (endorseMode=='thumbs' && upDown=='down') {
          return 'thumb-down';
        } else if (endorseMode=='love' && upDown=='up') {
//          return 'favorite';
//          return 'favorite';
          return 'favorite';
        } else if (endorseMode=='love' && upDown=='down') {
          return 'do-not-disturb';
        } else if (endorseMode=='arrow' && upDown=='up') {
          return 'keyboard-arrow-down';
        } else if (endorseMode=='arrow' && upDown=='down') {
          return 'keyboard-arrow-up';
        }
      },

      _endorseResponse: function (event, detail) {
        this.set('allDisabled', false);
        var endorsement = detail.response.endorsement;
        var oldEndorsementValue = detail.response.oldEndorsementValue;
        this._setEndorsement(endorsement.value);
        window.appUser.updateEndorsementForPost(this.post.id, endorsement);
        if (oldEndorsementValue) {
          if (oldEndorsementValue>0)
            this.set('post.counter_endorsements_up', this.post.counter_endorsements_up-1);
          else if (oldEndorsementValue<0)
            this.set('post.counter_endorsements_down', this.post.counter_endorsements_down-1);
        }
        if (endorsement.value>0)
          this.set('post.counter_endorsements_up', this.post.counter_endorsements_up+1);
        else if (endorsement.value<0)
          this.set('post.counter_endorsements_down', this.post.counter_endorsements_down+1);
      },

      upVote: function (event) {
      },

      downVote: function (event) {
      },

      computeActionClass: function (small) {
        return small ? 'action-bar' : 'action-bar';
      },

      ready: function() {
        if (this.endorseMode) {
          this.$.actionDown.className += ' ' + 'love-down';
          this.$.actionUp.className += ' ' + 'love-up';
        }
      }
    });
  </script>
</dom-module>
<!--
Element for generating a Google Maps Street View Panorama.

##### Example

    <google-streetview-pano
      pano-id="CWskcsTEZBNXaD8gG-zATA"
      heading="330"
      pitch="-2"
      zoom="0.8"
      disable-default-ui>
    </google-streetview-pano>

There are tons of great panoramas on the [Google Maps | Views page](https://www.google.com/maps/views/home?gl=us)

To grab a panorama, look at its url in the address bar. For example:

google.com/maps/views/view/102684927602131521305/photo/**1szTnskrdKIAAAGuu3fZRw**

The hash in bold is the `pano-id`. You'll often need to dial in the `heading`, `pitch` and `zoom` manually.

You can also use the position attribute and set it to a position with a computed value. Example: { lat: 42.345573, lng: -71.098326 }

    <google-streetview-pano
      position="[[_myComputedPosition()]]"
      heading="330"
      pitch="-2"
      zoom="0.8"
      disable-default-ui>
    </google-streetview-pano>

@demo
-->

<dom-module id="google-streetview-pano" assetpath="../../bower_components/google-streetview-pano/">
  <style>
    :host {
      display: block;
    }
    #pano {
      height: 100%;
    }
  </style>
  <template>
    <google-maps-api api-key="{{apiKey}}" version="{{version}}" libraries="{{libraries}}" client-id="{{clientId}}" language="{{language}}" client="" on-api-load="_mapApiLoaded"></google-maps-api>
    <div id="pano" on-mouseenter="_autoStop" on-mouseleave="_autoUpdate"></div>
  </template>
</dom-module>

<script>
  "use strict";

  Polymer({

    is: 'google-streetview-pano',

    properties: {
      /**
       * A Maps API key. To obtain an API key, see developers.google.com/maps/documentation/javascript/tutorial#api_key.
       */
      apiKey: String,

      /**
       * A Maps API for Business Client ID. To obtain a Maps API for Business Client ID, see developers.google.com/maps/documentation/business/.
       * If set, a Client ID will take precedence over an API Key.
       */
      clientId: String,

      /**
       * The localized language to load the Maps API with. For more information
       * see https://developers.google.com/maps/documentation/javascript/basics#Language
       *
       * Note: the Maps API defaults to the preferred language setting of the browser.
       * Use this parameter to override that behavior.
       *
       */
      language: String,

      /**
       * A comma separated list (e.g. "places,geometry") of libraries to load
       * with this map. Defaults to "places". For more information see
       * https://developers.google.com/maps/documentation/javascript/libraries.
       *
       */
      libraries: {
        type: String,
        value: "places"
      },

      /**
       * Version of the Google Maps API to use.
       *
       */
      version: {
        type: String,
        value: '3.exp'
      },

      /**
       * Specifies which photosphere to load
       *
       *
       */
      panoId: {
        type: String,
        observer: '_panoIdChanged'
      },

      /**
       * Specifies which position to load
       *
       *
       */
      position: {
        type: Object,
        observer: '_positionChanged'
      },

      /**
       * The camera heading in degrees relative to true north. True north is 0°, east is 90°, south is 180°, west is 270°.
       */
      heading: {
        type: Number,
        value: 45
      },

      /**
       * The camera pitch in degrees, relative to the street view vehicle. Ranges from 90° (directly upwards) to -90° (directly downwards).
       */
      pitch: {
        type: Number,
        value: -2
      },

      /**
       * Sets the zoom level of the panorama. Fully zoomed-out is level 0, where the field of view is 180 degrees.
       */
      zoom: {
        type: Number,
        value: 1
      },

      /**
       * If true, disables all default UI.
       */
      disableDefaultUi: {
        type: Boolean,
        value: false
      },

      /**
       * If true, disables the auto panning animation
       */
      disableAutoPan: {
        type: Boolean,
        value: false
      }

    },

    pano: null,
    rAFid: null,

    /**
     * Called when the Google Maps API has loaded.
     */
    _mapApiLoaded: function() {
      this.async(function () {
        this.pano = new google.maps.StreetViewPanorama(this.$.pano, this._getPanoOptions());
        this.pano.setVisible(true);

        if (this.disableAutoPan) {
          return;
        }
        // Kickoff the rotating animation
        this.rAFid = requestAnimationFrame(this.update.bind(this));
      });
    },

    /**
     * Returns the an object with the current panorama configurations.
     */
    _getPanoOptions: function() {
      var panoOptions = {
        pano: this.panoId,
        position: this.position,
        pov: {
          heading: this.heading,
          pitch: this.pitch
        },
        disableDefaultUI: this.disableDefaultUi,
        zoom: this.zoom
      };

      return panoOptions;
    },

    /**
     * Fired every rAF. Updates the heading to create a slow pan effect
     * Will be canceled by mouse enter or calling stop()
     */
    update: function() {
      this.rAFid = requestAnimationFrame(this.update.bind(this));
      var pov = this.pano.getPov();
      pov.heading += 0.03;
      this.pano.setPov(pov);
    },

    _autoUpdate: function() {
      if (this.disableAutoPan) {
        return;
      }

      this.update();
    },

    /**
     * Reset the pov for the panorama.
     * @method reset
     */
    reset: function() {
      var pov = this.pano.getPov();
      pov.heading = this.heading;
      pov.pitch = this.pitch;
      this.pano.setPov(pov);
    },

    /**
     * Stop the animation when the element is detached
     * @method detached
     */
    detached: function () {
      this.stop();
    },
    
    /**
     * Cancel the slow panning animation.
     * @method stop
     */
    stop: function() {
      cancelAnimationFrame(this.rAFid);
    },

    _autoStop: function() {
      if (this.disableAutoPan) {
        return;
      }

      this.stop();
    },

    _panoIdChanged: function(newVal, oldVal) {
      if (this.pano) {
        this.pano.setPano(newVal);
        this.reset();
      }
    },

    _positionChanged: function(newVal, oldVal) {
      if (this.pano) {
        this.pano.setPosition(newVal);
        this.reset();
      }
    }
  });
</script>
<dom-module id="yp-post-cover-media" assetpath="/">

  <template>

    <style>
      :host {
        display: block;
      }

      google-streetview-pano {
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
      }

      google-map {
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
      }

      .main-image {
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
      }

      .mapCanvas {
        position: relative;
        width: 100%;
        height: 100%;
      }

      .category-icon {
        width: 200px;
        height: 200px;
        padding-top: 32px;
      }

      @media (max-width: 600px) {
        .category-icon {
          width: 160px;
          height: 160px;
        }
      }
    </style>

      <div class="mapCanvas">
        <template is="dom-if" if="[[noneActive]]">
          <iron-image sizing="cover" class="main-image" src="https://i.imgur.com/sdsFAoT.png"></iron-image>
        </template>

        <template is="dom-if" if="[[categoryActive]]">
          <div class="layout horizontal center-center">
            <iron-image class="category-icon" title="[[post.Category.name]]" sizing="contain" src$="[[getCategoryImagePath(post)]]"></iron-image>
          </div>
        </template>

        <template is="dom-if" if="[[imageActive]]">
          <iron-image sizing="cover" class="main-image" src="[[postImagePath()]]"></iron-image>
        </template>

        <template is="dom-if" if="[[streetViewActive]]" restamp="">
          <google-streetview-pano position="[[mapPosition]]" heading="330" api-key="AIzaSyDkF_kak8BVZA5zfp5R4xRnrX8HP3hjiL0" pitch="2" zoom="0.8" disable-default-ui="">
          </google-streetview-pano>
        </template>

        <template is="dom-if" if="[[mapActive]]" restamp="">
          <google-map id="coverMediaMap" class="map" libraries="places" fit-to-markers="" zoom="[[_zoomLevel(post)]]" map-type="[[_mapType(post)]]" api-key="AIzaSyDkF_kak8BVZA5zfp5R4xRnrX8HP3hjiL0">
            <google-map-marker latitude="[[latitude]]" longitude="[[longitude]]"></google-map-marker>
          </google-map>
        </template>
      </div>
    </template>


  <script>
    Polymer({
      is: 'yp-post-cover-media',

      behaviors: [
        Polymer.appHelpers
      ],

      properties: {

        post: {
          type: Object,
          notify: true,
          observer: "_postChanged"
        },

        noneActive: {
          type: Boolean,
          computed: '_isNoneActive(post)'
        },

        categoryActive: {
          type: Boolean,
          computed: '_isCategoryActive(post)'
        },

        imageActive: {
          type: Boolean,
          computed: '_isImageActive(post)'
        },

        mapActive: {
          type: Boolean,
          computed: '_isMapActive(post, post.location, post.location.latitude)'
        },

        streetViewActive: {
          type: Boolean,
          computed: '_isStreetViewActive(post, post.location, post.location.latitude)'
        },

        latitude: {
          type: Number,
          computed: '_getLatitute(post.location.latitude)'
        },

        longitude: {
          type: Number,
          computed: '_getLongitude(post.location.longitude)'
        },

        mapPosition: {
          type: Object,
          computed: '_getMapPosition(post.location)'
        }
      },

      _getLatitute: function (latitude) {
        if (latitude)
          return latitude;
        else
          return 0
      },

      _getLongitude: function (longitude) {
        if (longitude)
          return longitude;
        else
          return 0
      },

      _isNoneActive: function (post) {
        if (this._withCoverMediaType(post, 'none'))
          return true
        else
          return false
      },

      _isCategoryActive: function (post) {
        if (this._withCoverMediaType(post, 'category'))
          return true
        else
          return false
      },

      _isImageActive: function (post) {
        if (this._withCoverMediaType(post,'image'))
          return true
        else
          return false
      },

      _isMapActive: function (post, postLocation, lat) {
        if (lat && postLocation && this._withCoverMediaType(post,'map'))
          return true
        else
          return false
      },

      _isStreetViewActive: function (post, postLocation, lat) {
        if (lat && postLocation && this._withCoverMediaType(post,'streetView'))
          return true
        else
          return false
      },

      _postChanged: function(newValue, oldValue) {
        //debugger;
      },

      _zoomLevel: function (post) {
        if (post)
          return post.location.map_zoom;
        else
          return "10";
      },

      _mapType: function (post) {
        if (post && post.location)
          return post.location.mapType;
        else
          return null;
      },

      _withCoverMediaType: function (post, mediaType) {
        if (!post)
          return false;
        if (mediaType == 'none') {
          return (this.post && (!this.post.Category && (!this.post.cover_media_type || this.post.cover_media_type == 'none')));
        } else  if ((mediaType=='category' && this.post.Category) && (!this.post.cover_media_type || this.post.cover_media_type == 'none')) {
          return true;
        } else {
          return (this.post && this.post.cover_media_type == mediaType);
        }
      },

      _getMapPosition: function (location) {
        if (location) {
          return { lat: location.latitude, lng: location.longitude }
        } else {
          return { lat: 0, lng: 0 }
        }
      },

      postImagePath: function () {
        return this.getImageFormatUrl(this.post.PostHeaderImages, 0);
      },

      getCategoryImagePath: function (post) {
        if (post && post.Category && post.Category.CategoryIconImages) {
          return this.getImageFormatUrl(post.Category.CategoryIconImages, 0);
        } else {
          return "";
        }
      }
    });
  </script>
</dom-module>
<script>
  /**
   * @polymerBehavior YpPostBehavior
   */
  Polymer.YpPostBehavior = {

    properties: {
      post: {
        type: Object,
        notify: true
      },

      endorseMode: {
        type: String
      },

      image: {
        type: Boolean,
        value: true
      },

      elevation: {
        type: Number,
        value: 1
      }
    },

    postName: function (post) {
      if (post && post.name) {
        return this.truncate(this.trim(post.name), 100);
      } else if (post) {
        return post.short_name;
      } else {
        return "";
      }
    },

    postDescription: function (post) {
      if (post && post.description) {
        return this.truncate(this.trim(post.description), 500, '...');
      } else if (post && post.Points && post.Points[0]) {
        return  this.truncate(this.trim(post.Points[0].content), 500, '...');
      } else {
        return '';
      }
    },

    getCategoryImagePath: function (post) {
      if (post.Category && post.Category.CategoryIconImages) {
        return this.getImageFormatUrl(post.Category.CategoryIconImages, 0);
      } else {
        return "";
      }
    }
  }
</script>
<dom-module id="yp-post-card" assetpath="/">

  <template>

    <style include="iron-flex iron-flex-alignment">
      :host {
        color: #333;
      }

      .infoContainer {
        @apply(--layout-vertical);
        color: var(--primary-color-more-darker, #424242);
        line-height: var(--description-line-height, 1.3);
        width: 540px;
        padding: 0px;
        padding-bottom: 16px;
        padding-top: 16px;
      }

      .voting {
        @apply(--layout-horizontal);
        @apply(--layout-center);
        text-align: center;
        padding-left: 16px;
        padding-right: 24px;
      }

      .card-actions {
        position: absolute;
        bottom: 0;
        right: 42px;
        width: 420px;
      }

      .edit {
        color: #eee;
        position: absolute;
        top: 0;
        right: 0;
        padding-right: 0;
        margin-right: 0;
      }

      .post-name {
        margin: 0;
        font-size: 28px;
        background-color: var(--primary-color-600);
        color: #FFF;
        padding: 16px;
        cursor: pointer;
      }

      .category-icon {
        width: 100px;
        height: 100px;
      }

      .category-image-container {
        text-align: right;
        margin-top: -52px;
      }

      .postCardCursor {
        cursor: pointer;
      }

      yp-post-cover-media {
        position: relative;
        width: 420px;
        height: 232px;
      }

      .postCard {
        width: 960px;
        background-color: #fff;
        @apply(--layout-horizontal);
      }

      .description {
        padding-bottom: 2px;
        padding-left: 8px;
        padding-right: 8px;
      }

      paper-icon-button {
        position: absolute;
        top: 0;
        right: 0;
      }

      .post-name {
        background-color: var(--app-primary-color);
      }

      @media (max-width: 1024px) {
        :host {
          width: 600px;
        }

        .postCard {
          width: 580px;
          @apply(--layout-wrap);
        }

        yp-post-cover-media {
          width: 400px;
          height: 212px;
        }

        .voting {
          padding-left: 0;
          padding-right: 0;
        }

        .card-actions {
          left: 24px;
          right: 0;
          width: 320px;
        }

        .card-content {
          width: 600px !important;
          padding-bottom: 74px;
        }

        .infoContainer {
          width: 100%;
        }

        .description {
          padding-bottom: 32px;
        }

        .mediaAndInfoContainer {
          @apply(--layout-center-center);
        }
      }

        @media (max-width: 800px) {
          .post-name {
            font-size: 22px;
          }
        }

        @media (max-width: 420px) {
          :host {
            width: 280px;
          }

          .postCard {
            height: 100% !important;
            width: 280px !important;
          }

          yp-post-cover-media {
            width: 280px !important;
            height: 150px !important;
          }

          .card-actions {
            left: 0;
            width: 260px;
          }

          .post-name {
            font-size: 18px;
          }

          .description {
            font-size: 15px;
          }
        }

      @media (max-width: 320px) {
        :host {
          width: 240px;
        }

        .postCard {
          height: 100% !important;
          width: 240px !important;
        }

        yp-post-cover-media {
          width: 240px !important;
          height: 128px !important;
        }

        .card-actions {
          left: 0;
          width: 260px;
        }

        .post-name {
          font-size: 18px;
        }

        .description {
          font-size: 15px;
        }
      }

    </style>

    <template is="dom-if" if="[[post]]" restamp="">
      <div class="layout horizontal center-center">
        <paper-material class="postCard" elevation="[[elevation]]" animated="">
          <div class="layout vertical wrap">
            <h1 class="post-name" on-tap="goToPostIfNotHeader">[[postName(post)]]</h1>
            <div class="layout horizontal wrap mediaAndInfoContainer">
              <yp-post-cover-media post="[[post]]"></yp-post-cover-media>
              <div class="layout vertical">
                <div class="infoContainer">
                  <div class="description">[[trimmedDescription]]</div>
                </div>
                <div class="card-actions">
                  <yp-post-actions header-mode="[[headerMode]]" elevation="[[elevation]]" endorse-mode="[[endorseMode]]" class="voting" post="[[post]]"></yp-post-actions>
                </div>
              </div>
            </div>
          </div>
        </paper-material>
      </div>
    </template>
  </template>

  <script>
    Polymer({
      is: 'yp-post-card',

      behaviors: [
        Polymer.appHelpers,
        Polymer.YpPostBehavior
      ],

      properties: {

        selectedMenuItem: {
          type: String
        },

        headerMode: {
          type: Boolean,
          value: false
        },

        elevation: {
          type: Number,
          value: 2
        },

        post: {
          type: Object,
          notify: true
        },

        trimmedDescription: {
          type: String,
          computed: '_trimmedDescription(post, post.description)'
        }

      },


      _trimmedDescription: function (post, description) {
        if (post) {
          return this.postDescription(post);
        } else {
          return "";
        }
      },

      updateDescriptionIfEmpty: function (description) {
        if (!this.post.description || this.post.description=='') {
          this.set('post.description', description);
        }
      },

      _refresh: function () {
        this.fire('refresh');
      },

      _menuSelection: function (event, detail) {
        if (detail.item.id=="editMenuItem")
          this._openEdit();
        else if (detail.item.id=="deleteMenuItem")
          this._openDelete();
        else if (detail.item.id=="statusChangeMenuItem")
          this._openPostStatusChange();
        else if (detail.item.id=="moveMenuItem")
          this._openMovePost();
        this.selectedMenuItem = null;
      }

    });
  </script>
</dom-module>
<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
--><!--
`iron-autogrow-textarea` is an element containing a textarea that grows in height as more
lines of input are entered. Unless an explicit height or the `maxRows` property is set, it will
never scroll.

Example:

    <iron-autogrow-textarea></iron-autogrow-textarea>

### Styling

The following custom properties and mixins are available for styling:

Custom property | Description | Default
----------------|-------------|----------
`--iron-autogrow-textarea` | Mixin applied to the textarea | `{}`
`--iron-autogrow-textarea-placeholder` | Mixin applied to the textarea placeholder | `{}`

@group Iron Elements
@hero hero.svg
@demo demo/index.html
-->

<dom-module id="iron-autogrow-textarea" assetpath="../../bower_components/iron-autogrow-textarea/">
  <template>
    <style>
      :host {
        display: inline-block;
        position: relative;
        width: 400px;
        border: 1px solid;
        padding: 2px;
        -moz-appearance: textarea;
        -webkit-appearance: textarea;
        overflow: hidden;
      }

      .mirror-text {
        visibility: hidden;
        word-wrap: break-word;
      }

      .fit {
        @apply(--layout-fit);
      }

      textarea {
        position: relative;
        outline: none;
        border: none;
        resize: none;
        background: inherit;
        color: inherit;
        /* see comments in template */
        width: 100%;
        height: 100%;
        font-size: inherit;
        font-family: inherit;
        line-height: inherit;
        text-align: inherit;
        @apply(--iron-autogrow-textarea);
      }

      ::content textarea:invalid {
        box-shadow: none;
      }

      textarea::-webkit-input-placeholder {
        @apply(--iron-autogrow-textarea-placeholder);
      }

      textarea:-moz-placeholder {
        @apply(--iron-autogrow-textarea-placeholder);
      }

      textarea::-moz-placeholder {
        @apply(--iron-autogrow-textarea-placeholder);
      }

      textarea:-ms-input-placeholder {
        @apply(--iron-autogrow-textarea-placeholder);
      }
    </style>

    <!-- the mirror sizes the input/textarea so it grows with typing -->
    <!-- use &#160; instead &nbsp; of to allow this element to be used in XHTML -->
    <div id="mirror" class="mirror-text" aria-hidden="true">&nbsp;</div>

    <!-- size the input/textarea with a div, because the textarea has intrinsic size in ff -->
    <div class="textarea-container fit">
      <textarea id="textarea" name$="[[name]]" autocomplete$="[[autocomplete]]" autofocus$="[[autofocus]]" inputmode$="[[inputmode]]" placeholder$="[[placeholder]]" readonly$="[[readonly]]" required$="[[required]]" disabled$="[[disabled]]" rows$="[[rows]]" minlength$="[[minlength]]" maxlength$="[[maxlength]]"></textarea>
    </div>
  </template>
</dom-module>

<script>

  Polymer({

    is: 'iron-autogrow-textarea',

    behaviors: [
      Polymer.IronFormElementBehavior,
      Polymer.IronValidatableBehavior,
      Polymer.IronControlState
    ],

    properties: {

      /**
       * Use this property instead of `value` for two-way data binding.
       * This property will be deprecated in the future. Use `value` instead.
       * @type {string|number}
       */
      bindValue: {
        observer: '_bindValueChanged',
        type: String
      },

      /**
       * The initial number of rows.
       *
       * @attribute rows
       * @type number
       * @default 1
       */
      rows: {
        type: Number,
        value: 1,
        observer: '_updateCached'
      },

      /**
       * The maximum number of rows this element can grow to until it
       * scrolls. 0 means no maximum.
       *
       * @attribute maxRows
       * @type number
       * @default 0
       */
      maxRows: {
       type: Number,
       value: 0,
       observer: '_updateCached'
      },

      /**
       * Bound to the textarea's `autocomplete` attribute.
       */
      autocomplete: {
        type: String,
        value: 'off'
      },

      /**
       * Bound to the textarea's `autofocus` attribute.
       */
      autofocus: {
        type: Boolean,
        value: false
      },

      /**
       * Bound to the textarea's `inputmode` attribute.
       */
      inputmode: {
        type: String
      },

      /**
       * Bound to the textarea's `placeholder` attribute.
       */
      placeholder: {
        type: String
      },

      /**
       * Bound to the textarea's `readonly` attribute.
       */
      readonly: {
        type: String
      },

      /**
       * Set to true to mark the textarea as required.
       */
      required: {
        type: Boolean
      },

      /**
       * The minimum length of the input value.
       */
      minlength: {
        type: Number
      },

      /**
       * The maximum length of the input value.
       */
      maxlength: {
        type: Number
      }

    },

    listeners: {
      'input': '_onInput'
    },

    observers: [
      '_onValueChanged(value)'
    ],

    /**
     * Returns the underlying textarea.
     * @type HTMLTextAreaElement
     */
    get textarea() {
      return this.$.textarea;
    },

    /**
     * Returns textarea's selection start.
     * @type Number
     */
    get selectionStart() {
      return this.$.textarea.selectionStart;
    },

    /**
     * Returns textarea's selection end.
     * @type Number
     */
    get selectionEnd() {
      return this.$.textarea.selectionEnd;
    },

    /**
     * Sets the textarea's selection start.
     */
    set selectionStart(value) {
      this.$.textarea.selectionStart = value;
    },

    /**
     * Sets the textarea's selection end.
     */
    set selectionEnd(value) {
      this.$.textarea.selectionEnd = value;
    },

    attached: function() {
      /* iOS has an arbitrary left margin of 3px that isn't present
       * in any other browser, and means that the paper-textarea's cursor
       * overlaps the label.
       * See https://github.com/PolymerElements/paper-input/issues/468.
       */
      var IS_IOS = navigator.userAgent.match(/iP(?:[oa]d|hone)/);
      if (IS_IOS) {
        this.$.textarea.style.marginLeft = '-3px';
      }
    },

    /**
     * Returns true if `value` is valid. The validator provided in `validator`
     * will be used first, if it exists; otherwise, the `textarea`'s validity
     * is used.
     * @return {boolean} True if the value is valid.
     */
    validate: function() {
      // Empty, non-required input is valid.
      if (!this.required && this.value == '') {
        this.invalid = false;
        return true;
      }

      var valid;
      if (this.hasValidator()) {
        valid = Polymer.IronValidatableBehavior.validate.call(this, this.value);
      } else {
        valid = this.$.textarea.validity.valid;
        this.invalid = !valid;
      }
      this.fire('iron-input-validate');
      return valid;
    },

    _bindValueChanged: function() {
      var textarea = this.textarea;
      if (!textarea) {
        return;
      }

      // If the bindValue changed manually, then we need to also update
      // the underlying textarea's value. Otherwise this change was probably
      // generated from the _onInput handler, and the two values are already
      // the same.
      if (textarea.value !== this.bindValue) {
        textarea.value = !(this.bindValue || this.bindValue === 0) ? '' : this.bindValue;
      }

      this.value = this.bindValue;
      this.$.mirror.innerHTML = this._valueForMirror();
      // manually notify because we don't want to notify until after setting value
      this.fire('bind-value-changed', {value: this.bindValue});
    },

    _onInput: function(event) {
      this.bindValue = event.path ? event.path[0].value : event.target.value;
    },

    _constrain: function(tokens) {
      var _tokens;
      tokens = tokens || [''];
      // Enforce the min and max heights for a multiline input to avoid measurement
      if (this.maxRows > 0 && tokens.length > this.maxRows) {
        _tokens = tokens.slice(0, this.maxRows);
      } else {
        _tokens = tokens.slice(0);
      }
      while (this.rows > 0 && _tokens.length < this.rows) {
        _tokens.push('');
      }
      // Use &#160; instead &nbsp; of to allow this element to be used in XHTML.
      return _tokens.join('<br/>') + '&#160;';
    },

    _valueForMirror: function() {
      var input = this.textarea;
      if (!input) {
        return;
      }
      this.tokens = (input && input.value) ? input.value.replace(/&/gm, '&amp;').replace(/"/gm, '&quot;').replace(/'/gm, '&#39;').replace(/</gm, '&lt;').replace(/>/gm, '&gt;').split('\n') : [''];
      return this._constrain(this.tokens);
    },

    _updateCached: function() {
      this.$.mirror.innerHTML = this._constrain(this.tokens);
    },

    _onValueChanged: function() {
      this.bindValue = this.value;
    }
  });
</script>
<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
--><!--
`<paper-textarea>` is a multi-line text field with Material Design styling.

    <paper-textarea label="Textarea label"></paper-textarea>

See `Polymer.PaperInputBehavior` for more API docs.

### Validation

Currently only `required` and `maxlength` validation is supported.

### Styling

See `Polymer.PaperInputContainer` for a list of custom properties used to
style this element.
-->

<dom-module id="paper-textarea" assetpath="../../bower_components/paper-input/">
  <template>
    <style>
      :host {
        display: block;
      }

      :host([hidden]) {
        display: none !important;
      }

      label {
        pointer-events: none;
      }
    </style>

    <paper-input-container no-label-float$="[[noLabelFloat]]" always-float-label="[[_computeAlwaysFloatLabel(alwaysFloatLabel,placeholder)]]" auto-validate$="[[autoValidate]]" disabled$="[[disabled]]" invalid="[[invalid]]">

      <label hidden$="[[!label]]" aria-hidden="true">[[label]]</label>

      <iron-autogrow-textarea id="input" class="paper-input-input" bind-value="{{value}}" invalid="{{invalid}}" validator$="[[validator]]" disabled$="[[disabled]]" autocomplete$="[[autocomplete]]" autofocus$="[[autofocus]]" inputmode$="[[inputmode]]" name$="[[name]]" placeholder$="[[placeholder]]" readonly$="[[readonly]]" required$="[[required]]" minlength$="[[minlength]]" maxlength$="[[maxlength]]" autocapitalize$="[[autocapitalize]]" rows$="[[rows]]" max-rows$="[[maxRows]]" on-change="_onChange"></iron-autogrow-textarea>

      <template is="dom-if" if="[[errorMessage]]">
        <paper-input-error>[[errorMessage]]</paper-input-error>
      </template>

      <template is="dom-if" if="[[charCounter]]">
        <paper-input-char-counter></paper-input-char-counter>
      </template>

    </paper-input-container>
  </template>
</dom-module>

<script>
  Polymer({
    is: 'paper-textarea',

    behaviors: [
      Polymer.PaperInputBehavior,
      Polymer.IronFormElementBehavior
    ],

    properties: {
      _ariaLabelledBy: {
        observer: '_ariaLabelledByChanged',
        type: String
      },

      _ariaDescribedBy: {
        observer: '_ariaDescribedByChanged',
        type: String
      },

      /**
       * The initial number of rows.
       *
       * @attribute rows
       * @type number
       * @default 1
       */
      rows: {
        type: Number,
        value: 1
      },

      /**
       * The maximum number of rows this element can grow to until it
       * scrolls. 0 means no maximum.
       *
       * @attribute maxRows
       * @type number
       * @default 0
       */
      maxRows: {
       type: Number,
       value: 0
      }
    },

    _ariaLabelledByChanged: function(ariaLabelledBy) {
      this.$.input.textarea.setAttribute('aria-labelledby', ariaLabelledBy);
    },

    _ariaDescribedByChanged: function(ariaDescribedBy) {
      this.$.input.textarea.setAttribute('aria-describedby', ariaDescribedBy);
    },

    get _focusableElement() {
      return this.$.input.textarea;
    },
  });
</script>
<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
--><!--
Material design: [Cards](https://www.google.com/design/spec/components/cards.html)

`paper-card` is a container with a drop shadow.

Example:

    <paper-card heading="Card Title">
      <div class="card-content">Some content</div>
      <div class="card-actions">
        <paper-button>Some action</paper-button>
      </div>
    </paper-card>

Example - top card image:

    <paper-card heading="Card Title" image="/path/to/image.png" alt="image">
      ...
    </paper-card>

### Accessibility

By default, the `aria-label` will be set to the value of the `heading` attribute.

### Styling

The following custom properties and mixins are available for styling:

Custom property | Description | Default
----------------|-------------|----------
`--paper-card-background-color` | The background color of the card | `--primary-background-color`
`--paper-card-header-color` | The color of the header text | `#000`
`--paper-card-header` | Mixin applied to the card header section | `{}`
`--paper-card-header-text` | Mixin applied to the title in the card header section | `{}`
`--paper-card-header-image` | Mixin applied to the image in the card header section | `{}`
`--paper-card-header-image-text` | Mixin applied to the text overlapping the image in the card header section | `{}`
`--paper-card-content` | Mixin applied to the card content section| `{}`
`--paper-card-actions` | Mixin applied to the card action section | `{}`
`--paper-card` | Mixin applied to the card | `{}`

@group Paper Elements
@element paper-card
@demo demo/index.html
-->

<dom-module id="paper-card" assetpath="../../bower_components/paper-card/">
  <template>
    <style include="paper-material">
      :host {
        display: inline-block;
        position: relative;
        box-sizing: border-box;
        background-color: var(--paper-card-background-color, --primary-background-color);
        border-radius: 2px;

        @apply(--paper-font-common-base);
        @apply(--paper-card);
      }

      /* IE 10 support for HTML5 hidden attr */
      [hidden] {
        display: none !important;
      }

      .header {
        position: relative;
        border-top-left-radius: inherit;
        border-top-right-radius: inherit;
        overflow: hidden;

        @apply(--paper-card-header);
      }

      .header iron-image {
        display: block;
        width: 100%;
        --iron-image-width: 100%;
        pointer-events: none;

        @apply(--paper-card-header-image);
      }

      .header .title-text {
        padding: 16px;
        font-size: 24px;
        font-weight: 400;
        color: var(--paper-card-header-color, #000);

        @apply(--paper-card-header-text);
      }

      .header .title-text.over-image {
        position: absolute;
        bottom: 0px;

        @apply(--paper-card-header-image-text);
      }

      :host ::content .card-content {
        padding: 16px;
        position:relative;

        @apply(--paper-card-content);
      }

      :host ::content .card-actions {
        border-top: 1px solid #e8e8e8;
        padding: 5px 16px;
        position:relative;

        @apply(--paper-card-actions);
      }
    </style>

    <div class="header">
      <iron-image hidden$="[[!image]]" aria-hidden$="[[_isHidden(image)]]" src="[[image]]" alt="[[alt]]" placeholder="[[placeholderImage]]" preload="[[preloadImage]]" fade="[[fadeImage]]"></iron-image>
      <div hidden$="[[!heading]]" class$="title-text [[_computeHeadingClass(image)]]">[[heading]]</div>
    </div>

    <content></content>
  </template>

  <script>
    Polymer({
      is: 'paper-card',

      properties: {
        /**
         * The title of the card.
         */
        heading: {
          type: String,
          value: '',
          observer: '_headingChanged'
        },

        /**
         * The url of the title image of the card.
         */
        image: {
          type: String,
          value: ''
        },

        /**
         * The text alternative of the card's title image.
         */
        alt: {
          type: String
        },

        /**
         * When `true`, any change to the image url property will cause the
         * `placeholder` image to be shown until the image is fully rendered.
         */
        preloadImage: {
          type: Boolean,
          value: false
        },

        /**
         * When `preloadImage` is true, setting `fadeImage` to true will cause the
         * image to fade into place.
         */
        fadeImage: {
          type: Boolean,
          value: false
        },

        /**
         * This image will be used as a background/placeholder until the src image has
         * loaded. Use of a data-URI for placeholder is encouraged for instant rendering.
         */
        placeholderImage: {
          type: String,
          value: null
        },

        /**
         * The z-depth of the card, from 0-5.
         */
        elevation: {
          type: Number,
          value: 1,
          reflectToAttribute: true
        },

        /**
         * Set this to true to animate the card shadow when setting a new
         * `z` value.
         */
        animatedShadow: {
          type: Boolean,
          value: false
        },

        /**
         * Read-only property used to pass down the `animatedShadow` value to
         * the underlying paper-material style (since they have different names).
         */
        animated: {
          type: Boolean,
          reflectToAttribute: true,
          readOnly: true,
          computed: '_computeAnimated(animatedShadow)'
        }
      },
      
      /**
       * Format function for aria-hidden. Use the ! operator results in the
       * empty string when given a falsy value.
       */
      _isHidden: function(image) {
        return image ? 'false' : 'true';
      },

      _headingChanged: function(heading) {
        var currentHeading = this.getAttribute('heading'),
            currentLabel = this.getAttribute('aria-label');

        if (typeof currentLabel !== 'string' || currentLabel === currentHeading) {
          this.setAttribute('aria-label', heading);
        }
      },

      _computeHeadingClass: function(image) {
        return image ? ' over-image' : '';
      },

      _computeAnimated: function(animatedShadow) {
        return animatedShadow;
      }
    });
  </script>
</dom-module>
<dom-module id="yp-user-image" assetpath="../yp-user/">
  <template>
    <style>
      iron-image {
        display: block;
        vertical-align: text-top;
        height: 48px;
        width: 48px;
      }

      .small {
        height: 30px;
        width: 30px;
        background-color: var(--primary-color-lighter,#434343);
      }

      .large {
        height: 90px;
        width: 90px;
        background-color: var(--primary-color-lighter,#434343);
      }

      .veryLarge {
        height: 200px;
        width: 200px;
        background-color: var(--primary-color-lighter,#434343);
      }

      .medium {
        height: 48px;
        width: 48px;
        background-color: var(--primary-color-lighter,#434343);
      }

      .rounded {
        -webkit-border-radius: 25px;
        -moz-border-radius: 25px;
        border-radius: 25px;
        display: block;
      }

      .rounded-more {
        -webkit-border-radius: 50px;
        -moz-border-radius: 50px;
        border-radius: 50px;
        display: block;
        vertical-align: top;
        align: top;
      }

      .rounded-even-more {
        -webkit-border-radius: 115px;
        -moz-border-radius: 125px;
        border-radius: 125px;
        display: block;
        vertical-align: top;
        align: top;
      }

      .rounded img { opacity: 0; }

      .rounded-more img { opacity: 0; }

    </style>

    <template restamp="" is="dom-if" if="[[user]]">
      <template is="dom-if" if="[[profileImageUrl]]">
        <iron-image sizing="cover" title="[[userTitle]]" preload="" src="[[profileImageUrl]]" class$="[[computeClass(small)]]"></iron-image>
      </template>

      <template is="dom-if" if="[[!profileImageUrl]]">
        <template is="dom-if" if="[[user.facebook_id]]">
          <iron-image sizing="cover" title="[[userTitle]]" preload="" src$="[[computeFacebookSrc(user)]]" class$="[[computeClass(small)]]"></iron-image>
        </template>

        <template is="dom-if" if="[[!noDefault]]">
          <template is="dom-if" if="[[!user.facebook_id]]">
            <iron-image sizing="cover" title="[[userTitle]]" preload="" src="https://s3.amazonaws.com/better-reykjavik-paperclip-production/instances/buddy_icons/000/000/001/icon_50/default_profile.png" class$="[[computeClass(small)]]"></iron-image>
          </template>
        </template>

      </template>

    </template>
  </template>

  <script>
    Polymer({

      is: 'yp-user-image',

      behaviors: [
        Polymer.appHelpers
      ],

      properties: {
        small: {
          type: Boolean,
          value: false
        },

        large: {
          type: Boolean,
          value: false
        },

        veryLarge: {
          type: Boolean,
          value: false
        },

        titleFromUser: {
          type: String
        },

        userTitle: {
          type: String,
          computed: '_computeUserTitle(user, title)'
        },

        user: {
          type: Object,
          observer: "_userChanged"
        },

        profileImageUrl: {
          type: String,
          value: null
        },

        noDefault: {
          type: Boolean,
          value: false
        }
      },

      _computeUserTitle: function (user, titleFromUser) {
        if (title) {
          return title;
        } else {
          return user.name;
        }
      },

      _userChanged: function (newUser, oldValue) {
        if (newUser && newUser.UserProfileImages && newUser.UserProfileImages.length > 0) {
          var formatUrl = this.getImageFormatUrl(newUser.UserProfileImages, 0);
          if (formatUrl && formatUrl!="")
            this.set('profileImageUrl', formatUrl);
        }
      },

      computeIf: function (user) {
        return false && !user.facebook_id && user.buddy_icon_file_name;
      },

      computeClass: function (small) {
        if (this.small)
          return 'small rounded';
        else if (this.large)
          return 'large rounded-more';
        else if (this.veryLarge)
          return 'veryLarge rounded-even-more';
        else
          return 'medium rounded';
      },

      computeFacebookSrc: function (user) {
        if (user) {
          return 'https://graph.facebook.com/' + user.facebook_id + '/picture';
        } else {
          console.warn("Can't find user for computeFacebookSrc");
          return "";
        }
      },

      usePlaceHolderImage: function (user) {
        (this.profileImageUrl==null && user.facebook_id==null)
      },

      ready: function () {
      }
    });
  </script>
</dom-module>
<dom-module id="yp-user-with-organization" assetpath="../yp-user/">
  <template>
    <style include="iron-flex iron-flex-alignment">
      yp-user-image {
        padding-right: 16px;
        padding-left: 16px;
      }

      .name {
        padding-top: 4px;
        color: #fff;
        font-weight: bold;
        text-align: right;
      }

      .name[inverted] {
        color: #444;
      }

      .imageStatus {
        padding-left: 16px;
      }

      .rousnded {
        -webkit-border-radius: 25px;
        -moz-border-radius: 25px;
        border-radius: 25px;
        display: block;
      }

      .organizationName {
        color: #eee;
        text-align: right;
      }

      .organizationName[inverted] {
        color: #666;
      }

    </style>

    <template is="dom-if" if="[[user]]">
      <div class="layout horizontal" title="[[userTitle]]">
        <div class="layout vertical">
        <div class="name" inverted$="[[inverted]]">
          [[user.name]]
        </div>
        <div class="organizationName" inverted$="[[inverted]]" hidden$="[[!_organizationName(user)]]">
          [[_organizationName(user)]]
        </div>
      </div>
      <template is="dom-if" if="[[_organizationImageUrl(user)]]">
        <img sizing="cover" class="imageStatus rounded" src$="[[_organizationImageUrl(user)]]">
      </template>
      <yp-user-image titlefromuser="[[userTitle]]" user="[[user]]"></yp-user-image>
      </div>
    </template>
  </template>

  <script>
    Polymer({

      is: 'yp-user-with-organization',

      behaviors: [
        Polymer.appHelpers
      ],

      properties: {
        user: {
          type: Object
        },

        titleDate: {
          type: Date
        },

        userTitle: {
          type: String,
          computed: '_computeUserTitle(user, titleDate)'
        },

        inverted: {
          type: Boolean,
          value: false
        }
      },

      _computeUserTitle: function (user, titleDate) {
        return user.name + ' ' + moment(titleDate).fromNow();
      },

      _organizationName: function (user) {
        if (user.OrganizationUsers && user.OrganizationUsers.length > 0 && user.OrganizationUsers[0].name) {
          return user.OrganizationUsers[0].name;
        } else {
          return null;
        }
      },

      _organizationImageUrl: function (user) {
        if (user.OrganizationUsers && user.OrganizationUsers.length > 0 &&
          user.OrganizationUsers[0].OrganizationLogoImages &&
          user.OrganizationUsers[0].OrganizationLogoImages.length > 0) {
          var url = this.getImageFormatUrl(user.OrganizationUsers[0].OrganizationLogoImages, 2);
          return url;
        } else {
          return null;
        }
      }
    });
  </script>
</dom-module>
<dom-module id="yp-point-actions" assetpath="../yp-point/">

  <template>
    <style include="iron-flex iron-flex-alignment">
      :host {
        @apply(--layout-horizontal);
      }

      .action-text {
        font-size: 12px;
        padding-top: 12px;
      }

      .action-up {
        @apply(--layout-horizontal);
      }

      .action-down {
        @apply(--layout-horizontal);
      }

      .up-selected {
        color: #444;
      }

      .down-selected {
        color: #444;
      }

      .middle {
        @apply(--layout-horizontal);
        @apply(--layout-flex);
        @apply(--layout-center-justified);
      }

      .all-actions {
        @apply(--layout-horizontal);
        @apply(--layout-flex);
        @apply(--layout-start-justified);
        color: #aaa;
      }

      .myButton {
      --paper-icon-button {
        width: 10px;
        height: 10px;
      }
      }
    </style>

    <div class="all-actions" hidden$="[[hideNotHelpful]]">
      <div id="actionUp" class="actionUp layout horizontal">
        <paper-icon-button disabled="[[allDisabled]]" icon="arrow-upward" class="point-up-vote-icon myButton" on-tap="pointHelpful"></paper-icon-button>
        <div class="action-text action-up">{{point.counter_quality_up}}</div>
      </div>
      <div id="actionDown" class="actionDown layout horizontal">
        <paper-icon-button disabled="[[allDisabled]]" icon="arrow-downward" class="point-down-vote-icon myButton" on-tap="pointNotHelpful"></paper-icon-button>
        <div class="action-text">{{point.counter_quality_down}}</div>
      </div>
    </div>

  </template>
  <script>
    Polymer({
      is: 'yp-point-actions',

      behaviors: [
        Polymer.appHelpers
      ],

      properties: {
        point: {
          type: Object,
          observer: "_onPointChanged"
        },

        hideNotHelpful: {
          type: Boolean,
          value: false
        },

        pointQualityValue: {
          type: Number,
          value: 0
        },

        allDisabled: {
          type: Boolean,
          value: true
        }
      },

      observers: [
        '_qualityChanged(point.counter_quality_up, point.counter_quality_down)'
      ],

      _onPointChanged: function (newValue, oldValue) {
      },

      _updateQualitiesFromSignal: function () {
      },

      _updateQualities: function () {
      },

      _qualityChanged: function (a, b) {
        // TODO: Fix where you can't vote up a newstory just after posting
        //this._resetClasses();
      },

      _resetClasses: function () {
        if (this.pointQualityValue > 0) {
          this.$.actionUp.className += " " + "up-selected";
          this.removeClass(this.$.actionDown, "down-selected");
        } else if (this.pointQualityValue < 0) {
          this.$.actionDown.className += " " + "down-selected";
          this.removeClass(this.$.actionUp,"up-selected");
        } else {
          this.removeClass(this.$.actionUp,"up-selected");
          this.removeClass(this.$.actionDown, "down-selected");
        }
      },

      _setPointQuality: function (value) {
        this.set('pointQualityValue', value);
        this._resetClasses();
      },

      _pointQualityResponse: function (event, detail) {
        this.set('allDisabled', false);
        var pointQuality = detail.response.pointQuality;
        var oldPointQualityValue = detail.response.oldPointQualityValue;
        this._setPointQuality(pointQuality.value);
        window.appUser.updatePointQualityForPost(this.point.id, pointQuality);
        if (oldPointQualityValue) {
          if (oldPointQualityValue>0)
            this.set('point.counter_quality_up', this.point.counter_quality_up-1);
          else if (oldPointQualityValue<0)
            this.set('point.counter_quality_down', this.point.counter_quality_down-1);
        }
        if (pointQuality.value>0)
          this.set('point.counter_quality_up', this.point.counter_quality_up+1);
        else if (pointQuality.value<0)
          this.set('point.counter_quality_down', this.point.counter_quality_down+1)
      }
    });
  </script>
</dom-module>
<dom-module id="yp-point" assetpath="../yp-point/">

  <template>

    <style include="iron-flex iron-flex-alignment">
      :host {
        display: block;
        @apply(--layout-vertical);
      }


      .point-content {
        @apply(--layout-vertical);
        padding-right: 16px;
        padding-left: 16px;
      }


      @media (max-width: 320px) {
        .user-image {
          display: none;
        }
      }

      .userInfoContainer {
        border-bottom: solid 2px;
        width: 100%;
        padding-bottom: 16px;
        margin-bottom: 16px;
      }

      .userInfoContainer[up-vote] {
        border-bottom-color:  var(--master-point-up-color, #090);
      }

      .userInfoContainer[down-vote] {
        border-bottom-color: var(--master-point-down-color, #900);
      }

    </style>

    <template is="dom-if" if="[[point]]">

      <div class="layout vertical">

        <div class="userInfoContainer layout horizontal end-justified" up-vote$="[[upVote(point)]]" down-vote$="[[downVote(point)]]" hidden$="[[hideUser]]">
          <yp-user-with-organization title-date="[[point.created_at]]" inverted="" user="[[user]]"></yp-user-with-organization>
        </div>

        <div class="point-content">
          <span hidden$="[[!point.name]]">
            <span>[[point.name]]</span>.
          </span>
          <span>[[point.content]]</span>
          <div class="layout horizontal">
            <yp-point-actions point="[[point]]"></yp-point-actions>
          </div>
        </div>

      </div>

    </template>
  </template>

  <script>
    Polymer({

      is: 'yp-point',

      properties: {

        point: {
          type: Object,
          notify: true,
          observer: "_pointChanged"
        },



        user: {
          type: Object,
          value: null
        },

        hideUser: {
          type: Boolean,
          value: false
        }
      },

      _pointChanged: function(newValue, oldValue) {
        if (newValue) {
          this.user = this.point.User;
        } else {
          this.user = null;
        }
      },

      loginName: function () {
        return this.point.PointRevisions[0].User.name;
      },

      upVote: function(point) {
        if (point) {
          if (point.value == 0) {
            return true;
          } else {
            return point.value>0;
          }
        } else {
          console.warn("Can't find point for upVote");
          return false;
        }
      },

      downVote: function(point) {
        if (point) {
          if (point.value == 0) {
            return true;
          } else {
            return point.value<0;
          }
        } else {
          console.warn("Can't find point for upVote");
          return false;
        }
      },

      computeClass: function (point) {
        var ret = 'description ';
        if (point) {
          if (point.value>0)
            ret += 'for';
          else
            ret += 'against';
          return ret;
        } else {
          console.warn("Can't find point for upVote");
          return ret;
        }
      }
    });
  </script>
</dom-module>
<dom-module id="yp-post-points" assetpath="/">
  <template>
    <style>

      :host {
        height: 100%;
      }

      .main-container {
        @apply(--layout-horizontal);
        @apply(--layout-flex);
        background-color: #e0e0e0;
      }

      .point {
        padding-top: 32px;
        padding-bottom: 32px;
        padding-left: 24px;
        padding-right: 24px;
        @apply(--layout-vertical);
      }

      .pointText {
        margin-bottom: 0px;
        padding: 0px;
        width: 420px;
      }

      @media only screen and (min-device-width : 768px) and (max-device-width : 1024px)  {
        .pointText {
          max-height: 160px;
          min-height: 160px;
        }
      }

      paper-toast {
        z-index: 9999;
      }

      paper-material {
        background-color: #fff;
      }

      yp-point {
        padding-top: 8px;
      }

      .pointMaterial {
        margin-bottom: 18px;
        padding-top: 8px;
        background-color: #FFF;
        padding-left: 0;
        padding-right: 0;
        width: 430px;
      }

      .thumbIcon {
        height: 64px;
        width: 64px;
        padding-bottom: 16px;
        color: var(--primary-color);
      }

      .editIcon {
        height: 28px;
        width: 28px;
        padding-bottom: 16px;
        color: var(--primary-color);
      }

      paper-fab::shadow #icon {
        background-color: var(--accent-color);
        color: #FFF;
      }

      paper-fab {
        background-color: var(--accent-color);
        color: #FFF;
      }

      .addPointFab {
        width: 100%;
        color: #FFF;
      }

      paper-textarea {
        --paper-input-container-label: {
          font-size: 30px;
          height: 50px;
          overflow: visible;
        }
      }

      .howToWriteInfoText {
        padding-top: 4px;
        color: var(--primary-color);
      }

      .point .main-container .topContainer {
        background-color: var(--primary-background-color) !important;
      }

      .penContainer {
        margin-top: 42px;
      }

      .upOrDown {
        margin-top: 72px;
      }

      paper-radio-button {
        --paper-radio-button-checked-color: var(--accent-color) !important;
        font-size: 16px;
      }

      #pointUpOrDownMaterial {
        margin-top: 16px;
      }

      .mobileFab {
        margin-top: 8px;
      }

      paper-button {
        color: #FFF;
        background-color: var(--accent-color);
      }

      @media (max-width: 985px) {
        .pointText {
          width: 420px;
          font-size: 30px;
        }
      }

      @media (max-width: 600px) {
        .pointText {
          width: 310px;
          font-size: 9px;
        }

        .pointMaterial {
          width: 300px;
        }

        .main-container {
          width: 310px;
        }
      }

      .topContainer {
        background-color: #fbfbfb;
      }
    </style>

    <iron-media-query query="(min-width: 985px)" query-matches="{{largeMode}}"></iron-media-query>

    <template is="dom-if" if="[[points]]">
      <div class="layout horizontal center-center penContainer" hidden="">
        <div class="howToWriteInfoText">[[t('point.howToWrite')]]</div>
        <iron-icon icon="mode-edit" class="editIcon"></iron-icon>
      </div>
      <template is="dom-if" if="[[largeMode]]">
        <div class="layout vertical topContainer">
          <div class="main-container">
            <div class="point">

              <div id="pointUpMaterial" elevation="0" class="pointText" animated="">

              </div>

              <div id="allUpPoints">
                <template is="dom-repeat" items="[[upPoints]]" as="point">
                  <paper-material elevation="1" class="pointMaterial">
                    <yp-point point="[[point]]"></yp-point>
                  </paper-material>
                </template>
              </div>
            </div>

            <div class="point">

              <div id="pointDownMaterial" elevation="0" class="pointText" animated="">

              </div>

              <div id="allDownPoints">
                <template is="dom-repeat" items="[[downPoints]]" as="point">
                  <paper-material elevation="1" class="pointMaterial">
                    <yp-point point="[[point]]"></yp-point>
                  </paper-material>
                </template>
              </div>
            </div>
          </div>
        </div>
      </template>
      <template is="dom-if" if="[[!largeMode]]">
        <div id="pointUpOrDownMaterial" elevation="0" class="pointText" animated="">
        </div>
        <template is="dom-repeat" items="[[points]]" as="point">
          <paper-material elevation="1" class="pointMaterial">
            <yp-point point="[[point]]"></yp-point>
          </paper-material>
        </template>
      </template>
    </template>

    <div hidden="" class="layout horizontal center-center">
      <oav-ajax id="ajax" on-response="_response"></oav-ajax>
      <oav-ajax id="newPointAjax" method="POST" url="/api/points" on-response="_newPointResponse"></oav-ajax>
    </div>

    <paper-toast id="newPointToast" text="[[newPointTextCombined]]"></paper-toast>
  </template>


  <script>
    (function () {
      Polymer({

        is: 'yp-post-points',

        behaviors: [
          Polymer.appHelpers
        ],

        properties: {

          downPoints: {
            type: Array,
            value: function () {
              return [];
            }
          },

          upPoints: {
            type: Array,
            value: function () {
              return [];
            }
          },

          textValueUp: {
            type: String
          },

          textValueDown: {
            type: String
          },

          newPointTextCombined: {
            type: String
          },

          post: {
            type: Object,
            observer: "_postChanged"
          },

          points: {
            type: Array,
            value: null
          },

          largeMode: {
            type: Boolean,
            value: false
          },

          textValueMobileUpOrDown: String,

          labelMobileUpOrDown: String,

          pointUpOrDownSelected: {
            type: String,
            observer: '_pointUpOrDownSelectedChanged',
            value: 'pointFor'
          }
        },

        _pointUpOrDownSelectedChanged: function (newValue) {
          if (newValue=='pointFor') {
            this.set('labelMobileUpOrDown', this.t('point.for'));
          } else if (newValue=='pointAgainst') {
            this.set('labelMobileUpOrDown', this.t('point.against'));
          }
        },

        _postChanged: function (newPost) {
          // Remove any manually inserted points when the list is updated
          this.set('downPoints', null);
          this.set('upPoints', null);
          if (newPost) {
            var params = '/api/posts/' + newPost.id + '/points';
            this.$.ajax.url = '/votes/better_iceland_proxy';
            this.$.ajax.params = { params: params };
            this.$.ajax.generateRequest();
          }
        },

        _response: function (event, detail) {
          this.set('points', detail.response);
          if (this.points.length > 0) {
            this.set('upPoints', this.points.filter(function (x) {
              return x.value > 0;
            }));
            this.set('downPoints', this.points.filter(function (x) {
              return x.value < 0;
            }));
          } else {
            this.set('upPoints', []);
            this.set('downPoints', []);
          }

          this.fire('yp-debate-info', {
            count: this.upPoints.length + this.downPoints.length,
            firstPoint: this.upPoints[0]
          });

          this.set('points', this.interleaveArrays(this.upPoints, this.downPoints));
        },

        _insertNewPoint: function (point) {
          if (this.largeMode) {
            if (point.value > 0) {
              this.unshift('upPoints', point);
            } else if (point.value < 0) {
              this.unshift('downPoints', point);
            }
          } else {
            this.unshift('points', point);
          }
        },

        _newPointResponse: function (event, detail) {
          var point = detail.response;
          if (point.value > 0) {
            this.newPointTextCombined = this.t("point.forAdded") + " " + this.truncate(point.content, 21);
            this.set("textValueUp", "");
          } else {
            this.newPointTextCombined = this.t("point.againstAdded") + " " + this.truncate(point.content, 21);
            this.set("textValueDown", "");
          }
          this.set("textValueMobileUpOrDown", "");
          this._insertNewPoint(point);
          this.set('post.counter_points', this.post.counter_points + 1);
          this.$.newPointToast.show();
        },

        addPointUp: function () {
          this.addPoint(this.textValueUp, 1);
          window.appGlobals.activity('add', 'pointUp');
        },

        addPointDown: function () {
          this.addPoint(this.textValueDown, -1);
          window.appGlobals.activity('add', 'pointDown');
        },

        addMobilePointUpOrDown: function () {
          if (this.pointUpOrDownSelected=='pointFor') {
            this.addPoint(this.textValueMobileUpOrDown, 1);
            window.appGlobals.activity('add', 'pointUp');
          } else if (this.pointUpOrDownSelected=='pointAgainst') {
            this.addPoint(this.textValueMobileUpOrDown, -1);
            window.appGlobals.activity('add', 'pointDown');
          }
        },

        addPoint: function (content, value) {

        },

        focusUpPoint: function () {
          window.appGlobals.activity('focus', 'pointUp');
        },

        focusDownPoint: function () {
          window.appGlobals.activity('focus', 'pointDown');
        },

        focusTextArea: function (event) {
          event.currentTarget.parentElement.elevation = 4;
        },

        blurTextArea: function (e) {
          event.currentTarget.parentElement.elevation = 0;
        },

        ifLengthIsRight: function (textValue) {
          return textValue.length > 6;
        }

      });
    }());
  </script>
</dom-module>
</div><dom-module id="yp-post">
  <template>
    <style include="iron-flex iron-flex-alignment">
      :host {
        background-color: #e0e0e0;
        height: 100% !important;
      }

      .container {
        padding-top: 0;
        margin-top: 0;
        height: 100% !important;
      }

      .flex {
        @apply(--layout-vertical);
        @apply(--layout-flex);
      }

      .centerContainer {
        @apply(--layout-center-center);
      }

      .postHeader {
        padding: 16px;
        background-color: #fefefe;
        width: 940px;
      }

      yp-post-cover-media {
        width: 420px !important;
        height: 232px !important;
      }

      .statusHeader {
        padding: 16px;
        background-color: #fefefe;
        width: 940px;
        margin-top: 16px;
        height: 48px;
      }

      .description {
        width: 510px;
        padding-left: 24px;
      }

      yp-post-actions {
        width: 270px;
      }

      ac-activities {
        padding-top: 8px;
      }

      .statusColumn {
        width: 670px;
        padding-bottom: 16px;
      }

      .mainPage {
        background-color: #FFF;
      }

      yp-post-user-images {
        padding-top: 32px;
      }

      @media (max-width: 961px) {
        .postHeader {
          width: 600px;
        }
      }

      @media (max-width: 600px) {
        .postHeader {
          width: 400px;
        }
      }

      .createFab {
        background-color: var(--accent-color);
        color: var(--icon-general-color, #FFF);
        position: fixed;
        bottom: 24px;
        right: 28px;
      }

      .createFab[wide-layout] {
        width: 72px;
        height: 72px;
      }

      .createFabContainer[wide-layout] .createFab {
      }

      paper-fab[wide-layout]::shadow #icon {
        width: 40px;
        height: 40px;
      }

      @media (max-width: 360px) {

        .centerContainer {
          @apply(--layout-vertical);
        }

        .postHeader {
          height: 100%;
          width: 360px;
          padding: 0;
        }

        .tabsMaterial {
          width: 360px;
        }

        yp-post-cover-media {
          width: 300px !important;
          height: 181px !important;
          padding-top: 16px;
          padding-left: 20px;
        }

        .statusHeader {
          width: 360px;
          height: 120px;
          padding: 0px;
          padding-left: 20px;
        }

        .statusColumn {
          height: 60px;
          padding: 0px;
        }

        .description {
          width: 300px;
          padding: 8px;
          padding-left: 20px;
          padding-bottom: 16px;
        }

        yp-post-actions {
          width: 300px;
          padding-left: 20px;
        }

        .statusColumn {
          width: 320px;
        }

        paper-tab {
          font-size: 14px;
        }
      }

      oav-ajax {
        background-color: #e0e0e0;
      }

      .counterInfo {
        font-size: 11px;
      }

      .topContainer {
        padding-top: 24px;
        background-color: #e0e0e0;
        background-image: url("https://s3-eu-west-1.amazonaws.com/oav-direct-assets/hverfid_mitt_2016/CF-medium-minimal1920x300.png");
        background-repeat: repeat-x;
      }


      @media (max-width: 1100px) {
        .topContainer {
          background-image: url("https://s3-eu-west-1.amazonaws.com/oav-direct-assets/hverfid_mitt_2016/CF-medium-minimal1920x300_Small.png") !important;
        }
      }

      .tabs {
        margin-top: 64px;
      }

      .tabs {
        width: 300px;
        padding-top: 8px;
        padding-bottom: 8px;
      }

      .tabs .tab {
        width: 250px;
      }

      @media (max-width: 1024px) {
        .tabs {
          max-width: 920px;
        }

        .tabs .tab {
          width: 200px;
        }
      }

      @media (max-width: 900px) {
        .tabs {
          max-width: 450px;
          font-size: 13px !important;
          word-wrap: break-word !important;
        }

        .tabs .tab {
          width: 120px;
          word-wrap: break-word !important;
        }

        .topArea {
          height: 300px;
        }

        .topArea[is-post] {
          min-height: 470px;
        }
      }

      @media (max-width: 380px) {
        .tabs {
          max-width: 330px;
          font-size: 10px !important;
        }

        paper-tab {
          width: 100px;
          font-size: 10px !important;
        }

        .topArea[is-post] {
          min-height: 530px;
        }

        ac-activities {
          min-height: 600px !important;
        }
      }
    </style>

    <iron-media-query query="(min-width: 1024px)" query-matches="{{wideWidth}}"></iron-media-query>

    <div class="topContainer" is-post="">

      <yp-post-card id="postCard" class="largeCard" post="[[post]]" on-refresh="_refresh" header-mode=""></yp-post-card>

      <div class="layout horizontal center-center">
        <paper-tabs id="paper_tabs" class="tabs" selected="{{selected}}" focused="">
          <paper-tab>
            <div class="layout vertical center-center tabCounterContainer">
              <span>[[localize('postTabsDebate')]]</span><div class="counterInfo" id="tabCountDebate"></div>
            </div>
          </paper-tab>
        </paper-tabs>
      </div>

      <iron-pages id="pages" class="tabPages" selected="[[selected]]" entry-animation="fade-in-animation" exit-animation="fade-out-animation">
        <div class="layout horizontal center-center">
          <yp-post-points id="pointsSection" post="[[post]]"></yp-post-points>
        </div>
      </iron-pages>
    </div>

    <div class="layout horizontal center-center">
      <oav-ajax id="ajax" on-response="_response"></oav-ajax>
    </div>
  </template>

  <script>
    (function () {
      Polymer({

        is: 'yp-post',

        behaviors: [
          Polymer.appHelpers,
          Polymer.AppLocalizeBehavior
        ],

        properties: {

          postId: {
            type: Number,
            value: null,
            observer: "_postIdChanged"
          },

          post: {
            type: Object,
            value: null,
            notify: true,
            observer: "_postChanged"
          },

          selected: {
            type: Number,
            value: 0,
            observer: 'selectedChanged'
          },

          small: {
            type: Boolean
          },

          method: {
            type: String
          },

          mapActive: {
            type: Boolean,
            value: false
          },

          postTabName: {
            type: String,
            value: null,
            observer: '_tabNameChanged'
          },

          wideWidth: {
            type: Boolean,
            value: false
          },

          createFabIcon: {
            type: String,
            value: null
          },

          postIdRoutePath: {
            type: Object,
            observer: '_postIdRoutePathChanged'
          }
        },

        reset: function () {
          this.set('post', null);
          this.set('postId', null);
        },

        attached: function () {
          this.loadLanguage(this.resolveUrl('/src/locales.json'));
        },

        _postIdRoutePathChanged: function (newPathForId) {
          if (newPathForId && newPathForId.prefix && newPathForId.prefix == "/post") {
            this.set('postId', newPathForId.path.slice(1));
          }
        },

        _tabNameChanged: function (newValue, oldValue) {
          if (newValue && (newValue!=oldValue)) {
            if (newValue=='debate') {
              this.set('selected', 0);
            } else if (newValue=='news') {
              this.set('selected', 1);
            } else if (newValue=='location') {
              this.set('selected', 2);
            } else if (newValue=='photos') {
              this.set('selected', 3);
            }
          }
        },

        listeners: {
          'yp-debate-info': '_updateDebateInfo',
          'yp-post-image-count': '_updatePostImageCount'
        },

        _updatePostImageCount: function (event, imageCount) {
          var tabCounter = this.$$('#tabCountPhotos');
          if (tabCounter) {
            tabCounter.innerHTML = this.formatNumber(imageCount);
          }
        },

        _updateDebateInfo: function (event, detail) {
          var tabCounter = this.$$('#tabCountDebate');
          if (tabCounter) {
            tabCounter.innerHTML = this.formatNumber(detail.count);
          }
          this.$.postCard.updateDescriptionIfEmpty(detail.firstPoint.content);
        },

        _mainContainerClasses: function(small) {
          if (small) {
            return "layout horizontal wrap";
          } else {
            return "layout horizontal center-center";
          }
        },

        _headerClasses: function(small) {
          if (small) {
            return "layout vertical postHeader wrap";
          } else {
            return "layout horizontal postHeader";
          }
        },

        postName: function (post) {
          if (post && post.name) {
            return this.truncate(this.trim(post.name), 200);
          } else if (post) {
            return post.short_name;
          }
        },

        postDescription: function (post) {
          if (post && post.description) {
            return this.truncate(this.trim(post.description), 10000, '...');
          } else {
            return "";
          }
        },

        _refresh: function () {
          this.$.ajax.generateRequest();
        },

        _postChanged: function (newValue, oldValue) {
        },

        _postIdChanged: function (newValue, oldValue) {
          if (newValue) {
            this.set("post", null);
            this._getPost();
          } else {
            this.set("post",null);
          }
        },

        _getPost: function () {
          var params = '/api/posts/' + this.postId;
          this.$.ajax.url = '/votes/better_iceland_proxy';
          this.$.ajax.params = { params: params };
          this.$.ajax.generateRequest();
        },

        _response: function (event, detail, sender) {
          this.set("post", detail.response);

          if (this.post.description === null) {
            this.post.description = this.post.Points[0].content;
            this.post.Points.shift();
          }
        },

        selectedChanged: function (selected, oldValue) {
          if (selected == 0)
            window.appGlobals.activity('open', 'pointsTab');
          else if (selected == 1)
            window.appGlobals.activity('open', 'photosTab');
        },

        ready: function () {

        },

        computeUrl: function (post_id) {
          return '/api/posts/' + post_id;
        }
      });
    }());
  </script>
</dom-module>
</body></html>